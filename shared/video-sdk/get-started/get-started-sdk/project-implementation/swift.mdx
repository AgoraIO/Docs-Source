
import HandleEvents from '@docs/assets/code/video-sdk/get-started-sdk/swift/handle-events.mdx';
import JoinChannel from '@docs/assets/code/video-sdk/get-started-sdk/swift/join-channel.mdx';
import LeaveChannel from '@docs/assets/code/video-sdk/get-started-sdk/swift/leave-channel.mdx';

The following figure shows the <Vpd k="PRODUCT" /> API call sequence.

<ProductWrapper product="video-calling">
![video call logic ios](/images/video-sdk/video-call-logic-ios.svg)
</ProductWrapper>
  <ProductWrapper product={["interactive-live-streaming", "broadcast-streaming"]}>
![ils call logic ios](/images/video-sdk/ils-call-logic-ios.svg)
</ProductWrapper>

<PlatformWrapper platform="ios">
The <Vg k="VSDK" /> reference app implements the <Vg k="PRODUCT" />  business logic in the [`AgoraManager`](https://github.com/AgoraIO/video-sdk-samples-ios/blob/main/agora-manager/AgoraManager.swift) component.
</PlatformWrapper>
<PlatformWrapper platform="macos">
The <Vg k="VSDK" /> reference app implements the <Vg k="PRODUCT" />  business logic in the [`AgoraManager`](https://github.com/AgoraIO/video-sdk-samples-macos/blob/main/AgoraManager/AgoraManager.swift) component.
</PlatformWrapper>
This class encapsulates core functionality such as logging in to <Vg k="AGORA_BACKEND" />, joining a channel, listening for events from other users and logging out.

The following code examples show how to implement these steps in your <Vpl k="CLIENT" />:

1. **Import <Vpd k="SDK" /> classes**:

    ``` swift
    import AgoraRtcKit
    import SwiftUI
    ```

2.  **Declare variables to create an <Vg k="ENGINE" /> instance and join a channel**:

    <PlatformWrapper platform="ios">
    ``` swift
    // The Agora App ID for the session.
    public let appId: String
    // The client's role in the session.
    public var role: AgoraClientRole = .audience {
        didSet { agoraEngine.setClientRole(role) }
    }

    // The set of all users in the channel.
    @Published public var allUsers: Set<UInt> = []

    // Integer ID of the local user.
    @Published public var localUserId: UInt = 0

    private var engine: AgoraRtcEngineKit?
    ```
    </PlatformWrapper>
    <PlatformWrapper platform="macos">
    ``` swift
    // The Agora App ID for the session.
    public let appId: String
    // The client's role in the session.
    public var role: AgoraClientRole = .audience {
        didSet { agoraEngine.setClientRole(role) }
    }

    // Integer ID of the local user.
    @Published public var localUserId: UInt = 0

    // The set of all users in the channel.
    @Published public var allUsers: Set<UInt> = []
    ```
    </PlatformWrapper>

3.  **Configure an <Vg k="ENGINE" /> instance**

    <PlatformWrapper platform="ios">
    ``` swift
    // The Agora RTC Engine Kit for the session.
    public var agoraEngine: AgoraRtcEngineKit {
        if let engine { return engine }
        let engine = setupEngine()
        self.engine = engine
        return engine
    }

    open func setupEngine() -> AgoraRtcEngineKit {
        print(appId)
        let eng = AgoraRtcEngineKit.sharedEngine(withAppId: appId, delegate: self)
        if DocsAppConfig.shared.product != .voice {
            eng.enableVideo()
        } else { eng.enableAudio() }
        eng.setClientRole(role)
        return eng
    }
    ```
    </PlatformWrapper>
    <PlatformWrapper platform="macos">
    ``` swift
    // The Agora RTC Engine Kit for the session.
    public var agoraEngine: AgoraRtcEngineKit {
        let eng = AgoraRtcEngineKit.sharedEngine(withAppId: appId, delegate: self)
        eng.enableVideo()
        eng.setClientRole(role)
        return eng
    }
    ```
    </PlatformWrapper>

4.  **Handle and respond to  <Vg k="ENGINE" /> events**

    <HandleEvents />

5.  **Join a channel to start <Vpd k="PRODUCT" />**

    <JoinChannel />

6.  **Leave the channel and clean up the resources used by the app when the local user ends the call**

    <LeaveChannel />
