---
title: 'Quickstart'
sidebar_position: 1
type: docs
platform_selector: false
description: >
   Start cloud transcoding using the Go SDK.
---

This article introduces using the Agora Go SDK to start cloud transcoding. The Go SDK is designed to help developers integrate Agora's RESTful API more easily. It offers the following features:

- **Simplified communication**: By encapsulating RESTful API requests and responses, the SDK simplifies communication.
- **Ensured availability**: In case of DNS resolution failures, network errors, or request timeouts, the SDK automatically switches to the optimal domain to ensure REST service availability.
- **Easy-to-use API**: The SDK provides a simple and intuitive API, making it easy to perform common tasks such as creating and destroying cloud transcoding sessions.
- **Additional benefits**: Built with Go, the SDK offers efficiency, concurrency, and scalability.

## Understand the tech

The <Vpd k="NAME" /> service operates as follows:

1. In a real-time interactive live broadcast, your business server uses the RESTful API to send transcoding requests to <Vpd k="NAME" />.

1. <Vpd k="NAME" /> subscribes to the specified user's audio and video streams in the <Vg k="VSDK" /> channel based on the UID list provided in the RESTful API request.

1. The service processes the streams by mixing and transcoding them according to the configured settings before publishing the optimized streams back to the <Vg k="VSDK" /> channel.

1. Viewers in the <Vg k="VSDK" /> channel can choose to subscribe to either the host’s original audio and video streams or the transcoded streams provided by <Vpd k="NAME" />.

## Prerequisites

Before you start, ensure that you have:

- [Go](https://go.dev/dl/) 1.18 or higher
- Created an <Vg k="COMPANY"/> account.
- Obtained your App ID, temporary token, customer ID, and customer key from <Vg k="CONSOLE" />. A temporary token is valid for a maximum of 24 hours. 
- Activated the <Vpd k="NAME" /> service.
- Implemented the [Video Calling Quickstart](/video-calling/get-started/get-started-sdk). Alternatively, use the Agora real-time interactive [Web Demo](https://webdemo-global.agora.io/index.html) to simulate an audio and video interaction scenario in the browser.

## Set up your project

Follow these steps to create and configure a new project:

1. Create an empty project folder named `test-transcoder`.

1. Navigate to the `test-transcoder` directory and initialize a Go module by running the following command:

    ```bash
    go mod init test-transcoder
    ```

1. In the project directory, create an empty file `main.go`. You use this file to implement a minimal cloud transcoding task.

1. Install the required dependencies and import the SDK into your project:

    1. Run the following command in the project directory to install the Go SDK:

        ```bash
        # Install the Go SDK
        go get -u github.com/AgoraIO-Community/agora-rest-client-go

        # Update dependencies
        go mod tidy
        ```

    1. After the installation is complete, add the following code to `main.go` to import the Go SDK.

        ```go
        import (
          "context"
          "log"
          "time"

          "github.com/AgoraIO-Community/agora-rest-client-go/agora"
          "github.com/AgoraIO-Community/agora-rest-client-go/agora/auth"
          "github.com/AgoraIO-Community/agora-rest-client-go/agora/domain"
          agoraLogger "github.com/AgoraIO-Community/agora-rest-client-go/agora/log"
          "github.com/AgoraIO-Community/agora-rest-client-go/services/cloudtranscoder"
          cloudTranscoderAPI "github.com/AgoraIO-Community/agora-rest-client-go/services/cloudtranscoder/api"
        )
        ```
### Implement cloud transcoding

This section introduces the minimal workflow for cloud transcoding. For demonstration purposes, this example only transcodes the host's audio.

### Define variables
In the `main.go`, add the following code to define and configure the key parameters. 

```go
// Define key parameters
const (
  appId             = "<your_app_id>"
  token             = "<your_token>"           // Token for the transcoder in the input channel
  username          = "<your_customer_key>"    // Your customer ID
  password          = "<your_customer_secret>" // Your customer secret
  inputChannelName  = "show"                   // Channel name for the input stream
  inputUId          = 0                        // User ID for the input stream
  inputToken        = "<your_token>"           // Token for the input stream user
  outputChannelName = "show"                   // Channel name for the output stream
  outputUId         = 0                        // User ID for the transcoder in the output channel
  outputToken       = "<your_token>"           // Token for the transcoder in the output channel
  instanceId        = "quickstart"             // Instance ID of the transcoder
)
```

<Admonition type="info">
- In this example, the host of the `show` channel is used as the input stream for the transcoder. To simplify parameter configuration, the transcoder's output stream is also set to the `show` channel. The input and output streams share the same token.

- For <Vpd k="NAME" />, multiple input streams must come from the same channel, while the output can be one or more streams and may be assigned to any channel.
</Admonition>

### Create and initialize the client

In `main.go`, add the following code to create and initialize the client.

```go
config := &agora.Config{
  AppID:      appId,
  Credential: auth.NewBasicAuthCredential(username, password),
  // Specify the region where the server is located. Options include US, EU, AP, CN.
  // The client automatically switches to use the best domain based on the configured region.
  DomainArea: domain.US,
  // Specify the log output level. Options include DebugLevel, InfoLevel, WarningLevel, ErrLevel.
  // To disable log output, set logger to DiscardLogger.
  Logger: agoraLogger.NewDefaultLogger(agoraLogger.DebugLevel),
}

client, err := cloudtranscoder.NewClient(config)
if err != nil {
  log.Fatal(err)
}
```

### Get cloud transcoding resources

Before creating a cloud transcoding task, call the `Acquire` method to obtain a builder token `tokenName`. A token can only be used for a single cloud transcoding task.

```go
// Call the Acquire API of the cloud transcoder service client
acquireResp, err := client.Acquire(context.TODO(), &cloudTranscoderAPI.AcquireReqBody{
  InstanceId: instanceId,
})
if err != nil {
  log.Fatalln(err)
}
if acquireResp.IsSuccess() {
  log.Printf("acquire success:%+v\n", acquireResp)
} else {
  log.Fatalf("acquire failed:%+v\n", acquireResp)
}

tokenName := acquireResp.SuccessResp.TokenName

if tokenName == "" {
  log.Fatalln("tokenName is empty")
}

log.Printf("tokenName:%s\n", tokenName)
```

### Start cloud transcoding

Call `Create` to create a Cloud Transcoding task and start transcoding. In this example, the audio and video streams of two hosts in the same channel are mixed and combined.

```go
// Create a cloud transcoding task and start cloud transcoding
createResp, err := client.Create(context.TODO(), tokenName, &cloudTranscoderAPI.CreateReqBody{
  Services: &cloudTranscoderAPI.CreateReqServices{
    CloudTranscoder: &cloudTranscoderAPI.CloudTranscoderPayload{
      ServiceType: "cloudTranscoderV2",
      Config: &cloudTranscoderAPI.CloudTranscoderConfig{
        Transcoder: &cloudTranscoderAPI.CloudTranscoderConfigPayload{
          IdleTimeout: 300,
          AudioInputs: []cloudTranscoderAPI.CloudTranscoderAudioInput{
            {
              Rtc: &cloudTranscoderAPI.CloudTranscoderRtc{
                RtcChannel: inputChannelName,
                RtcUID:     inputUId,
                RtcToken:   inputToken,
              },
            },
          },
          Outputs: []cloudTranscoderAPI.CloudTranscoderOutput{
            {
              Rtc: &cloudTranscoderAPI.CloudTranscoderRtc{
                RtcChannel: outputChannelName,
                RtcUID:     outputUId,
                RtcToken:   outputToken,
              },
              AudioOption: &cloudTranscoderAPI.CloudTranscoderOutputAudioOption{
                ProfileType: "AUDIO_PROFILE_MUSIC_STANDARD",
              },
            },
          },
        },
      },
    },
  },
})
if err != nil {
  log.Fatalln(err)
}

if createResp.IsSuccess() {
  log.Printf("create success:%+v\n", createResp)
} else {
  log.Printf("create failed:%+v\n", createResp)
  return
}

taskId := createResp.SuccessResp.TaskID

if taskId == "" {
  log.Fatalln("taskId is empty")
}

log.Printf("taskId:%s\n", taskId)

// Wait for 10 seconds before stopping the cloud transcoding
time.Sleep(time.Second * 10)
```

### Stop cloud transcoding

When the transcoding task is complete, call the `Delete` method to end cloud transcoding:

```go
// Stop the cloud transcoding task
deleteResp, err := client.Delete(context.TODO(), taskId, tokenName)
if err != nil {
  log.Println(err)
  return
}
if deleteResp.IsSuccess() {
  log.Printf("delete success:%+v\n", deleteResp)
} else {
  log.Printf("delete failed:%+v\n", deleteResp)
  return
}
```

### Complete example code

The complete sample code for this example is presented here for your reference and use.

<details>
<summary>Complete sample code</summary>
>
```go
package main

import (
  "context"
  "log"
  "time"

  "github.com/AgoraIO-Community/agora-rest-client-go/agora"
  "github.com/AgoraIO-Community/agora-rest-client-go/agora/auth"
  "github.com/AgoraIO-Community/agora-rest-client-go/agora/domain"
  agoraLogger "github.com/AgoraIO-Community/agora-rest-client-go/agora/log"
  "github.com/AgoraIO-Community/agora-rest-client-go/services/cloudtranscoder"
  cloudTranscoderAPI "github.com/AgoraIO-Community/agora-rest-client-go/services/cloudtranscoder/api"
)

// Define key parameters
const (
  appId             = "<your_app_id>"
  token             = "<your_token>"           // transcoder 在输入频道内的 Token
  username          = "<your_customer_key>"    // 你的客户 ID
  password          = "<your_customer_secret>" // 你的客户密钥
  inputChannelName  = "show"                   // 输入流的频道名
  inputUId          = 0                        // 输入流的用户 ID
  inputToken        = "<your_token>"           // 输入流用户的 Token
  outputChannelName = "show"                   // 输出流的频道名
  outputUId         = 0                        // transcoder 在输出频道内的用户 ID
  outputToken       = "<your_token>"           // transcoder 在输出频道内的 Token
  instanceId        = "quickstart"             // transcoder 实例的 ID
)

func main() {
  // Initialize Agora Config
  config := &agora.Config{
    AppID:      appId,
    Credential: auth.NewBasicAuthCredential(username, password),
    // Specify the region where the server is located. Options include CN, EU, AP, US.
    // The client will automatically switch to use the best domain based on the configured region.
    DomainArea: domain.CN,
    // Specify the log output level. Options include DebugLevel, InfoLevel, WarningLevel, ErrLevel.
    // To disable log output, set logger to DiscardLogger.
    Logger: agoraLogger.NewDefaultLogger(agoraLogger.DebugLevel),
  }

  client, err := cloudtranscoder.NewClient(config)
  if err != nil {
    log.Fatal(err)
  }

  // Call the Acquire API of the cloud transcoder service client
  acquireResp, err := client.Acquire(context.TODO(), &cloudTranscoderAPI.AcquireReqBody{
    InstanceId: instanceId,
  })
  if err != nil {
    log.Fatalln(err)
  }
  if acquireResp.IsSuccess() {
    log.Printf("acquire success:%+v\n", acquireResp)
  } else {
    log.Fatalf("acquire failed:%+v\n", acquireResp)
  }

  tokenName := acquireResp.SuccessResp.TokenName

  if tokenName == "" {
    log.Fatalln("tokenName is empty")
  }

  log.Printf("tokenName:%s\n", tokenName)

  // Create a cloud transcoding task and start cloud transcoding
  createResp, err := client.Create(context.TODO(), tokenName, &cloudTranscoderAPI.CreateReqBody{
    Services: &cloudTranscoderAPI.CreateReqServices{
      CloudTranscoder: &cloudTranscoderAPI.CloudTranscoderPayload{
        ServiceType: "cloudTranscoderV2",
        Config: &cloudTranscoderAPI.CloudTranscoderConfig{
          Transcoder: &cloudTranscoderAPI.CloudTranscoderConfigPayload{
            IdleTimeout: 300,
            AudioInputs: []cloudTranscoderAPI.CloudTranscoderAudioInput{
              {
                Rtc: &cloudTranscoderAPI.CloudTranscoderRtc{
                  RtcChannel: inputChannelName,
                  RtcUID:     inputUId,
                  RtcToken:   inputToken,
                },
              },
            },
            Outputs: []cloudTranscoderAPI.CloudTranscoderOutput{
              {
                Rtc: &cloudTranscoderAPI.CloudTranscoderRtc{
                  RtcChannel: outputChannelName,
                  RtcUID:     outputUId,
                  RtcToken:   outputToken,
                },
                AudioOption: &cloudTranscoderAPI.CloudTranscoderOutputAudioOption{
                  ProfileType: "AUDIO_PROFILE_MUSIC_STANDARD",
                },
              },
            },
          },
        },
      },
    },
  })
  if err != nil {
    log.Fatalln(err)
  }

  if createResp.IsSuccess() {
    log.Printf("create success:%+v\n", createResp)
  } else {
    log.Printf("create failed:%+v\n", createResp)
    return
  }

  taskId := createResp.SuccessResp.TaskID

  if taskId == "" {
    log.Fatalln("taskId is empty")
  }

  log.Printf("taskId:%s\n", taskId)

  // Wait for 10 seconds before stopping the cloud transcoding
  time.Sleep(time.Second * 10)

  // Stop the cloud transcoding
  deleteResp, err := client.Delete(context.TODO(), taskId, tokenName)
  if err != nil {
    log.Println(err)
    return
  }
  if deleteResp.IsSuccess() {
    log.Printf("delete success:%+v\n", deleteResp)
  } else {
    log.Printf("delete failed:%+v\n", deleteResp)
    return
  }
}
```
</details>

## Test cloud transcoding

Execute the following command to run your Go project locally:

```bash
go run main.go
```

You see detailed log of the cloud transcoding process in the console. You hear the transcoded remote audio play in the Web Demo.

For complete details of the parameters supported by Cloud Transcoding, refer to the [API documentation](../rest-api/acquire).

## Reference

This section contains content that completes the information on this page, or points you to documentation that explains other aspects to this product.

- If you encounter any problems, refer to [Troubleshooting](../reference/troubleshooting).

### Sample project

For more <Vpd k="NAME" /> examples, see the [Sample project on GitHub](https://github.com/AgoraIO-Community/agora-rest-client-go/tree/main/examples/cloudtranscoder).



