## IAgoraMediaRtcRecorderEventHandler

The `IAgoraMediaRtcRecorderEventHandler` interface defines callback methods that are triggered during various RTC recorder events, such as changes in connection state, user activity, and statistics updates.


| API | Description |
|---|---|
|[`onConnected`](#onconnected) | Occurs when the SDK connection state to the Agora channel changes to `CONNECTION_STATE_CONNECTED(3)`. |
|[`onDisconnected`](#ondisconnected) | Occurs when the SDK connection state to the Agora channel changes to `CONNECTION_STATE_DISCONNECTED(1)`. |
|[`onReconnected`](#onreconnected) | Occurs when the connection state changes back to `CONNECTION_STATE_CONNECTED(3)`. |
|[`onConnectionLost`](#onconnectionlost) | Occurs when the SDK loses connection to the Agora channel. |
|[`onUserJoined`](#onuserjoined) | Occurs when a remote user successfully joins the channel. |
|[`onUserLeft`](#onuserleft) | Occurs when a remote user leaves the channel. |
|[`onFirstRemoteVideoDecoded`](#onfirstremotevideodecoded) | Occurs when the first frame of a remote video is decoded. |
|[`onFirstRemoteAudioDecoded`](#onfirstremoteaudiodecoded) | Occurs when the first frame of a remote audio stream is decoded. |
|[`onAudioVolumeIndication`](#onaudiovolumeindication) | Reports the active speakers, their volume, and whether the local user is speaking. |
|[`onActiveSpeaker`](#onactivespeaker) | Occurs when an active speaker is detected. |
|[`onUserVideoStateChanged`](#onuservideostatechanged) | Occurs when the remote video state changes. |
|[`onUserAudioStateChanged`](#onuseraudiostatechanged) | Occurs when the audio state of a remote user changes. |
|[`onRemoteVideoStats`](#onremotevideostats) | Reports statistics of the remote video. |
|[`onRemoteAudioStats`](#onremoteaudiostats) | Reports statistics of the remote audio stream. |
|[`onRecorderStateChanged`](#onrecorderstatechanged) | Occurs when the local recording state changes. |
|[`onRecorderInfoUpdated`](#onrecorderinfoupdated) | Occurs when the recording information is updated. |
|[`onEncryptionError`](#onencryptionerror) | Reports the type of encryption error. |
|[`onError`](#onerror) | Reports error codes and messages. |
|[`onTokenPrivilegeWillExpire`](#ontokenprivilegewillexpire) | Occurs when the Token is about to expire in 30 seconds. |
|[`onTokenPrivilegeDidExpire`](#ontokenprivilegedidexpire) | Occurs when the Token has expired. |
|[`onVideoSizeChanged`](#onvideosizechanged) | Occurs when the video size changes. |

### onConnected

```cpp
virtual void onConnected(const char *channelId, user_id_t uid) = 0;
```

Occurs when the SDK connection state to the Agora channel changes to `CONNECTION_STATE_CONNECTED(3)`.

#### Parameters

| Parameter   | Data type      | Description  |
|------------|----------------|-------------|
| `channelId` | `const char *` | Channel ID.  |
| `uid`       | `user_id_t`    | User ID.     |



### onDisconnected

```cpp
virtual void onDisconnected(const char *channelId, user_id_t uid, CONNECTION_CHANGED_REASON_TYPE reason) = 0;
```

Occurs when the SDK connection state to the Agora channel changes to `CONNECTION_STATE_DISCONNECTED(1)`.

#### Parameters

| Parameter   | Data type                    | Description                                                                 |
|------------|-------------------------------|-----------------------------------------------------------------------------|
| `channelId` | `const char *`               | Channel ID.                                                                 |
| `uid`       | `user_id_t`                  | User ID.                                                                    |
| `reason`    | `CONNECTION_CHANGED_REASON_TYPE` | The reason for the connection state change. See [`CONNECTION_CHANGED_REASON_TYPE`](#connection_changed_reason_type). |



### onReconnected

```cpp
virtual void onReconnected(const char *channelId, user_id_t uid, CONNECTION_CHANGED_REASON_TYPE reason) = 0;
```

Occurs when the connection state changes back to `CONNECTION_STATE_CONNECTED(3)`.

#### Parameters

| Parameter   | Data type                    | Description                                                                 |
|------------|-------------------------------|-----------------------------------------------------------------------------|
| `channelId` | `const char *`               | Channel ID.                                                                 |
| `uid`       | `user_id_t`                  | User ID.                                                                    |
| `reason`    | `CONNECTION_CHANGED_REASON_TYPE` | The reason for the connection state change. See [`CONNECTION_CHANGED_REASON_TYPE`](#connection_changed_reason_type). |



### onConnectionLost

```cpp
virtual void onConnectionLost(const char *channelId, user_id_t uid) = 0;
```

Occurs when the SDK loses connection to the Agora channel.

#### Parameters

| Parameter   | Data type      | Description  |
|------------|----------------|-------------|
| `channelId` | `const char *` | Channel ID.  |
| `uid`       | `user_id_t`    | User ID.     |

### onUserJoined

```cpp
virtual void onUserJoined(const char *channelId, user_id_t uid) = 0;
```

Occurs when a remote user successfully joins the channel.

#### Parameters

| Parameter   | Data Type      | Description   |
|------------|----------------|---------------|
| `channelId` | `const char *` | Channel ID.   |
| `uid`       | `user_id_t`    | Remote user ID. |



### onUserLeft

```cpp
virtual void onUserLeft(const char *channelId, user_id_t uid, USER_OFFLINE_REASON_TYPE reason) = 0;
```

Occurs when a remote user leaves the channel.

#### Parameters

| Parameter   | Data Type                 | Description                                                                 |
|------------|---------------------------|-----------------------------------------------------------------------------|
| `channelId` | `const char *`           | Channel ID.                                                                 |
| `uid`       | `user_id_t`              | Remote user ID.                                                             |
| `reason`    | `USER_OFFLINE_REASON_TYPE` | The reason why the remote user left the channel. See [`USER_OFFLINE_REASON_TYPE`](#user_offline_reason_type). |



### onFirstRemoteVideoDecoded

```cpp
virtual void onFirstRemoteVideoDecoded(const char *channelId, user_id_t userId, int width, int height, int elapsed) = 0;
```

Occurs when the first frame of the remote video is decoded.

This callback is triggered after the SDK successfully decodes the first frame of a remote user's video for recording. You can use it to get the resolution of the remote video and the time spent decoding.

#### Parameters

| Parameter   | Data Type   | Description                                                                 |
|------------|------------|-----------------------------------------------------------------------------|
| `channelId` | `const char *` | Channel ID.                                                               |
| `userId`    | `user_id_t`  | Remote user ID.                                                           |
| `width`     | `int`        | Width of the video stream in pixels.                                      |
| `height`    | `int`        | Height of the video stream in pixels.                                     |
| `elapsed`   | `int`        | Time elapsed from the remote user joining the channel to this callback being triggered, in milliseconds. |



### onFirstRemoteAudioDecoded

```cpp
virtual void onFirstRemoteAudioDecoded(const char *channelId, user_id_t userId, int elapsed) = 0;
```

Occurs when the first frame of the remote audio is decoded.

This callback is triggered when the SDK successfully decodes the first frame of remote audio for the recording device. You can use this callback to understand the reception and decoding status of the remote user's audio stream.

#### Parameters

| Parameter   | Data Type      | Description                                                                 |
|------------|----------------|-----------------------------------------------------------------------------|
| `channelId` | `const char *` | Channel ID.                                                                 |
| `userId`    | `user_id_t`    | Remote user ID, i.e., the user sending the audio stream.                    |
| `elapsed`   | `int`          | Time elapsed from the local user joining the channel to this callback being triggered, in milliseconds. |

### onAudioVolumeIndication

```cpp
virtual void onAudioVolumeIndication(const char *channelId, const SpeakVolumeInfo* speakers, unsigned int speakerNumber) = 0;
```

Reports the users who are speaking, the volume of each speaker, and whether the local user is speaking.

#### Parameters

| Parameter      | Data Type              | Description                                                                 |
|---------------|------------------------|-----------------------------------------------------------------------------|
| `channelId`     | `const char *`        | Channel ID.                                                                 |
| `speakers`      | `const SpeakVolumeInfo*` | Array containing the user IDs and volume information of the speakers. See [`SpeakVolumeInfo`](#speakvolumeinfo). |
| `speakerNumber` | `unsigned int`        | Total number of speakers.                                                   |



### onActiveSpeaker

```cpp
virtual void onActiveSpeaker(const char *channelId, user_id_t userId) = 0;
```

Occurs when an active speaker is detected.

You can implement features in your app such as enlarging the speaker's avatar when an active speaker is detected.

<Admonition type="info"> 
An active speaker refers to the user who is speaking at the highest volume over a certain period. The user ID of the active speaker is reported.
</Admonition>

#### Parameters

| Parameter   | Data Type      | Description                                  |
|------------|----------------|----------------------------------------------|
| `channelId` | `const char *` | Channel ID.                                  |
| `userId`    | `user_id_t`    | User ID of the active speaker. `0` indicates the local user. |



### onUserVideoStateChanged

```cpp
virtual void onUserVideoStateChanged(const char *channelId, user_id_t userId, REMOTE_VIDEO_STATE state, REMOTE_VIDEO_STATE_REASON reason, int elapsed) = 0;
```

Occurs when the video state of a remote user changes.

#### Parameters

| Parameter   | Data Type                | Description                                                                 |
|------------|--------------------------|-----------------------------------------------------------------------------|
| `channelId` | `const char *`          | Channel ID.                                                                 |
| `userId`    | `user_id_t`             | Remote user ID whose video state has changed.                                |
| `state`     | `REMOTE_VIDEO_STATE`     | Current video state. See [`REMOTE_VIDEO_STATE`](#remote_video_state).   |
| `reason`    | `REMOTE_VIDEO_STATE_REASON` | Reason for the video state change. See [`REMOTE_VIDEO_STATE_REASON`](#remote_video_state_reason). |
| `elapsed`   | `int`                   | Time elapsed since the user joined the channel, in milliseconds.           |



### onUserAudioStateChanged

```cpp
virtual void onUserAudioStateChanged(const char *channelId, user_id_t userId, REMOTE_AUDIO_STATE state, REMOTE_AUDIO_STATE_REASON reason, int elapsed) = 0;
```

Occurs when the audio state of a remote user changes.

#### Parameters

| Parameter   | Data Type                | Description                                                                 |
|------------|--------------------------|-----------------------------------------------------------------------------|
| `channelId` | `const char *`          | Channel ID.                                                                 |
| `userId`    | `user_id_t`             | Remote user ID whose audio state has changed.                                |
| `state`     | `REMOTE_AUDIO_STATE`     | Current audio state. See [`REMOTE_AUDIO_STATE`](#remote_audio_state).   |
| `reason`    | `REMOTE_AUDIO_STATE_REASON` | Reason for the audio state change. See [`REMOTE_AUDIO_STATE_REASON`](#remote_audio_state_reason). |
| `elapsed`   | `int`                   | Time elapsed from when the user joined the channel to when the callback is triggered, in milliseconds. |

### onRemoteVideoStats

```cpp
virtual void onRemoteVideoStats(const char *channelId, user_id_t userId, const RemoteVideoStatistics& stats) = 0;
```

Occurs to report statistics of the remote video stream.

#### Parameters

| Parameter   | Data Type                     | Description                                                                 |
|------------|-------------------------------|-----------------------------------------------------------------------------|
| `channelId` | `const char *`               | Channel ID.                                                                 |
| `userId`    | `user_id_t`                  | Remote user ID.                                                             |
| `stats`     | `const RemoteVideoStatistics&` | Current statistics of the video stream. See [`RemoteVideoStatistics`](#remotevideostatistics). |



### onRemoteAudioStats

```cpp
virtual void onRemoteAudioStats(const char *channelId, user_id_t userId, const RemoteAudioStatistics& stats) = 0;
```

Occurs when the SDK receives audio statistics from a remote user.

#### Parameters

| Parameter   | Data Type                     | Description                                                                 |
|------------|-------------------------------|-----------------------------------------------------------------------------|
| `channelId` | `const char *`               | Channel ID.                                                                 |
| `userId`    | `user_id_t`                  | Remote user ID.                                                             |
| `stats`     | `const RemoteAudioStatistics&` | Remote audio statistics. See [`RemoteAudioStatistics`](#remoteaudiostatistics). |



### onRecorderStateChanged

```cpp
virtual void onRecorderStateChanged(const char* channelId, user_id_t userId, media::RecorderState state, media::RecorderReasonCode reason, const char* filename) = 0;
```

Occurs when the local recording state changes.

When the local audio/video recording state changes, the SDK triggers this callback to report the current recording state and the reason for the change.

#### Parameters

| Parameter   | Data Type                     | Description                                                                 |
|------------|-------------------------------|-----------------------------------------------------------------------------|
| `channelId` | `const char*`                | Channel name.                                                               |
| `userId`    | `user_id_t`                  | User ID.                                                                    |
| `state`     | `media::RecorderState`       | Current recording state. See [`RecorderState`](#recorderstate).       |
| `reason`    | `media::RecorderReasonCode`  | Reason for the state change. See [`RecorderReasonCode`](#recorderreasoncode). |
| `filename`  | `const char*`                | Filename of the recorded stream.                                            |

### onRecorderInfoUpdated

```cpp
virtual void onRecorderInfoUpdated(const char* channelId, user_id_t userId, const media::RecorderInfo& info) = 0;
```

Occurs when the recording information is updated.

After you successfully register this callback and enable local audio/video recording, the SDK periodically triggers this callback based on the `recorderInfoUpdateInterval` setting to report the filename, duration, and size of the current recording file.

#### Parameters

| Parameter   | Data Type                     | Description                                                                 |
|------------|-------------------------------|-----------------------------------------------------------------------------|
| `channelId` | `const char*`                | Channel name.                                                               |
| `userId`    | `user_id_t`                  | User ID.                                                                    |
| `info`      | `const media::RecorderInfo&` | Information about the recording file. See [`RecorderInfo`](#recorderinfo). |



### onEncryptionError

```cpp
virtual void onEncryptionError(const char* channelId, ENCRYPTION_ERROR_TYPE errorType) = 0;
```

Occurs to report encryption error types.

#### Parameters

| Parameter   | Data Type              | Description                                                              |
|------------|------------------------|--------------------------------------------------------------------------|
| `channelId` | `const char*`         | Channel name.                                                            |
| `errorType` | `ENCRYPTION_ERROR_TYPE` | Type of encryption error. See [`ENCRYPTION_ERROR_TYPE`](#encryption_error_type). |



### onError

```cpp
virtual void onError(const char* channelId, ERROR_CODE_TYPE error, const char* msg) = 0;
```

Reports error codes and messages.

#### Parameters

| Parameter   | Data Type              | Description                                                            |
|------------|------------------------|------------------------------------------------------------------------|
| `channelId` | `const char*`         | Channel ID.                                                            |
| `error`     | `ERROR_CODE_TYPE`     | Error code. See [`ERROR_CODE_TYPE`](#error_code_type).             |
| `msg`       | `const char*`         | Error message.                                                         |

### onTokenPrivilegeWillExpire

```cpp
virtual void onTokenPrivilegeWillExpire(const char* channelId, const char* token) = 0;
```

Occurs when the Token is about to expire in 30 seconds.

When the Token is about to expire in 30 seconds, the SDK triggers this callback to remind you to renew the Token before it expires. Upon receiving this callback, you must generate a new Token on your server and call the [`renewToken`](#renewtoken) method to pass it to the SDK.

#### Parameters

| Parameter   | Data Type      | Description                                  |
|------------|----------------|----------------------------------------------|
| `channelId` | `const char*` | Channel name.                                |
| `token`     | `const char*` | The Token that will expire in 30 seconds.   |



### onTokenPrivilegeDidExpire

```cpp
virtual void onTokenPrivilegeDidExpire(const char* channelId) = 0;
```

Occurs when the Token has expired.

Upon receiving this callback, you need to generate a new Token on your server and call the [`renewToken`](#renewtoken) method to pass the new Token to the SDK.

#### Parameters

| Parameter   | Data Type      | Description  |
|------------|----------------|--------------|
| `channelId` | `const char*` | Channel name.|



### onVideoSizeChanged

```cpp
virtual void onVideoSizeChanged(const char* channelId, user_id_t userId, int width, int height, int rotation) {}
```

Occurs when the video size changes.

#### Parameters

| Parameter   | Data Type      | Description                     |
|------------|----------------|---------------------------------|
| `channelId` | `const char*` | Channel ID.                     |
| `userId`    | `user_id_t`   | Remote user ID.                 |
| `width`     | `int`         | Width of the video stream.      |
| `height`    | `int`         | Height of the video stream.     |
| `rotation`  | `int`         | Rotation angle of the video stream. |
