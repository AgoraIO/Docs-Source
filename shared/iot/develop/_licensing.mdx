License is a billing mode for Agora services. In the IoT scenario, Agora charges a single device through the device license, and the license of each device is unique. During the validity period of the license, Agora does not charge for the call duration.
In general, IoT manufacturers estimate the sales volume and audio and video usage of the device, purchase and activate the license from Agora, and then burn the license into the device in the form of one code per machine. 


## Understand the tech

The following figure shows the overall process of using a device license:

![](/images/iot/iot-licensing.svg)


## Apply for a license
To apply for a license, contact iot@agora.io and provide the following information:

| Name | Description            |
|------|------------------------|
| Category | Device license: The license that binds a device. |
| Company ID (CID) | A unique identifier assigned by Agora to each company or organization. You can create an Agora account and get your company ID on the **Settings** page of the <Vg k="CONSOLE" />. |
| License type | <ul><li>Trial license</li><li>Commercial license</li></ul>Agora recommends that you use a trial license during integration testing, and switch to a commercial license before the official launch. For further details, see Trial license and commercial license. |
| Stock keeping unit (SKU) | Specify the capability set of the license, including the following parameters: <ul><li>License capabilities: <ul><li>Audio</li><li>Video</li><li>Both audio and video</li></ul></li><li>Upper limit of license minutes: Whether to limit the duration for using the license, which is accurate to minutes. </li><li>License usage period: Whether to limit the period for using the license, which is accurate to minutes.</li></ul>  |
| Validity period  | The validity period of the license starts on the day of activation.<ul><li>Trial license: Specify the period in months. Minimum is 3 months.</li><li>Commercial license: Specify the period in years. Minimum 1 year.</li></ul> |
| Number of applications  | The number of licenses you require. |
| List of license-enabled project IDs (App ID) | An App ID is the unique identifier of a project, which is provided by Agora and subordinate to the CID. You can enable the license for a specific App ID. You can create a project and get the App ID on the Project Management page of the Console. |
| Maximum concurrent user (PCU) limit  | After enabling the PCU limit, you can limit the maximum number of people who can access the SDK at the same time in the dimension of CID or App ID.|

## Activate the license

After receiving the Agora license, refer to the information in this section and Basic information of the license RESTful API to call the RESTful API to activate the license.

**Prototype**

- Method: `POST`
- Access point: `https://api.agora.io/dabiz/license/v2/active`

**Request parameters**

**Query parameters**

The URL requires the following query parameters:

| Parameter | Type | Description |
|-----------|------|--------------|
| `pid` | String | The license identification defined by SKU, validity period, and category.
| `licenseKey` | String | The unique ID of the device. For example, the SN number, Mac address, and so on. The string length must be less than 64 bytes. |
| `appid` | String | A unique identifier assigned by Agora to each project. |

**Request example**

**Request path**

`https://api.agora.io/dabiz/license/v2/active?
pid=02F5xxxxxxxxxxxxxxxxxxxxxxxxEC30&licenseKey=111&appid=a6d6xxxxxxxxxxxxxxxxxxxxxxxxf75e`

**Response parameters**
If the status code is `200`, the request is successful, and the response body contains the following parameters:

| Parameter | Type | Description |
|-----------|------|-------------|
| `license` | String | The value of the active license. |
| `skuView` | Array | SKU capability set:<ul><li>`product` (Integer):<ul><li>1: Video SDK</li><li>2: IoT SDK</li><li>3: FPA</li></ul></li><li>`name` (String): The name of the SKU</li><li>`mediaType` (Integer):<ul><li>1: Audio</li><li>2: Video</li><li>3: Both audio and video</li></ul></li><li>`minutes` (Integer): The maximum duration of the license</li><li>`period` (String): License usage time period </li></ul> |

If the status code is not `200`, the request fails. You can follow the returned status code and the description of the message field in the response body to troubleshoot errors.

**Response example**

The following is a response example for a successful activation request:

```json
{
   "code":200,
   "data":{
      "license":"1D65xxxxxxxxxxxxxxxxxxxxxxxx6016",
      "skuView":{
         "product":1,
         "name":"01",
         "mediaType":1,
         "minutes":100,
         "period":"00:00~23:59"
      }
   }
}
```

## Use the license 
After successfully activating the license, you need to use the license in the SDK and burn the license in the device. The flow chart is as follows:

You need to do the following:
1. Receive an activated license from the server.
1. Write the license, and ensure that the license written in each device is correct and unique. The two common writing methods are as follows, and you can implement it yourself according to your actual needs:
    * Write the license into a file and the device can read the file through the program.
    * When the manufacturer produces a device, the license file is burnt into the device, and then the device can directly read the license file.
1. Device reads license:
    * If the device successfully reads the license, proceed to the next step.
    * If the device fails to read the license, go back to step 2 to troubleshoot the problem.
1. In the IoT SDK, call `agora_rtc_init` and pass the license in the `license_value` parameter of `rtc_service_option_t`.
1. The IoT SDK automatically verifies the license when a userjoins a channel.
    * If the license verification is successful, the user can use the functions of the SDK.
    * If the license verification fails, the SDK kicks the user out of the channel, and the user receives the `ERR_CLIENT_IS_BANNED_BY_SERVER` error code. You can handle the problem according to the received error code.

## Reference

The content in this section completes the information on this page, or points you to documentation that explains other aspects to this product.

### The license RESTful API

This section introduces the basic information of all Agora Console License RESTful APIs.

**Domain**
All requests are sent to the host: `api.agora.io`.

**Authentication**
The RESTful APIs only support `HTTPS`. Before sending HTTP requests, you must generate a Base64-encoded credential with the Customer ID and Customer Secret provided by Agora, and pass the credential to the `Authorization` field in the HTTP request header.

**Call frequency limit**

For each Agora account (not each App ID), the maximum call frequency of each API on this page is 10 queries per second.

#### Difference between `licenseValue` and `licenseKey`

**`licenseValue`** is the ID of each license.
There are two ways to query `licenseValue`:

1. On the [License Usage](https://console.agora.io/license/usage) page of the <Vg k="CONSOLE" />, click **Export License Details** and view the `licenseValue` in the **License** column in the exported CSV file.

1. After successfully calling the activation API, you receive the activated `licenseValue` in the response.

**`licenseKey`** is the unique identifier of the device. For example, the SN number, Mac address, and so on. The string length must be less than 64 bytes. When a user calls the activation API to activate a license for a device, the user consumes the license which is passed in the `licenseKey` parameter. In addition, users can perform pre-authorization operations, so that only the `licenseKey` in the whitelist can successfully activate the license.

### Trial license and commercial license

To facilitate you to test and use the SDK, Agora provides a trial license and a commercial license, the differences are as follows:
* Trial license: For integration testing and product debugging.
* Commercial license: For the formal launch stage of the product.

Agora recommends that you use the trial license first. Before the product is officially launched, refer to the following steps to switch to the commercial license:
1. Contact iot@agora.io to apply for a commercial license (hereinafter referred to as a new license). After successfully applying for a license, you can check the PID of the license in the License Usage page of Console.
1. Call the activation API to activate a new license and pass in the PID of the new license and the licenseKey which is consistent with the old license.
1. Write and read a new license in the device.
1. In the SDK, call `agora_rtc_init` and pass a new license in the `license_value` parameter of `rtc_service_option_t`.