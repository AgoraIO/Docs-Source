import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import CodeBlock from '@theme/CodeBlock';

<PlatformWrapper platform="unreal">
The following figure illustrates the essential steps:
<ProductWrapper notAllowed="voice-calling">
<details>
<summary>Quick start sequence</summary>

![](/images/video-sdk/quick-start-sequence.svg)
</details>
</ProductWrapper>
<ProductWrapper product="voice-calling">
<details>
<summary>Quick start sequence</summary>

![](/images/video-sdk/quickstart-voice-call-sequence.svg)
</details>
</ProductWrapper>

This guide includes [complete sample code](#complete-sample-code) that demonstrates implementing basic real-time interaction. To understand the core API calls in the sample code, review the following implementation steps.

### Import <Vg k="COMPANY" /> libraries

    To import <Vg k="COMPANY" /> library, add the following to `AgoraWidget.h`:

    ```cpp
    #include "AgoraPluginInterface.h"
    ```

### Initialize the engine

For real-time communication, initialize an `IRtcEngine` instance and set up an event handler to manage user interactions within the channel. Use `RtcEngineContext` to specify [App ID](../get-started/manage-agora-account#get-the-app-id), and custom [event handler](#subscribe-to--events), then call `RtcEngineProxy->initialize(RtcEngineContext)` to initialize the engine, enabling further channel operations.

Add the `SetupSDKEngine` method declaration and implementation to the following files: 

* `AgoraWidget.h`

    ```cpp
    // Fill in your app ID
    FString _appID = "";
    // Define a global variable for IRtcEngine 
    agora::rtc::IRtcEngine* RtcEngineProxy;

    private:
        // Create and initialize IRtcEngine
        void SetupSDKEngine();
    ```

* `AgoraWidget.cpp`

    ```cpp
    void UAgoraWidget::SetupSDKEngine()
    {
        agora::rtc::RtcEngineContext RtcEngineContext;

        RtcEngineContext.appId = TCHAR_TO_ANSI(*_appID);
        RtcEngineContext.eventHandler = this;

        // Create IRtcEngine instance
        RtcEngineProxy = agora::rtc::ue::createAgoraRtcEngine();
        
        // Initialize IRtcEngine
        RtcEngineProxy->initialize(RtcEngineContext);
    }
    ```

<Admonition type="caution" title="Note">
Before initializing the SDK, ensure that the user fully understands and agrees to the relevant privacy policy.
</Admonition>

### Join a channel

To join a channel, call `joinChannel` with the following parameters:

- **Channel name**: The name of the channel to join. Clients that pass the same channel name join the same channel. If a channel with the specified name does not exist, it is created when the first user joins.

- **Authentication token**: A dynamic key that authenticates a user when the client joins a channel. In a production environment, you obtain a token from a [token server](../token-authentication/deploy-token-server) in your security infrastructure. For the purpose of this guide [Generate a temporary token](../get-started/manage-agora-account#generate-temporary-tokens).

- **User ID**: A 32-bit signed integer that identifies a user in the channel. You can specify a unique user ID for each user yourself. If you set the user ID to `0` when joining a channel, the SDK generates a random number for the user ID and returns the value in the `onJoinChannelSuccess` callback. 

- **Channel media options**: Configure `ChannelMediaOptions` to define publishing and subscription settings, optimize performance for your specific use-case, and set optional parameters. 

Add the `Join` method declaration and implementation to the following files:

* `AgoraWidget.h`

    ```cpp
    // Fill in your channel name
    FString _channelName = "";
    // Fill in a valid token
    FString _token = "";

    UFUNCTION(BlueprintCallable)
    void Join();
    UFUNCTION(BlueprintCallable)
    void Leave();
    ```

* `AgoraWidget.cpp`
    
    <ProductWrapper product="interactive-live-streaming">

    For <Vpd k="NAME" />, set the `channelProfile` to `CHANNEL_PROFILE_LIVE_BROADCASTING`, the `clientRoleType` to `CLIENT_ROLE_BROADCASTER` (host) or `CLIENT_ROLE_AUDIENCE`, and the `audienceLatencyLevel` to `AUDIENCE_LATENCY_LEVEL_ULTRA_LOW_LATENCY`.

    ```cpp
    void UAgoraWidget::Join()
    {
        // Enable the video module
        RtcEngineProxy->enableVideo();
        // Set channel media options
        agora::rtc::ChannelMediaOptions options;
        // Automatically subscribe to all audio streams
        options.autoSubscribeAudio = true;
        // Automatically subscribe to all video streams
        options.autoSubscribeVideo = true;
        // Publish video captured by the camera
        options.publishCameraTrack = true;
        // Publish audio captured by the microphone
        options.publishMicrophoneTrack = true;
        // Set the channel profile to live broadcasting
        options.channelProfile = agora::CHANNEL_PROFILE_TYPE::CHANNEL_PROFILE_LIVE_BROADCASTING;
        // Set the user role as host or audience
        options.clientRoleType = agora::rtc::CLIENT_ROLE_TYPE::CLIENT_ROLE_BROADCASTER;
        // Set the latency level for optimal experience
        options.audienceLatencyLevel = agora::rtc::AUDIENCE_LATENCY_LEVEL_TYPE::AUDIENCE_LATENCY_LEVEL_ULTRA_LOW_LATENCY;
        // Join a channel
        RtcEngineProxy->joinChannel(TCHAR_TO_ANSI(*_token), TCHAR_TO_ANSI(*_channelName), 0, options);
    }
    ```
    </ProductWrapper>

    <ProductWrapper product="broadcast-streaming">
    For <Vpd k="NAME" />, set the `channelProfile` to `CHANNEL_PROFILE_LIVE_BROADCASTING`, the `clientRoleType` to `CLIENT_ROLE_BROADCASTER` (host) or `CLIENT_ROLE_AUDIENCE`, and the `audienceLatencyLevel` to `AUDIENCE_LATENCY_LEVEL_LOW_LATENCY`.

    ```cpp
    void UAgoraWidget::Join()
    {
        // Enable the video module
        RtcEngineProxy->enableVideo();
        // Set channel media options
        agora::rtc::ChannelMediaOptions options;
        // Automatically subscribe to all audio streams
        options.autoSubscribeAudio = true;
        // Automatically subscribe to all video streams
        options.autoSubscribeVideo = true;
        // Publish video captured by the camera
        options.publishCameraTrack = true;
        // Publish audio captured by the microphone
        options.publishMicrophoneTrack = true;
        // Set the channel profile to live broadcasting
        options.channelProfile = agora::CHANNEL_PROFILE_TYPE::CHANNEL_PROFILE_LIVE_BROADCASTING;
        // Set the user role as host or audience
        options.clientRoleType = agora::rtc::CLIENT_ROLE_TYPE::CLIENT_ROLE_BROADCASTER;
        // Set the latency level for optimal experience
        options.audienceLatencyLevel = agora::rtc::AUDIENCE_LATENCY_LEVEL_TYPE::AUDIENCE_LATENCY_LEVEL_LOW_LATENCY;
        // Join a channel
        RtcEngineProxy->joinChannel(TCHAR_TO_ANSI(*_token), TCHAR_TO_ANSI(*_channelName), 0, options);
    }
    ```
    </ProductWrapper>
    <ProductWrapper product="video-calling">
    For <Vpd k="NAME" />, set the `channelProfile` to `CHANNEL_PROFILE_COMMUNICATION` and the user role to `CLIENT_ROLE_BROADCASTER`.

    ```cpp
    void UAgoraWidget::Join()
    {
        // Enable the video module
        RtcEngineProxy->enableVideo();
        // Set channel media options
        agora::rtc::ChannelMediaOptions options;
        // Automatically subscribe to all audio streams
        options.autoSubscribeAudio = true;
        // Automatically subscribe to all video streams
        options.autoSubscribeVideo = true;
        // Publish video captured by the camera
        options.publishCameraTrack = true;
        // Publish audio captured by the microphone
        options.publishMicrophoneTrack = true;        
        // Set the channel profile to live broadcasting
        options.channelProfile = agora::CHANNEL_PROFILE_TYPE::CHANNEL_PROFILE_COMMUNICATION;
        // Set the user role as host or audience
        options.clientRoleType = agora::rtc::CLIENT_ROLE_TYPE::CLIENT_ROLE_BROADCASTER;
        // Join a channel
        RtcEngineProxy->joinChannel(TCHAR_TO_ANSI(*_token), TCHAR_TO_ANSI(*_channelName), 0, options);
    }
    ```
    </ProductWrapper>
    <ProductWrapper product="voice-calling">
    For <Vpd k="NAME" />, set the `channelProfile` to `CHANNEL_PROFILE_COMMUNICATION` and the user role to `CLIENT_ROLE_BROADCASTER`.

    ```cpp
    void UAgoraWidget::Join()
    {
        // Set channel media options
        agora::rtc::ChannelMediaOptions options;
        // Automatically subscribe to all audio streams
        options.autoSubscribeAudio = true;
        // Publish video captured by the camera
        options.publishMicrophoneTrack = true;        
        // Set the channel profile to live broadcasting
        options.channelProfile = agora::CHANNEL_PROFILE_TYPE::CHANNEL_PROFILE_COMMUNICATION;
        // Set the user role as host or audience
        options.clientRoleType = agora::rtc::CLIENT_ROLE_TYPE::CLIENT_ROLE_AUDIENCE;
        // Join a channel
        RtcEngineProxy->joinChannel(TCHAR_TO_ANSI(*_token), TCHAR_TO_ANSI(*_channelName), 0, options);
    }
    ```
    </ProductWrapper>

### Subscribe to <Vpd k="SDK"/> events

The <Vpd k="SDK"/> provides an interface for subscribing to channel events. To use it, inherit from the `IRtcEngineEventHandler` class and override the event handler methods for the events you want to process.

* `AgoraWidget.h`

    ```cpp
    // Triggered when the local user leaves a channel
    void onLeaveChannel(const agora::rtc::RtcStats& stats) override;

    // Triggered when a remote user joins a channel
    void onUserJoined(agora::rtc::uid_t uid, int elapsed) override;

    // Triggered when a remote user leaves a channel
    void onUserOffline(agora::rtc::uid_t uid, agora::rtc::USER_OFFLINE_REASON_TYPE reason) override;

    // Triggered when the local user joins a channel
    void onJoinChannelSuccess(const char* channel, agora::rtc::uid_t uid, int elapsed) override;
    ```

* `AgoraWidget.cpp`

    <ProductWrapper notAllowed="voice-calling">

    ```cpp
    // Implement the callback triggered after a remote user joins the channel
    void UAgoraWidget::onUserJoined(agora::rtc::uid_t uid, int elapsed)
    {
        // Set up remote video 
        agora::rtc::VideoCanvas videoCanvas;
        videoCanvas.view = RemoteVideo;
        videoCanvas.uid = uid;
        videoCanvas.sourceType = agora::rtc::VIDEO_SOURCE_TYPE::VIDEO_SOURCE_REMOTE;

        agora::rtc::RtcConnection connection;
        connection.channelId = TCHAR_TO_ANSI(*_channelName);

        ((agora::rtc::IRtcEngineEx*)RtcEngineProxy)->setupRemoteVideoEx(videoCanvas, connection);
    }

    // Implement the callback triggered when a remote user leaves the channel
    void UAgoraWidget::onUserOffline(agora::rtc::uid_t uid, agora::rtc::USER_OFFLINE_REASON_TYPE reason)
    {
        // Stop remote video 
        agora::rtc::VideoCanvas videoCanvas;
        videoCanvas.view = nullptr;
        videoCanvas.uid = uid;
        videoCanvas.sourceType = agora::rtc::VIDEO_SOURCE_TYPE::VIDEO_SOURCE_REMOTE;

        agora::rtc::RtcConnection connection;
        connection.channelId = TCHAR_TO_ANSI(*_channelName);

        ((agora::rtc::IRtcEngineEx*)RtcEngineProxy)->setupRemoteVideoEx(videoCanvas, connection);
    }

    // Implement the callback triggered when the local user joins the channel
    void UAgoraWidget::onJoinChannelSuccess(const char* channel, agora::rtc::uid_t uid, int elapsed)
    {
        AsyncTask(ENamedThreads::GameThread, [=]()
        {
            UE_LOG(LogTemp, Warning, TEXT("JoinChannelSuccess uid: %u"), uid);
            // Set up local video
            agora::rtc::VideoCanvas videoCanvas;
            videoCanvas.view = LocalVideo;
            videoCanvas.uid = 0;
            videoCanvas.sourceType = agora::rtc::VIDEO_SOURCE_TYPE::VIDEO_SOURCE_CAMERA;
            RtcEngineProxy->setupLocalVideo(videoCanvas);
        });
    }

    // Implement the callback triggered when the local user leaves the channel
    void UAgoraWidget::onLeaveChannel(const agora::rtc::RtcStats& stats)
    {
        AsyncTask(ENamedThreads::GameThread, [=]()
        {
            agora::rtc::VideoCanvas videoCanvas;
            videoCanvas.view = nullptr;
            videoCanvas.uid = 0;
            videoCanvas.sourceType = agora::rtc::VIDEO_SOURCE_TYPE::VIDEO_SOURCE_CAMERA;
            RtcEngineProxy->setupLocalVideo(videoCanvas);
        });
    }
    ```
    </ProductWrapper>
    <ProductWrapper product="voice-calling">

    ```cpp
    void UAgoraWidget::onUserJoined(agora::rtc::uid_t uid, int elapsed)
    {
        // Callback when a remote user joins the channel
        agora::rtc::RtcConnection connection;
        connection.channelId = TCHAR_TO_ANSI(*_channelName);
    }
    
    void UAgoraWidget::onUserOffline(agora::rtc::uid_t uid, agora::rtc::USER_OFFLINE_REASON_TYPE reason)
    {
        // Callback when a remote user leaves the channel
        agora::rtc::RtcConnection connection;
        connection.channelId = TCHAR_TO_ANSI(*_channelName);
    }
    
    void UAgoraWidget::onJoinChannelSuccess(const char* channel, agora::rtc::uid_t uid, int elapsed)
    {
        // Callback when the local user successfully joins the channel
        AsyncTask(ENamedThreads::GameThread, =
        {
            UE_LOG(LogTemp, Warning, TEXT("JoinChannelSuccess uid: %u"), uid);
        });
    }
    void UAgoraWidget::onLeaveChannel(const agora::rtc::RtcStats& stats)
    {
        // Callback when the local user successfully leaves the channel

    }
    ```
    </ProductWrapper>

 ### Handle permissions​

To access the <Vpd k="MEDIA_DEVICES" />, follow the steps for your target platform:

<Tabs>
<TabItem value="android" label="Android" default>

Add the `AndroidPermission` library to obtain device and network permissions:

1. Add the following code to your header file:

    <CodeBlock language="cpp" showLineNumbers>
    {`#if PLATFORM_ANDROID
   #include "AndroidPermission/Classes/AndroidPermissionFunctionLibrary.h"
   #endif`}
    </CodeBlock>

1. Add the `AndroidPermission` library to the `Project/Source/Project/Project.Build.cs` file:

    <CodeBlock language="cpp" showLineNumbers>
    {`if (Target.Platform == UnrealTargetPlatform.Android)
   {
       PrivateDependencyModuleNames.AddRange(new string[] { "AndroidPermission" });
   }`}
    </CodeBlock>

1. To check whether Android permissions have been granted, add the `CheckAndroidPermission` method and its implementation to the `AgoraWidget.h` and `AgoraWidget.cpp` files. 
    
    * `AgoraWidget.h`

        <CodeBlock language="cpp" showLineNumbers>
        {`private:
        // Get Android permissions
        void CheckAndroidPermission();`}
        </CodeBlock>

    * `AgoraWidget.cpp`

        <ProductWrapper notAllowed="voice-calling">
        <CodeBlock language="cpp" showLineNumbers>
        {`void UAgoraWidget::CheckAndroidPermission()
      {
      #if PLATFORM_ANDROID
          FString pathfromName = UGameplayStatics::GetPlatformName();
          if (pathfromName == "Android")
          {
              TArray<FString> AndroidPermission;
              AndroidPermission.Add(FString("android.permission.CAMERA"));
              AndroidPermission.Add(FString("android.permission.RECORD_AUDIO"));
              AndroidPermission.Add(FString("android.permission.READ_PHONE_STATE"));
              AndroidPermission.Add(FString("android.permission.WRITE_EXTERNAL_STORAGE"));
              AndroidPermission.Add(FString("android.permission.ACCESS_WIFI_STATE"));
              AndroidPermission.Add(FString("android.permission.ACCESS_NETWORK_STATE"));
              UAndroidPermissionFunctionLibrary::AcquirePermissions(AndroidPermission);
          }
      #endif
      }

      void UAgoraWidget::NativeConstruct()
      {
          Super::NativeConstruct();
      #if PLATFORM_ANDROID
          CheckAndroidPermission()
      #endif
      }`}
          </CodeBlock>
          </ProductWrapper>

            <ProductWrapper product="voice-calling">
            <CodeBlock language="cpp" showLineNumbers>
            {`void UAgoraWidget::CheckAndroidPermission()
        {
        #if PLATFORM_ANDROID
            FString pathfromName = UGameplayStatics::GetPlatformName();
            if (pathfromName == "Android")
            {
                TArray<FString> AndroidPermission;
                AndroidPermission.Add(FString("android.permission.RECORD_AUDIO"));
                AndroidPermission.Add(FString("android.permission.READ_PHONE_STATE"));
                AndroidPermission.Add(FString("android.permission.WRITE_EXTERNAL_STORAGE"));
                AndroidPermission.Add(FString("android.permission.ACCESS_WIFI_STATE"));
                AndroidPermission.Add(FString("android.permission.ACCESS_NETWORK_STATE"));
                UAndroidPermissionFunctionLibrary::AcquirePermissions(AndroidPermission);
            }
        #endif
        }

        void UAgoraWidget::NativeConstruct()
        {
            Super::NativeConstruct();
        #if PLATFORM_ANDROID
            CheckAndroidPermission()
        #endif
        }`}
        </CodeBlock>
        </ProductWrapper>

</TabItem>

<TabItem value="apple" label="iOS and macOS">

1. Refer to [How to add the permissions required for real-time interaction to an Unreal Engine project?](./)

1. In `Project/Source/Project.Target.cs`, add the following code:

    <CodeBlock language="cpp" showLineNumbers>
    {`public class unrealstartTarget : TargetRules
   {
       public unrealstartTarget( TargetInfo Target) : base(Target)
       {
           Type = TargetType.Game;
           DefaultBuildSettings = BuildSettingsVersion.V2;
           if (Target.Platform == UnrealTargetPlatform.IOS)
           {
               bOverrideBuildEnvironment = true;
               GlobalDefinitions.Add("FORCE_ANSI_ALLOCATOR=1")
           }
           ExtraModuleNames.AddRange( new string[] { "unrealstart" } );
       }
   }`}
    </CodeBlock>

</TabItem>
</Tabs>

<ProductWrapper notAllowed="voice-calling">

### Display the local video

Display the local video.

```cpp
AsyncTask(ENamedThreads::GameThread, =
{
    UE_LOG(LogTemp, Warning, TEXT("JoinChannelSuccess uid: %u"), uid);
    agora::rtc::VideoCanvas videoCanvas;
    videoCanvas.view = LocalVideo;
    videoCanvas.uid = 0;
    videoCanvas.sourceType = agora::rtc::VIDEO_SOURCE_TYPE::VIDEO_SOURCE_CAMERA;
    RtcEngineProxy->setupLocalVideo(videoCanvas);
});
```

### Display remote video

When a remote user joins the channel, display their video.

```cpp
// Set up remote video 
agora::rtc::VideoCanvas videoCanvas;
videoCanvas.view = RemoteVideo;
videoCanvas.uid = uid;
videoCanvas.sourceType = agora::rtc::VIDEO_SOURCE_TYPE::VIDEO_SOURCE_REMOTE;

agora::rtc::RtcConnection connection;
connection.channelId = TCHAR_TO_ANSI(*_channelName);

((agora::rtc::IRtcEngineEx*)RtcEngineProxy)->setupRemoteVideoEx(videoCanvas, connection);
```
</ProductWrapper>

### Leave a channel

To leave a channel call `leaveChannel`. Implement the following method:

* `AgoraWidget.h`

    ```cpp
    UFUNCTION(BlueprintCallable)
    void Leave();
    ```

* `AgoraWidget.cpp`
    
    ```cpp
    void UAgoraWidget::Leave()
    {
        // Leave the channel
        RtcEngineProxy->leaveChannel();
    }
    ```

### Release resources

When the local user leaves the channel, or exits the <Vpl k="CLIENT" />, release memory by calling the `release` method of `IRtcEngine`. Override the `NativeDestruct()` method and add its implementation as follows: 

* `AgoraWidget.h`

    ```cpp
    void NativeDestruct() override;
    ```

* `AgoraWidget.cpp`
    
    ```cpp
    void UAgoraWidget::NativeDestruct()
    {
        Super::NativeDestruct();
        if (RtcEngineProxy != nullptr)
        {
            RtcEngineProxy->unregisterEventHandler(this);
            RtcEngineProxy->release();
            delete RtcEngineProxy;

            RtcEngineProxy = nullptr;
        }
    }
    ```

### Complete sample code

A complete code sample demonstrating the basic process of real-time interaction is provided for your reference. To use the sample code, copy each of the following code blocks and paste it in the corresponding file.

<details> 
<summary><code>Project/Source/Project/AgoraWidget.h</code></summary>
<ProductWrapper notAllowed="voice-calling">

<CodeBlock language="cpp" showLineNumbers>
{`#pragma once

#include "CoreMinimal.h"
#include "Blueprint/UserWidget.h"

#if PLATFORM_ANDROID
#include "AndroidPermission/Classes/AndroidPermissionFunctionLibrary.h"
#endif

#include "AgoraPluginInterface.h"
#include "Components/Image.h"
#include "Components/Button.h"
#include "AgoraWidget.generated.h"

UCLASS()
class UNREALLEARNING_API UAgoraWidget : public UUserWidget, public agora::rtc::IRtcEngineEventHandler
{
    GENERATED_BODY()

public:
    // Fill in your app ID
    FString _appID = "";
    // Fill in your channel name
    FString _channelName = "";
    // Fill in a valid authentication token
    FString _token = "";

    UPROPERTY(BlueprintReadWrite, meta = (BindWidget))
    UImage* RemoteVideo = nullptr;

    UPROPERTY(BlueprintReadWrite, meta = (BindWidget))
    UImage* LocalVideo = nullptr;

    UPROPERTY(VisibleAnywhere, BlueprintReadWrite, meta = (BindWidget))
    UButton* JoinBtn = nullptr;

    UPROPERTY(VisibleAnywhere, BlueprintReadOnly, meta = (BindWidget))
    UButton* LeaveBtn = nullptr;

    UFUNCTION(BlueprintCallable)
    void Join();

    UFUNCTION(BlueprintCallable)
    void Leave();

    agora::rtc::IRtcEngine* RtcEngineProxy;

    // Callback triggered when the local user leaves the channel
    void onLeaveChannel(const agora::rtc::RtcStats& stats) override;
    // Callback triggered when a remote broadcaster successfully joins the channel
    void onUserJoined(agora::rtc::uid_t uid, int elapsed) override;
    // Callback triggered when a remote broadcaster leaves the channel
    void onUserOffline(agora::rtc::uid_t uid, agora::rtc::USER_OFFLINE_REASON_TYPE reason) override;
    // Callback triggered when the local user successfully joins the channel
    void onJoinChannelSuccess(const char* channel, agora::rtc::uid_t uid, int elapsed) override;

private:
    void CheckAndroidPermission(); // Get Android permissions
    void SetupSDKEngine(); // Create and initialize IRtcEngine
    void SetupUI(); // Set up UI elements

protected:
    void NativeConstruct() override; // Initialize the custom Widget
    void NativeDestruct() override; // Clean up all session-related resources
};`}
</CodeBlock>
</ProductWrapper>

<ProductWrapper product="voice-calling">
<CodeBlock language="cpp" showLineNumbers>
{`#pragma once

#include "CoreMinimal.h"
#include "Blueprint/UserWidget.h"

#if PLATFORM_ANDROID
#include "AndroidPermission/Classes/AndroidPermissionFunctionLibrary.h"
#endif

#include "AgoraPluginInterface.h"
#include "Components/Image.h"
#include "Components/Button.h"
#include "AgoraWidget.generated.h"

UCLASS()
class UNREALLEARNING_API UAgoraWidget : public UUserWidget, public agora::rtc::IRtcEngineEventHandler
{
    GENERATED_BODY()

public:
    // Fill in your App ID
    FString _appID = "";
    // Fill in your channel name
    FString _channelName = "";
    // Fill in Token
    FString _token = "";

    UPROPERTY(VisibleAnywhere, BlueprintReadWrite, meta = (BindWidget))
    UButton* JoinBtn = nullptr;

    UPROPERTY(VisibleAnywhere, BlueprintReadOnly, meta = (BindWidget))
    UButton* LeaveBtn = nullptr;

    UFUNCTION(BlueprintCallable)
    void Join();

    UFUNCTION(BlueprintCallable)
    void Leave();

    agora::rtc::IRtcEngine* RtcEngineProxy;

    // Callback triggered when the local user leaves the channel
    void onLeaveChannel(const agora::rtc::RtcStats& stats) override;
    // Callback triggered when a remote broadcaster successfully joins the channel
    void onUserJoined(agora::rtc::uid_t uid, int elapsed) override;
    // Callback triggered when a remote broadcaster leaves the channel
    void onUserOffline(agora::rtc::uid_t uid, agora::rtc::USER_OFFLINE_REASON_TYPE reason) override;
    // Callback triggered when the local user successfully joins the channel
    void onJoinChannelSuccess(const char* channel, agora::rtc::uid_t uid, int elapsed) override;

private:
    void CheckAndroidPermission(); // Get Android permissions
    void SetupSDKEngine(); // Create and initialize IRtcEngine
    void SetupUI(); // Set up UI elements

protected:
    void NativeConstruct() override; // Initialize the custom Widget
    void NativeDestruct() override; // Clean up all session-related resources
};`}
</CodeBlock>
</ProductWrapper>
</details> 

<details> 
<summary><code>Project/Source/Project/AgoraWidget.cpp</code></summary>
<ProductWrapper product="video-calling">
```cpp
#include "AgoraWidget.h"
void UAgoraWidget::CheckAndroidPermission()
{
#if PLATFORM_ANDROID
    FString pathfromName = UGameplayStatics::GetPlatformName();
    if (pathfromName == "Android")
    {
        TArray AndroidPermission;
        AndroidPermission.Add(FString("android.permission.CAMERA"));
        AndroidPermission.Add(FString("android.permission.RECORD_AUDIO"));
        AndroidPermission.Add(FString("android.permission.READ_PHONE_STATE"));
        AndroidPermission.Add(FString("android.permission.WRITE_EXTERNAL_STORAGE"));
        UAndroidPermissionFunctionLibrary::AcquirePermissions(AndroidPermission);
    }
#endif
}
void UAgoraWidget::SetupSDKEngine()
{
    agora::rtc::RtcEngineContext RtcEngineContext;
    RtcEngineContext.appId = TCHAR_TO_ANSI(*_appID);
    RtcEngineContext.eventHandler = this;
    RtcEngineProxy = agora::rtc::ue::createAgoraRtcEngine();
    RtcEngineProxy->initialize(RtcEngineContext);
}
void UAgoraWidget::SetupUI()
{
    JoinBtn->OnClicked.AddDynamic(this, &UAgoraWidget::Join);
    LeaveBtn->OnClicked.AddDynamic(this, &UAgoraWidget::Leave);
}
void UAgoraWidget::Join()
{
    RtcEngineProxy->enableVideo();
    agora::rtc::ChannelMediaOptions options;
    options.autoSubscribeAudio = true;
    options.autoSubscribeVideo = true;
    options.publishCameraTrack = true;
    options.publishMicrophoneTrack = true;
    options.channelProfile = agora::CHANNEL_PROFILE_TYPE::CHANNEL_PROFILE_COMMUNICATION;
    options.clientRoleType = agora::rtc::CLIENT_ROLE_TYPE::CLIENT_ROLE_BROADCASTER;
    RtcEngineProxy->joinChannel(TCHAR_TO_ANSI(_token), TCHAR_TO_ANSI(_channelName), 0, options);
}
void UAgoraWidget::Leave()
{
    RtcEngineProxy->leaveChannel();
}
void UAgoraWidget::NativeConstruct()
{
    Super::NativeConstruct();
    #if PLATFORM_ANDROID
        CheckAndroidPermission()
    #endif
    SetupUI();
    SetupSDKEngine();
}
void UAgoraWidget::NativeDestruct()
{
    Super::NativeDestruct();
    if (RtcEngineProxy != nullptr)
    {
        RtcEngineProxy->unregisterEventHandler(this);
        RtcEngineProxy->release();
        delete RtcEngineProxy;
        RtcEngineProxy = nullptr;
    }
}
void UAgoraWidget::onUserJoined(agora::rtc::uid_t uid, int elapsed)
{
    agora::rtc::VideoCanvas videoCanvas;
    videoCanvas.view = RemoteVideo;
    videoCanvas.uid = uid;
    videoCanvas.sourceType = agora::rtc::VIDEO_SOURCE_TYPE::VIDEO_SOURCE_REMOTE;
    agora::rtc::RtcConnection connection;
    connection.channelId = TCHAR_TO_ANSI(*_channelName);
    ((agora::rtc::IRtcEngineEx*)RtcEngineProxy)->setupRemoteVideoEx(videoCanvas, connection);
}
void UAgoraWidget::onUserOffline(agora::rtc::uid_t uid, agora::rtc::USER_OFFLINE_REASON_TYPE reason)
{
    agora::rtc::VideoCanvas videoCanvas;
    videoCanvas.view = nullptr;
    videoCanvas.uid = uid;
    videoCanvas.sourceType = agora::rtc::VIDEO_SOURCE_TYPE::VIDEO_SOURCE_REMOTE;
    agora::rtc::RtcConnection connection;
    connection.channelId = TCHAR_TO_ANSI(*_channelName);
    ((agora::rtc::IRtcEngineEx*)RtcEngineProxy)->setupRemoteVideoEx(videoCanvas, connection);
}
void UAgoraWidget::onJoinChannelSuccess(const char* channel, agora::rtc::uid_t uid, int elapsed)
{
    AsyncTask(ENamedThreads::GameThread, =
    {
        UE_LOG(LogTemp, Warning, TEXT("JoinChannelSuccess uid: %u"), uid);
        agora::rtc::VideoCanvas videoCanvas;
        videoCanvas.view = LocalVideo;
        videoCanvas.uid = 0;
        videoCanvas.sourceType = agora::rtc::VIDEO_SOURCE_TYPE::VIDEO_SOURCE_CAMERA;
        RtcEngineProxy->setupLocalVideo(videoCanvas);
    });
}
void UAgoraWidget::onLeaveChannel(const agora::rtc::RtcStats& stats)
{
    AsyncTask(ENamedThreads::GameThread, =
    {
        agora::rtc::VideoCanvas videoCanvas;
        videoCanvas.view = nullptr;
        videoCanvas.uid = 0;
        videoCanvas.sourceType = agora::rtc::VIDEO_SOURCE_TYPE::VIDEO_SOURCE_CAMERA;
        RtcEngineProxy->setupLocalVideo(videoCanvas);
    });
}
```
</ProductWrapper>

<ProductWrapper product="interactive-live-streaming">
<CodeBlock language="cpp" showLineNumbers>
{`#include "AgoraWidget.h"
void UAgoraWidget::CheckAndroidPermission()
{
#if PLATFORM_ANDROID
    FString pathfromName = UGameplayStatics::GetPlatformName();
    if (pathfromName == "Android")
    {
        TArray AndroidPermission;
        AndroidPermission.Add(FString("android.permission.CAMERA"));
        AndroidPermission.Add(FString("android.permission.RECORD_AUDIO"));
        AndroidPermission.Add(FString("android.permission.READ_PHONE_STATE"));
        AndroidPermission.Add(FString("android.permission.WRITE_EXTERNAL_STORAGE"));
        UAndroidPermissionFunctionLibrary::AcquirePermissions(AndroidPermission);
    }
#endif
}
void UAgoraWidget::SetupSDKEngine()
{
    agora::rtc::RtcEngineContext RtcEngineContext;
    RtcEngineContext.appId = TCHAR_TO_ANSI(*_appID);
    RtcEngineContext.eventHandler = this;
    RtcEngineProxy = agora::rtc::ue::createAgoraRtcEngine();
    RtcEngineProxy->initialize(RtcEngineContext);
}
void UAgoraWidget::SetupUI()
{
    JoinBtn->OnClicked.AddDynamic(this, &UAgoraWidget::Join);
    LeaveBtn->OnClicked.AddDynamic(this, &UAgoraWidget::Leave);
}
void UAgoraWidget::Join()
{
    RtcEngineProxy->enableVideo();
    agora::rtc::ChannelMediaOptions options;
    options.autoSubscribeAudio = true;
    options.autoSubscribeVideo = true;
    options.publishCameraTrack = true;
    options.publishMicrophoneTrack = true;
    options.channelProfile = agora::CHANNEL_PROFILE_TYPE::CHANNEL_PROFILE_LIVE_BROADCASTING;
    options.clientRoleType = agora::rtc::CLIENT_ROLE_TYPE::CLIENT_ROLE_BROADCASTER;
    options.audienceLatencyLevel = agora::rtc::AUDIENCE_LATENCY_LEVEL_TYPE::AUDIENCE_LATENCY_LEVEL_ULTRA_LOW_LATENCY;
    RtcEngineProxy->joinChannel(TCHAR_TO_ANSI(_token), TCHAR_TO_ANSI(_channelName), 0, options);
}
void UAgoraWidget::Leave()
{
    RtcEngineProxy->leaveChannel();
}
void UAgoraWidget::NativeConstruct()
{
    Super::NativeConstruct();
    #if PLATFORM_ANDROID
        CheckAndroidPermission()
    #endif
    SetupUI();
    SetupSDKEngine();
}
void UAgoraWidget::NativeDestruct()
{
    Super::NativeDestruct();
    if (RtcEngineProxy != nullptr)
    {
        RtcEngineProxy->unregisterEventHandler(this);
        RtcEngineProxy->release();
        delete RtcEngineProxy;
        RtcEngineProxy = nullptr;
    }
}
void UAgoraWidget::onUserJoined(agora::rtc::uid_t uid, int elapsed)
{
    agora::rtc::VideoCanvas videoCanvas;
    videoCanvas.view = RemoteVideo;
    videoCanvas.uid = uid;
    videoCanvas.sourceType = agora::rtc::VIDEO_SOURCE_TYPE::VIDEO_SOURCE_REMOTE;
    agora::rtc::RtcConnection connection;
    connection.channelId = TCHAR_TO_ANSI(*_channelName);
    ((agora::rtc::IRtcEngineEx*)RtcEngineProxy)->setupRemoteVideoEx(videoCanvas, connection);
}
void UAgoraWidget::onUserOffline(agora::rtc::uid_t uid, agora::rtc::USER_OFFLINE_REASON_TYPE reason)
{
    agora::rtc::VideoCanvas videoCanvas;
    videoCanvas.view = nullptr;
    videoCanvas.uid = uid;
    videoCanvas.sourceType = agora::rtc::VIDEO_SOURCE_TYPE::VIDEO_SOURCE_REMOTE;
    agora::rtc::RtcConnection connection;
    connection.channelId = TCHAR_TO_ANSI(*_channelName);
    ((agora::rtc::IRtcEngineEx*)RtcEngineProxy)->setupRemoteVideoEx(videoCanvas, connection);
}
void UAgoraWidget::onJoinChannelSuccess(const char* channel, agora::rtc::uid_t uid, int elapsed)
{
    AsyncTask(ENamedThreads::GameThread, =
    {
        UE_LOG(LogTemp, Warning, TEXT("JoinChannelSuccess uid: %u"), uid);
        agora::rtc::VideoCanvas videoCanvas;
        videoCanvas.view = LocalVideo;
        videoCanvas.uid = 0;
        videoCanvas.sourceType = agora::rtc::VIDEO_SOURCE_TYPE::VIDEO_SOURCE_CAMERA;
        RtcEngineProxy->setupLocalVideo(videoCanvas);
    });
}
void UAgoraWidget::onLeaveChannel(const agora::rtc::RtcStats& stats)
{
    AsyncTask(ENamedThreads::GameThread, =
    {
        agora::rtc::VideoCanvas videoCanvas;
        videoCanvas.view = nullptr;
        videoCanvas.uid = 0;
        videoCanvas.sourceType = agora::rtc::VIDEO_SOURCE_TYPE::VIDEO_SOURCE_CAMERA;
        RtcEngineProxy->setupLocalVideo(videoCanvas);
    });
}`}
</CodeBlock>
</ProductWrapper>

<ProductWrapper product="broadcast-streaming">
<CodeBlock language="cpp" showLineNumbers>
{`#include "AgoraWidget.h"
void UAgoraWidget::CheckAndroidPermission()
{
#if PLATFORM_ANDROID
    FString pathfromName = UGameplayStatics::GetPlatformName();
    if (pathfromName == "Android")
    {
        TArray AndroidPermission;
        AndroidPermission.Add(FString("android.permission.CAMERA"));
        AndroidPermission.Add(FString("android.permission.RECORD_AUDIO"));
        AndroidPermission.Add(FString("android.permission.READ_PHONE_STATE"));
        AndroidPermission.Add(FString("android.permission.WRITE_EXTERNAL_STORAGE"));
        UAndroidPermissionFunctionLibrary::AcquirePermissions(AndroidPermission);
    }
#endif
}
void UAgoraWidget::SetupSDKEngine()
{
    agora::rtc::RtcEngineContext RtcEngineContext;
    RtcEngineContext.appId = TCHAR_TO_ANSI(*_appID);
    RtcEngineContext.eventHandler = this;
    RtcEngineProxy = agora::rtc::ue::createAgoraRtcEngine();
    RtcEngineProxy->initialize(RtcEngineContext);
}
void UAgoraWidget::SetupUI()
{
    JoinBtn->OnClicked.AddDynamic(this, &UAgoraWidget::Join);
    LeaveBtn->OnClicked.AddDynamic(this, &UAgoraWidget::Leave);
}
void UAgoraWidget::Join()
{
    RtcEngineProxy->enableVideo();
    agora::rtc::ChannelMediaOptions options;
    options.autoSubscribeAudio = true;
    options.autoSubscribeVideo = true;
    options.publishCameraTrack = true;
    options.publishMicrophoneTrack = true;
    options.channelProfile = agora::CHANNEL_PROFILE_TYPE::CHANNEL_PROFILE_LIVE_BROADCASTING;
    options.clientRoleType = agora::rtc::CLIENT_ROLE_TYPE::CLIENT_ROLE_BROADCASTER;
    options.audienceLatencyLevel = agora::rtc::AUDIENCE_LATENCY_LEVEL_TYPE::AUDIENCE_LATENCY_LEVEL_LOW_LATENCY;
    RtcEngineProxy->joinChannel(TCHAR_TO_ANSI(_token), TCHAR_TO_ANSI(_channelName), 0, options);
}
void UAgoraWidget::Leave()
{
    RtcEngineProxy->leaveChannel();
}
void UAgoraWidget::NativeConstruct()
{
    Super::NativeConstruct();
    #if PLATFORM_ANDROID
        CheckAndroidPermission()
    #endif
    SetupUI();
    SetupSDKEngine();
}
void UAgoraWidget::NativeDestruct()
{
    Super::NativeDestruct();
    if (RtcEngineProxy != nullptr)
    {
        RtcEngineProxy->unregisterEventHandler(this);
        RtcEngineProxy->release();
        delete RtcEngineProxy;
        RtcEngineProxy = nullptr;
    }
}
void UAgoraWidget::onUserJoined(agora::rtc::uid_t uid, int elapsed)
{
    agora::rtc::VideoCanvas videoCanvas;
    videoCanvas.view = RemoteVideo;
    videoCanvas.uid = uid;
    videoCanvas.sourceType = agora::rtc::VIDEO_SOURCE_TYPE::VIDEO_SOURCE_REMOTE;
    agora::rtc::RtcConnection connection;
    connection.channelId = TCHAR_TO_ANSI(*_channelName);
    ((agora::rtc::IRtcEngineEx*)RtcEngineProxy)->setupRemoteVideoEx(videoCanvas, connection);
}
void UAgoraWidget::onUserOffline(agora::rtc::uid_t uid, agora::rtc::USER_OFFLINE_REASON_TYPE reason)
{
    agora::rtc::VideoCanvas videoCanvas;
    videoCanvas.view = nullptr;
    videoCanvas.uid = uid;
    videoCanvas.sourceType = agora::rtc::VIDEO_SOURCE_TYPE::VIDEO_SOURCE_REMOTE;
    agora::rtc::RtcConnection connection;
    connection.channelId = TCHAR_TO_ANSI(*_channelName);
    ((agora::rtc::IRtcEngineEx*)RtcEngineProxy)->setupRemoteVideoEx(videoCanvas, connection);
}
void UAgoraWidget::onJoinChannelSuccess(const char* channel, agora::rtc::uid_t uid, int elapsed)
{
    AsyncTask(ENamedThreads::GameThread, =
    {
        UE_LOG(LogTemp, Warning, TEXT("JoinChannelSuccess uid: %u"), uid);
        agora::rtc::VideoCanvas videoCanvas;
        videoCanvas.view = LocalVideo;
        videoCanvas.uid = 0;
        videoCanvas.sourceType = agora::rtc::VIDEO_SOURCE_TYPE::VIDEO_SOURCE_CAMERA;
        RtcEngineProxy->setupLocalVideo(videoCanvas);
    });
}
void UAgoraWidget::onLeaveChannel(const agora::rtc::RtcStats& stats)
{
    AsyncTask(ENamedThreads::GameThread, =
    {
        agora::rtc::VideoCanvas videoCanvas;
        videoCanvas.view = nullptr;
        videoCanvas.uid = 0;
        videoCanvas.sourceType = agora::rtc::VIDEO_SOURCE_TYPE::VIDEO_SOURCE_CAMERA;
        RtcEngineProxy->setupLocalVideo(videoCanvas);
    });
}`}
</CodeBlock>
</ProductWrapper>

<ProductWrapper product="voice-calling">
<CodeBlock language="cpp" showLineNumbers>
{`#include "AgoraWidget.h"

void UAgoraWidget::CheckAndroidPermission()
{
#if PLATFORM_ANDROID
    // Get the platform name
    FString pathfromName = UGameplayStatics::GetPlatformName();
    // Check if the platform is Android
    if (pathfromName == "Android")
    {
        // Array to store Android permissions
        TArray AndroidPermission;
        // Add required permissions
        AndroidPermission.Add(FString("android.permission.RECORD_AUDIO"));
        AndroidPermission.Add(FString("android.permission.READ_PHONE_STATE"));
        AndroidPermission.Add(FString("android.permission.WRITE_EXTERNAL_STORAGE"));
        // Request permissions
        UAndroidPermissionFunctionLibrary::AcquirePermissions(AndroidPermission);
    }
#endif
}

void UAgoraWidget::SetupSDKEngine()
{
    // Create RtcEngineContext
    agora::rtc::RtcEngineContext RtcEngineContext;
    // Set App ID
    RtcEngineContext.appId = TCHAR_TO_ANSI(*_appID);
    // Set event handler
    RtcEngineContext.eventHandler = this;
    // Create and initialize RtcEngineProxy
    RtcEngineProxy = agora::rtc::ue::createAgoraRtcEngine();
    RtcEngineProxy->initialize(RtcEngineContext);
}

void UAgoraWidget::SetupUI()
{
    // Bind event handlers to UI buttons
    JoinBtn->OnClicked.AddDynamic(this, &UAgoraWidget::Join);
    LeaveBtn->OnClicked.AddDynamic(this, &UAgoraWidget::Leave);
}

void UAgoraWidget::Join()
{
    // Set channel media options
    agora::rtc::ChannelMediaOptions options;
    // Automatically subscribe to all audio streams
    options.autoSubscribeAudio = true;
    // Publish the audio collected by the microphone
    options.publishMicrophoneTrack = true;
    // Set channel profile to live broadcasting
    options.channelProfile = agora::CHANNEL_PROFILE_TYPE::CHANNEL_PROFILE_COMMUNICATION;
    // Set user role to broadcaster
    options.clientRoleType = agora::rtc::CLIENT_ROLE_TYPE::CLIENT_ROLE_BROADCASTER;
    // Join the channel
    RtcEngineProxy->joinChannel(TCHAR_TO_ANSI(_token), TCHAR_TO_ANSI(_channelName), 0 , options);
}

void UAgoraWidget::Leave()
{
    // Leave the channel
    RtcEngineProxy->leaveChannel();
}

void UAgoraWidget::NativeConstruct()
{
    Super::NativeConstruct();
#if PLATFORM_ANDROID
    // Check and request Android permissions
    CheckAndroidPermission();
#endif
    // Setup UI elements
    SetupUI();
    // Setup Agora SDK engine
    SetupSDKEngine();
}

void UAgoraWidget::NativeDestruct()
{
    Super::NativeDestruct();
    // Clean up resources
    if (RtcEngineProxy != nullptr)
    {
        RtcEngineProxy->unregisterEventHandler(this);
        RtcEngineProxy->release();
        delete RtcEngineProxy;
        RtcEngineProxy = nullptr;
    }
}

void UAgoraWidget::onUserJoined(agora::rtc::uid_t uid, int elapsed)
{
    // Callback when a remote user joins the channel
    agora::rtc::RtcConnection connection;
    connection.channelId = TCHAR_TO_ANSI(*_channelName);
}

void UAgoraWidget::onUserOffline(agora::rtc::uid_t uid, agora::rtc::USER_OFFLINE_REASON_TYPE reason)
{
    // Callback when a remote user leaves the channel
    agora::rtc::RtcConnection connection;
    connection.channelId = TCHAR_TO_ANSI(*_channelName);
}

void UAgoraWidget::onJoinChannelSuccess(const char* channel, agora::rtc::uid_t uid, int elapsed)
{
    // Callback when the local user successfully joins the channel
    AsyncTask(ENamedThreads::GameThread, =
    {
        UE_LOG(LogTemp, Warning, TEXT("JoinChannelSuccess uid: %u"), uid);
    });
}`}
</CodeBlock>
</ProductWrapper>
</details> 

<details> 
<summary><code>Project/Source/Project/Project.Build.cs</code></summary>

<CodeBlock language="csharp" showLineNumbers>
{`using UnrealBuildTool;

public class UnrealLearning : ModuleRules
{
    public UnrealLearning(ReadOnlyTargetRules Target) : base(Target)
    {
        PCHUsage = PCHUsageMode.UseExplicitOrSharedPCHs;

        PublicDependencyModuleNames.AddRange(new string[] 
        { 
            "Core", 
            "CoreUObject", 
            "Engine", 
            "InputCore", 
            "AgoraPlugin" 
        });

        if (Target.Platform == UnrealTargetPlatform.Android)
        {
            PrivateDependencyModuleNames.AddRange(new string[] { "AndroidPermission" });
        }

        PrivateDependencyModuleNames.AddRange(new string[] { });

        // Uncomment if you are using Slate UI
        // PrivateDependencyModuleNames.AddRange(new string[] { "Slate", "SlateCore" });

        // Uncomment if you are using online features
        // PrivateDependencyModuleNames.Add("OnlineSubsystem");

        // To include OnlineSubsystemSteam, add it to the plugins section in your uproject file with the Enabled attribute set to true
    }
}`}
</CodeBlock>
</details> 

### Create a user interface

Refer to the following step-by-step guide to create a basic UI. If you already have a UI in your project, skip to the next section.

<details>
<summary>Create a basic UI</summary>
<PlatformWrapper platform="blueprint">

1. Create Widget Blueprint.
    1. In the **Content** folder of **Content Browser**, right-click and select **User Interface > Widget Blueprint** to create a Widget Blueprint and name it **BP_VideoWidget**.
    1. Double-click to open **BP_VideoWidget**. You see **BP_VideoWidget > Canvas Panel** in the **Hierarchy panel**.
    <ProductWrapper product="voice-calling">    
    3. Create a background view. In the **Palette** panel, select **Common > Image**, drag it to the **Canvas Panel**, and name it **background**. Adjust it to the canvas size by dragging it, and adjust the background color in the **Details** panel.
    </ProductWrapper>
<ProductWrapper notAllowed="voice-calling">

1. Create local and remote video windows in Widget Blueprint.
    1. Create a background view. In the **Palette** panel, select **Common > Image**, drag it to the **Canvas Panel**, and name it **background**. Adjust it to the canvas size by dragging it, and adjust the background color in the **Details** panel.
    1. Create a local view window. In the **Palette** panel, select **Common > Image** and drag it to the **Canvas Panel**. Name it **Img_LocalVideoView** and adjust its position and size on the canvas in the **Details** panel:

        * **Position X**: `-500`
        * **Position Y**: `-100`
        * **Size X**: `640`
        * **Size Y**: `360`

    1. Repeat the previous steps to create a remote view window, name it **Img_RemoteVideoView**, and adjust its position and size on the canvas as follows:

        * **Position X**: `500`
        * **Position Y**: `-100`
        * **Size X**: `640`
        * **Size Y**: `360`

1. Create buttons to join and leave the channel in the Widget Blueprint.
    1. Create a join channel button. Select **Common > Button**, drag it to the **Canvas Panel**, and rename it **Btn_JoinChannel**. Adjust its position and size on the canvas as follows:
        
        * **Position X**: `-500`
        * **Position Y**：`200`
        * **Size X**: `100`
        * **Size Y**: `130`

    1. Select **Common > Text**, drag it to **Btn_JoinChannel**, and modify the **Text** content to **Join Channel** in the **Details** panel.
    1. Repeat the previous steps to create a leave channel button, name it **Btn_LeaveChannel**, and modify the **Text** content to **Leave Channel**. Adjust the button's position and size on the canvas as follows:
        
        * **Position X**: `500`
        * **Position X**: `200`
        * **Size X**: `130`
        * **Size Y**: `130`

1. Save your changes.
</ProductWrapper>

<ProductWrapper product="voice-calling">

2. Create buttons to join and leave the channel in the Widget Blueprint.
    1. Create a join channel button. Select **Common > Button**, drag it to the **Canvas Panel**, and rename it **Btn_JoinChannel**. Adjust its position and size on the canvas as follows:
        
        * **Position X**: `-400`
        * **Position Y**：`0`
        * **Size X**: `300`
        * **Size Y**: `50`

    1. Select **Common > Text**, drag it to **Btn_JoinChannel**, and modify the **Text** content to **Join Channel** in the **Details** panel.
    1. Repeat the previous steps to create a leave channel button, name it **Btn_LeaveChannel**, and modify the **Text** content to **Leave Channel**. Adjust the button's position and size on the canvas as follows:
        
        * **Position X**: `100`
        * **Position X**: `0`
        * **Size X**: `300`
        * **Size Y**: `50`

1. Save your changes.
</ProductWrapper>

</PlatformWrapper>

<PlatformWrapper platform="unreal">

1. Create **Widget Blueprint**

    In Unreal Editor, click **Content Drawer > Content**, right-click and select **User Interface > Widget Blueprint**. Name the new Widget Blueprint **AgoraWidget** and double-click it to open.

    ![](/images/video-sdk/unreal-setup-ui-1.png)

1. Create a view canvas. 
    
    Select **Palette > PANEL > Canvas Panel** and drag it to **AgoraWidget**.

    ![](/images/video-sdk/unreal-setup-ui-2.png)

1. Create join and leave channel buttons in Widget Blueprint

    1. In **AgoraWidget**, select **COMMON > Button**, drag it to the **Canvas Panel**, and rename it to **JoinBtn**. Adjust the button's size and position on the canvas or use the following sample settings:

        * **Position X**：`300`
        * **Position Y**: `700`
        * **Size X**：`240`
        * **Size Y**: `120`

    1. Select **COMMON > Text** and drag it to **JoinBtn**. Select the **Text** control of **JoinBtn**, and change the text content of **Text** to **Join** in the **Details** panel.

    1. Repeat the above steps to create a **LeaveBtn**. Adjust the button size and position according to your layout design.

<ProductWrapper notAllowed ="voice-calling">

4. Create local and remote views in the Widget Blueprint
    
    1. Select **COMMON > Image**, drag it to the **Canvas Panel**, rename it **LocalVideo**. Adjust its position and size on the canvas. Use the following values, or specify as per your own layout design:

        * **Position X**：`350`
        * **Position Y**: `150`
        * **Size X**：`450`
        * **Size Y**: `450`

    1. Repeat the above steps to create a remote view and name it **RemoteVideo**. Adjust its position and size on the canvas. Use the following values, or specify as per your own layout design:

        * **Position X**：`1200`
        * **Position Y**: `150`
        * **Size X**：`450`
        * **Size Y**: `450`

1. Save the changes. Your user interface in **Widget Blueprint** looks similar to the following:

    ![](/images/video-sdk/unreal-setup-ui-3.png)

</ProductWrapper>
<ProductWrapper product="voice-calling">
4. Save your changes.
</ProductWrapper>

5. Create a **Level Blueprint** and associate it with the created **Widget Blueprint**

    1. In **Unreal Editor**, click **Content Drawer**, right-click to select **Level**, and name it **agoraLevel**.

    1. Double-click to open **agoraLevel** and click **Open Level Blueprint**.

        ![](/images/video-sdk/unreal-setup-ui-4.png)

    1. Right-click and enter **Create Widget** in the search box. Select the created **AgoraWidget**, create **Event BeginPlay** and **Add to Viewport** in the same way. Connect them as follows:

        ![](/images/video-sdk/unreal-setup-ui-5.png)

    <ProductWrapper notAllowed="voice-calling">
    3. Save your changes and run the project. The UI you have created looks similar to the following:

        ![](/images/video-sdk/unreal-setup-ui-6.png)
    </ProductWrapper>
    <ProductWrapper product="voice-calling">
    3. Save your changes and run the project.
    </ProductWrapper>
</PlatformWrapper>

</details>

</PlatformWrapper>