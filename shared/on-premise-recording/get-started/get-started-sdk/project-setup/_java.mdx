import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import CodeBlock from '@theme/CodeBlock';

<PlatformWrapper platform="linux-java">
<Tabs groupId="language">
<TabItem value="maven" label="Add using Maven" default>
Add the following dependencies to your project’s` pom.xml` file based on your platform:

* **For x86_64 platforms**:

  <CodeBlock language="xml" showLineNumbers>
  {`<dependency>
    <groupId>io.agora.rtc</groupId>
    <artifactId>linux-recording-java-sdk</artifactId>
    <version>4.4.150.5</version>
  </dependency>`}
  </CodeBlock>

* **For arm64 platforms**:
  <CodeBlock language="xml" showLineNumbers>
  {`<dependency>
    <groupId>io.agora.rtc</groupId>
    <artifactId>linux-recording-java-sdk</artifactId>
    <version>4.4.150.5-aarch64</version>
  </dependency>`}
  </CodeBlock>

</TabItem>
<TabItem value="manual" label="Add manually" default>

### Download and unzip

1. Download the latest <Vg k="OPREC_SDK" /> package from the [SDKs](/sdks?platform=linux) page.

1. Unzip the SDK and you see the following contents:

    <CodeBlock language="txt" showLineNumbers>
    {`doc/                            JavaDoc documentation
   examples/                       Sample projects and code
   sdk/                            Core SDK files
   sdk/agora-recording-sdk.jar     Java class library
   sdk/agora-recording-sdk-javadoc.jar  JavaDoc (optional, for IDE support)`}
    </CodeBlock>
    
### Integrate the SDK

**Method 1: Use a local maven repository**

1. Install the SDK JAR using Maven:

    To install only the SDK JAR:
      <CodeBlock language="sh" showLineNumbers>
      {`mvn install:install-file \\
    -Dfile=sdk/agora-recording-sdk.jar \\
    -DgroupId=io.agora.rtc \\
    -DartifactId=linux-recording-java-sdk \\
    -Dversion=4.4.150.5 \\
    -Dpackaging=jar \\
    -DgeneratePom=true \\`}
      </CodeBlock>

    To install both the SDK JAR and JavaDoc:

      <CodeBlock language="sh" showLineNumbers>
      {`mvn install:install-file \\
    -Dfile=sdk/agora-recording-sdk.jar \\
    -DgroupId=io.agora.rtc \\
    -DartifactId=linux-recording-java-sdk \\
    -Dversion=4.4.150.5 \\
    -Dpackaging=jar \\
    -DgeneratePom=true \\
    -Djavadoc=sdk/agora-recording-sdk-javadoc.jar`}
      </CodeBlock>

1. Add the dependency to your `pom.xml`:

    <CodeBlock language="xml" showLineNumbers>
    {`<dependency>
      <groupId>io.agora.rtc</groupId>
      <artifactId>linux-recording-java-sdk</artifactId>
      <version>4.4.150.5</version>
    </dependency>`}
    </CodeBlock>

**Method 2: Reference the JAR directly**

1. Create a `libs` directory and copy the JAR files:

    <CodeBlock language="sh" showLineNumbers>
    {`mkdir -p libs
   cp sdk/agora-recording-sdk.jar libs/
   cp sdk/agora-recording-sdk-javadoc.jar libs/  # Optional, for IDE JavaDoc support`}
    </CodeBlock>

2. Add the JAR file to your classpath when compiling or running:

    <CodeBlock language="xml" showLineNumbers>
    {`java -cp .:libs/agora-recording-sdk.jar YourMainClass`}
    </CodeBlock>

    <Admonition type="info" info="info">
    To enable JavaDoc support in your IDE (such as IntelliJ IDEA or Eclipse), attach `agora-recording-sdk-javadoc.jar` to the library reference.
    </Admonition>

### Load native libraries

The SDK depends on native `.so` libraries written in C++. Whether you integrate the SDK using Maven or manually, you must ensure the Java Virtual Machine (JVM) can locate and load these libraries at runtime.

**Step 1: Extract native `.so` files**

The native `.so` files are bundled inside the `agora-recording-sdk.jar` or `linux-recording-java-sdk-<version>.jar` file. You need to extract them manually:

1. Create a directory to store the native library files:

    <CodeBlock language="bash" showLineNumbers>
    {`mkdir -p libs
   cd libs`}
    </CodeBlock>

2. Use the `jar` command to extract contents:

    If you're using the local SDK:

    <CodeBlock language="sh" showLineNumbers>
    {`jar xvf agora-recording-sdk.jar`}
    </CodeBlock>

    If you're using the Maven-installed SDK:

    <CodeBlock language="sh" showLineNumbers>
    {`jar xvf ~/.m2/repository/io/agora/rtc/linux-recording-java-sdk/4.4.150.5/linux-recording-java-sdk-4.4.150.5.jar`}
    </CodeBlock>

    After extraction, you'll find a directory structure like this:

    <CodeBlock language="txt" showLineNumbers>
    {`libs/
   ├── agora-recording-sdk.jar
   ├── native/
   │   └── linux/
   │       ├── x86_64/
   │       │   ├── libagora_rtc_sdk.so
   │       │   ├── libagora-fdkaac.so
   │       │   ├── libaosl.so
   │       │   └── librecording.so
   │       └── aarch64/   (if available for arm64)`}
   </CodeBlock>

**Step 2: Configure the library load path**

The JVM must be configured to locate the extracted `.so` files. You can do this in one of two ways:

* **Option 1: Use `LD_LIBRARY_PATH` (Recommended)**

    1. Set the environment variable before launching your app:

        <CodeBlock language="sh" showLineNumbers>
        {`# Assuming the .so files are in ./libs/native/linux/x86_64
       LIB_DIR=$(pwd)/libs/native/linux/x86_64
       export LD_LIBRARY_PATH=$LIB_DIR:$LD_LIBRARY_PATH`}
        </CodeBlock>

    2. Run your application:

        <CodeBlock language="xml" showLineNumbers>
        {`java -jar your-app.jar
       # Or with classpath:
       java -cp "your-classpath" YourMainClass`}
       </CodeBlock>

* **Option 2: Use JVM option `-Djava.library.path`**

    This method directly tells the JVM where to find the native libraries:

    <CodeBlock language="xml" showLineNumbers>
    {`java -Djava.library.path=./libs/native/linux/x86_64 -jar your-app.jar
  # Or with classpath:
  java -Djava.library.path=./libs/native/linux/x86_64 -cp "your-classpath" YourMainClass`}
    </CodeBlock>


      <Admonition type="info" info="info">
      Using `LD_LIBRARY_PATH` is more reliable, especially when native libraries depend on each other.
      </Admonition>

**Step 3: Automate with a startup script (Optional)**

You can create a shell script to automate the setup:

  <CodeBlock language="sh" showLineNumbers>
  {`#!/bin/bash

# Get the directory of this script
SCRIPT_DIR="\$(cd "\$(dirname "\${BASH_SOURCE[0]}")" && pwd)"

# Define paths
LIB_PATH="$SCRIPT_DIR/libs/native/linux/x86_64"
SDK_JAR="$SCRIPT_DIR/libs/agora-recording-sdk.jar"
MAIN_CLASS="your.main.Class"
APP_CP="your-other-classpaths"

# Set environment variable
export LD_LIBRARY_PATH=$LIB_PATH:$LD_LIBRARY_PATH

# Build full classpath
CLASSPATH=".:$SDK_JAR:$APP_CP"

# Run Java program
java -Djava.library.path=$LIB_PATH -cp "$CLASSPATH" $MAIN_CLASS`}
  </CodeBlock>

Make the script executable:

<CodeBlock language="sh" showLineNumbers>
{`chmod +x run.sh
./run.sh`}
</CodeBlock>

</TabItem>
</Tabs>
</PlatformWrapper>
