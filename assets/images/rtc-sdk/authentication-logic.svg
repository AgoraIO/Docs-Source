<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="641px" preserveAspectRatio="none" style="width:726px;height:641px;" version="1.1" viewBox="0 0 726 641" width="726px" zoomAndPan="magnify"><defs/><g><rect fill="none" height="639.5234" style="stroke:#0A9EFD;stroke-width:1;" width="724.4438" x="0" y="0"/><rect fill="#999999" fill-opacity="0.33333" height="629.5234" style="stroke:#0A9EFD;stroke-width:0.5;" width="375.3564" x="16" y="6"/><text fill="#0A9EFD" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="125.6899" x="140.8333" y="19.4951">Implemented by you</text><rect fill="#999999" fill-opacity="0.33333" height="629.5234" style="stroke:#0A9EFD;stroke-width:0.5;" width="121.5781" x="587.1694" y="6"/><text fill="#0A9EFD" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="115.5781" x="590.1694" y="19.4951">Provided by Agora</text><rect fill="#0A9EFD" fill-opacity="0.06667" height="291.3848" style="stroke:#0A9EFD;stroke-width:2;" width="710.4438" x="10" y="74.4502"/><rect fill="#0A9EFD" fill-opacity="0.06667" height="204.5898" style="stroke:#0A9EFD;stroke-width:2;" width="684.2266" x="10" y="379.835"/><g><title>Token server</title><rect fill="#000000" fill-opacity="0.00000" height="543.9746" width="8" x="63.8481" y="57.4502"/><line style="stroke:#0A9EFD;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="67" x2="67" y1="57.4502" y2="601.4248"/></g><g><title>App</title><rect fill="#000000" fill-opacity="0.00000" height="543.9746" width="8" x="363.9014" y="57.4502"/><line style="stroke:#0A9EFD;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="367.4463" x2="367.4463" y1="57.4502" y2="601.4248"/></g><g><title>SDRTN&#174;</title><rect fill="#000000" fill-opacity="0.00000" height="543.9746" width="8" x="643.9585" y="57.4502"/><line style="stroke:#0A9EFD;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="647.6904" x2="647.6904" y1="57.4502" y2="601.4248"/></g><g class="participant participant-head" data-participant="SVR"><rect fill="none" height="30.0986" rx="2.5" ry="2.5" style="stroke:#0A9EFD;stroke-width:2;" width="95.6963" x="20" y="26.3516"/><text fill="#0A9EFD" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="81.6963" x="27" y="46.4834">Token server</text></g><g class="participant participant-tail" data-participant="SVR"><rect fill="none" height="30.0986" rx="2.5" ry="2.5" style="stroke:#0A9EFD;stroke-width:2;" width="95.6963" x="20" y="600.4248"/><text fill="#0A9EFD" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="81.6963" x="27" y="620.5566">Token server</text></g><g class="participant participant-head" data-participant="APP"><rect fill="none" height="30.0986" rx="2.5" ry="2.5" style="stroke:#0A9EFD;stroke-width:2;" width="38.9102" x="348.4463" y="26.3516"/><text fill="#0A9EFD" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="24.9102" x="355.4463" y="46.4834">App</text></g><g class="participant participant-tail" data-participant="APP"><rect fill="none" height="30.0986" rx="2.5" ry="2.5" style="stroke:#0A9EFD;stroke-width:2;" width="38.9102" x="348.4463" y="600.4248"/><text fill="#0A9EFD" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="24.9102" x="355.4463" y="620.5566">App</text></g><g class="participant participant-head" data-participant="API"><rect fill="none" height="30.0986" rx="2.5" ry="2.5" style="stroke:#0A9EFD;stroke-width:2;" width="72.5361" x="611.6904" y="26.3516"/><text fill="#0A9EFD" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="58.5361" x="618.6904" y="46.4834">SDRTN&#174;</text></g><g class="participant participant-tail" data-participant="API"><rect fill="none" height="30.0986" rx="2.5" ry="2.5" style="stroke:#0A9EFD;stroke-width:2;" width="72.5361" x="611.6904" y="600.4248"/><text fill="#0A9EFD" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="58.5361" x="618.6904" y="620.5566">SDRTN&#174;</text></g><path d="M10,74.4502 L250.1333,74.4502 L250.1333,81.3989 L240.1333,91.3989 L10,91.3989 L10,74.4502" fill="#EEEEEE" style="stroke:#0A9EFD;stroke-width:1.5;"/><rect fill="none" height="291.3848" style="stroke:#0A9EFD;stroke-width:2;" width="710.4438" x="10" y="74.4502"/><text fill="#000000" font-family="Arial" font-size="13" lengthAdjust="spacing" textLength="195.1333" x="25" y="87.644">Join a channel with authentication</text><g class="message" data-participant-1="APP" data-participant-2="SVR"><polygon fill="#0A9EFD" points="78.8481,123.2964,68.8481,127.2964,78.8481,131.2964,74.8481,127.2964" style="stroke:#0A9EFD;stroke-width:1;"/><line style="stroke:#0A9EFD;stroke-width:2;" x1="72.8481" x2="366.9014" y1="127.2964" y2="127.2964"/><text fill="#0A9EFD" font-family="Arial" font-size="13" lengthAdjust="spacing" textLength="218.2578" x="106.9399" y="107.5928">Request a token using channel name,</text><text fill="#0A9EFD" font-family="Arial" font-size="13" lengthAdjust="spacing" textLength="163.3125" x="138.0244" y="122.5415">role, token type, and user ID</text></g><g class="message" data-participant-1="SVR" data-participant-2="SVR"><line style="stroke:#0A9EFD;stroke-width:2;" x1="67.8481" x2="109.8481" y1="171.1938" y2="171.1938"/><line style="stroke:#0A9EFD;stroke-width:2;" x1="109.8481" x2="109.8481" y1="171.1938" y2="184.1938"/><line style="stroke:#0A9EFD;stroke-width:2;" x1="68.8481" x2="109.8481" y1="184.1938" y2="184.1938"/><polygon fill="#0A9EFD" points="78.8481,180.1938,68.8481,184.1938,78.8481,188.1938,74.8481,184.1938" style="stroke:#0A9EFD;stroke-width:1;"/><text fill="#0A9EFD" font-family="Arial" font-size="13" lengthAdjust="spacing" textLength="121.4116" x="74.8481" y="151.4902">Validate user against</text><text fill="#0A9EFD" font-family="Arial" font-size="13" lengthAdjust="spacing" textLength="91.0381" x="93.6467" y="166.439">internal security</text></g><g class="message" data-participant-1="SVR" data-participant-2="APP"><polygon fill="#0A9EFD" points="355.9014,209.1426,365.9014,213.1426,355.9014,217.1426,359.9014,213.1426" style="stroke:#0A9EFD;stroke-width:1;"/><line style="stroke:#0A9EFD;stroke-width:2;" x1="67.8481" x2="361.9014" y1="213.1426" y2="213.1426"/><text fill="#0A9EFD" font-family="Arial" font-size="13" lengthAdjust="spacing" textLength="243.5405" x="96.1045" y="208.3877">Generate a token and return it to the client</text></g><g class="message" data-participant-1="APP" data-participant-2="API"><polygon fill="#0A9EFD" points="635.9585,253.04,645.9585,257.04,635.9585,261.04,639.9585,257.04" style="stroke:#0A9EFD;stroke-width:1;"/><line style="stroke:#0A9EFD;stroke-width:2;" x1="367.9014" x2="641.9585" y1="257.04" y2="257.04"/><text fill="#0A9EFD" font-family="Arial" font-size="13" lengthAdjust="spacing" textLength="135.1416" x="438.5532" y="237.3364">Join a channel with uid,</text><text fill="#0A9EFD" font-family="Arial" font-size="13" lengthAdjust="spacing" textLength="145.9961" x="434.9319" y="252.2852">channel name, and token</text></g><g class="message" data-participant-1="API" data-participant-2="API"><line style="stroke:#0A9EFD;stroke-width:2;" x1="647.9585" x2="689.9585" y1="300.9375" y2="300.9375"/><line style="stroke:#0A9EFD;stroke-width:2;" x1="689.9585" x2="689.9585" y1="300.9375" y2="313.9375"/><line style="stroke:#0A9EFD;stroke-width:2;" x1="648.9585" x2="689.9585" y1="313.9375" y2="313.9375"/><polygon fill="#0A9EFD" points="658.9585,309.9375,648.9585,313.9375,658.9585,317.9375,654.9585,313.9375" style="stroke:#0A9EFD;stroke-width:1;"/><text fill="#0A9EFD" font-family="Arial" font-size="13" lengthAdjust="spacing" textLength="46.979" x="656.4058" y="281.2339">Validate</text><text fill="#0A9EFD" font-family="Arial" font-size="13" lengthAdjust="spacing" textLength="53.4854" x="654.9585" y="296.1826">the token</text></g><g class="message" data-participant-1="API" data-participant-2="APP"><polygon fill="#0A9EFD" points="378.9014,353.835,368.9014,357.835,378.9014,361.835,374.9014,357.835" style="stroke:#0A9EFD;stroke-width:1;"/><line style="stroke:#0A9EFD;stroke-width:2;" x1="372.9014" x2="646.9585" y1="357.835" y2="357.835"/><text fill="#0A9EFD" font-family="Arial" font-size="13" lengthAdjust="spacing" textLength="143.0635" x="434.5923" y="338.1313">Trigger the callback after</text><text fill="#0A9EFD" font-family="Arial" font-size="13" lengthAdjust="spacing" textLength="153.2261" x="431.3169" y="353.0801">adding user to the channel</text></g><path d="M10,379.835 L130.8799,379.835 L130.8799,386.7837 L120.8799,396.7837 L10,396.7837 L10,379.835" fill="#EEEEEE" style="stroke:#0A9EFD;stroke-width:1.5;"/><rect fill="none" height="204.5898" style="stroke:#0A9EFD;stroke-width:2;" width="684.2266" x="10" y="379.835"/><text fill="#000000" font-family="Arial" font-size="13" lengthAdjust="spacing" textLength="75.8799" x="25" y="393.0288">Renew token</text><g class="message" data-participant-1="API" data-participant-2="APP"><polygon fill="#0A9EFD" points="378.9014,413.7324,368.9014,417.7324,378.9014,421.7324,374.9014,417.7324" style="stroke:#0A9EFD;stroke-width:1;"/><line style="stroke:#0A9EFD;stroke-width:2;" x1="372.9014" x2="646.9585" y1="417.7324" y2="417.7324"/><text fill="#0A9EFD" font-family="Arial" font-size="13" lengthAdjust="spacing" textLength="235.5361" x="390.1619" y="412.9775">Trigger event: Token Privilege will Expire</text></g><g class="message" data-participant-1="APP" data-participant-2="SVR"><polygon fill="#0A9EFD" points="78.8481,457.6299,68.8481,461.6299,78.8481,465.6299,74.8481,461.6299" style="stroke:#0A9EFD;stroke-width:1;"/><line style="stroke:#0A9EFD;stroke-width:2;" x1="72.8481" x2="366.9014" y1="461.6299" y2="461.6299"/><text fill="#0A9EFD" font-family="Arial" font-size="13" lengthAdjust="spacing" textLength="250.7705" x="90.6836" y="441.9263">Request a fresh token using channel name,</text><text fill="#0A9EFD" font-family="Arial" font-size="13" lengthAdjust="spacing" textLength="163.3125" x="138.0244" y="456.875">role, token type, and user ID</text></g><g class="message" data-participant-1="SVR" data-participant-2="SVR"><line style="stroke:#0A9EFD;stroke-width:2;" x1="67.8481" x2="109.8481" y1="490.5786" y2="490.5786"/><line style="stroke:#0A9EFD;stroke-width:2;" x1="109.8481" x2="109.8481" y1="490.5786" y2="503.5786"/><line style="stroke:#0A9EFD;stroke-width:2;" x1="68.8481" x2="109.8481" y1="503.5786" y2="503.5786"/><polygon fill="#0A9EFD" points="78.8481,499.5786,68.8481,503.5786,78.8481,507.5786,74.8481,503.5786" style="stroke:#0A9EFD;stroke-width:1;"/><text fill="#0A9EFD" font-family="Arial" font-size="13" lengthAdjust="spacing" textLength="244.9814" x="74.8481" y="485.8237">Validate user request against internal logic</text></g><g class="message" data-participant-1="SVR" data-participant-2="APP"><polygon fill="#0A9EFD" points="355.9014,528.5273,365.9014,532.5273,355.9014,536.5273,359.9014,532.5273" style="stroke:#0A9EFD;stroke-width:1;"/><line style="stroke:#0A9EFD;stroke-width:2;" x1="67.8481" x2="361.9014" y1="532.5273" y2="532.5273"/><text fill="#0A9EFD" font-family="Arial" font-size="13" lengthAdjust="spacing" textLength="276.0532" x="79.8481" y="527.7725">Generate a fresh token and return it to the client</text></g><g class="message" data-participant-1="APP" data-participant-2="API"><polygon fill="#0A9EFD" points="635.9585,572.4248,645.9585,576.4248,635.9585,580.4248,639.9585,576.4248" style="stroke:#0A9EFD;stroke-width:1;"/><line style="stroke:#0A9EFD;stroke-width:2;" x1="367.9014" x2="641.9585" y1="576.4248" y2="576.4248"/><text fill="#0A9EFD" font-family="Arial" font-size="13" lengthAdjust="spacing" textLength="119.9707" x="446.1387" y="556.7212">Send the fresh token</text><text fill="#0A9EFD" font-family="Arial" font-size="13" lengthAdjust="spacing" textLength="161.1416" x="427.3591" y="571.6699">with a RenewToken request</text></g><!--SRC=[jL9BJiD03Dtd5APhu00LGge4GcM1ehPYLGcvYKcjJZt1cIdjfJW49yEJDE4ZG6pOJU9vFxyvOIbSB0cmyeeFpORbdEFMPTdAxs4qtTQEjYI1IbWTuE3ZAAjH0nTSemGOBVo611hI7Ua8i87v_UppZKbTjuD9dcSaHkFtH_9S_OxBZdcIvBzmpwzcYxlNboDw-ewkrCSQRZqB81Hh5247pnpMW36ipIqN6DXBPffmTfayZM56Jv6QO8ZGUeuDIpMW1RTq2ai1zSuEtPLmgEsC9Xij8KolCcCQ2E_HSOc1kY5Mo6BqHi6sBXLqjfOYAeT3w-FYh8FTa90cM6yayIk5g8OCzWyi0XIEBKSVmDAFlyqRkKokFwT8X2srmQS3VB2xb2JmvK8-XeLoLLcILXwTMs6n0NoqB0R1iaphQgFs5ZlHL4jVoSooFVz2JJiBPPzjxbnvnuugiYZEmVM-PgKVAdjKQjR_Kvps8iS2X_QShxZugRgFXlvQu3mzu3Jx25vAzt2xtNMRELfgD_i6]--></g></svg>