<PlatformWrapper platform="web">
import KnownIssues from '@docs/shared/video-sdk/reference/known-issues/web.mdx';

<Vpd k="NAME"/> 4.x is a JavaScript and TypeScript library loaded by an HTML web page. The SDK library uses APIs in the web browser to establish connections and control the communication, <Vg k="BS" /> and <Vg k="ILS" /> services.

### Compatibility

See [Supported platforms](../overview/supported-platforms).

### Known issues

<KnownIssues />

### v4.20.2

v4.20.2 was released on March 21, 2024.

#### Fixed issues

This release fixes the issue where the browser would modify the captured video resolution when calling <Link to="{{Global.API_REF_WEB_ROOT}}/interfaces/iagorartc.html#createcustomvideotrack">createCustomVideoTrack</Link> in certain scenarios.

### v4.20.1

v4.20.1 was released on February 28, 2024.

#### New features

This release adds the following new features:

**Send the SEI in the H.264 video streams**

    This release introduces the `LocalVideoTrack.sendSeiData` method and the `LocalVideoTrack.sei-received` event to add and send the Supplemental Enhancement Information (SEI) within the H.264 video streams. The SEI data package has a maximum size of 1KB and encompasses dynamic facial capture data, virtual video information, and digital watermarking. To enable this feature, please contact technical support.

        **Note:**

        - This functionality is only supported on Chrome 87 or later, as well as Safari 15.4 or later.
        - Due to the conflicts in certain browser core components, this feature is not available when [end-to-end media encryption (Beta)](https://docs-beta.agora.io/en/video-calling/develop/media-stream-encryption#implement-end-to-end-encryption) is enabled.

**Monitor the video states of receivers**

v4.20.1 introduces the `"video-state-changed"` event, which enables real-time monitoring of the video states of receivers, such as freezing and recovery, thereby facilitating prompt responses. For more information, see <Link to="{{Global.API_REF_WEB_ROOT}}/interfaces/iremotetrack.html#event_video_state_changed">API documentation</Link>.

**Data Stream Encryption**

To enhance the security of data stream transmission, this version introduces a new `encryptDataStream` parameter in the `setEncryptionConfig` method for enabling data stream encryption. For more details, see <Link to="{{Global.API_REF_WEB_ROOT}}/interfaces/iagorartcclient.html#setencryptionconfig">API documentation</Link>.

#### Improvements

This release adds the following improvements:

- Optimizes the audio reception experience on mobile devices, reducing issues such as electric noise or silence caused by browser defects in single audio stream scenarios.
- Enhances video bitrate settings by adding a default setting for the minimum video bitrate. If you don't specify a value for `bitrateMin` when calling `setEncoderConfiguration`, the SDK will automatically set an appropriate bitrate based on the resolution and frame rate settings. This default setting only applies to Chrome and Edge browsers.

#### Fixed issues

This release fixes the following issue:

- In a single channel with 128 concurrent online hosts, if a user left the channel during network reconnection, it could result in the failure to subscribe to other users' audio streams for the local user.

#### API changes

**Added**:

- `LocalVideoTrack.sei-received`
- `LocalVideoTrack.sendSeiData`
- `RemoteTrack.video-state-changed`
- `RemoteVideoTrack.on("video-state-changed")`
- `encryptDataStream` parameter to `AgoraRTCClient.setEncryptionConfig`

### v4.20.0

v4.20.0 was released on December 8, 2023.

#### Compatibility changes

Prior to v4.20.0, the `IRemoteAudioTrack.setPlaybackDevice` method could be invoked on Firefox, but an echo issue would occur due to a Firefox [bug](https://bugzilla.mozilla.org/show_bug.cgi?id=1849108). To improve the user experience, starting from v4.20.0, the SDK throws a `NOT_SUPPORTED` error when this method is called.

If you are using the `IRemoteAudioTrack.setPlaybackDevice` method, you need to make code modifications after upgrading to v4.20.0.

#### New features

On certain versions of iOS devices, the app call might not automatically resume after being interrupted by a WeChat call or system phone call. To address this issue, this release introduces the `"audio-context-state-changed"` event to monitor whether the app call has been interrupted, and the `resumeAudioContext` method to restore the app call.

<ProductWrapper notAllowed="voice-calling">
For usage details, refer to the [API documentation](https://api-ref.agora.io/en/video-sdk/web/4.x/interfaces/iagorartc.html#resumeaudiocontext).
</ProductWrapper>

<ProductWrapper product="voice-calling">
For usage details, refer to the [API documentation](https://api-ref.agora.io/en/voice-sdk/web/4.x/interfaces/iagorartc.html#resumeaudiocontext).
</ProductWrapper>

#### Improvements

This release includes the following improvements:

- Reduces the time it takes to join a channel when the user ID is a string.
- Supports audio sharing on the ChromeOS platform when sharing the entire screen or a Chrome tab.

#### API changes

**Added**

- `resumeAudioContext`
- `AgoraRTC.on("audio-context-state-changed")`


### v4.19.3

v4.19.3 was released on November 2, 2023.

#### Issues fixed

This release fixes a black screen issue when receiving H.264 encoded video streams on Safari prior to 16. Specifically, when a client using v4.19.2 SDK for Web made a video call on Safari prior to 16 to a client using the SDK for Android, iOS, Windows, or macOS, the web client displayed a black screen if the native client sent H.264 encoded video streams.

If you have integrated v4.19.2 of the SDK, Agora recommends upgrading to v4.19.3 as soon as possible.

### v4.19.2

v4.19.2 was released on October 20, 2023.

#### Improvements

**VP9 codec (GA)**

This release advances VP9 from Beta to General Availability (GA) and introduces the following enhancements:

- Updated browser compatibility: VP9 now supports Safari 16.0 and later versions on both desktop and mobile platforms.
- Automatic fallback to VP8 for older browsers: If any user in a channel uses a browser version below the [specified compatibility threshold](#vp9-codec), all VP9-encoded video streams in that channel will automatically transition to VP8.

Test results show that VP9 provides twice the quality of VP8 at equivalent bitrates.

**Dynamic resolution adjustment on Safari**

Safari has a known issue where it does not automatically reduce video encoding resolution under poor network conditions or reduced video frame rates, potentially leading to blurry video. To ensure user experience, this release adds the  `"720p_auto"` preset to the video encoder configurations. This preset guarantees automatic adjustment of the video encoding resolution on Safari.

After upgrading to this version, if you are using a 720p video profile, Agora recommends switching to the `"720p_auto"` preset and setting the encoding format to `"vp9"` for optimal results.

#### API changes

**Added**

- `"720p_auto"` to `VideoEncoderConfigurationPreset`

### v4.19.1

v4.19.1 was released on October 11, 2023.

#### Issues fixed

This release fixes the issue that an error occurred when using Webpack 4.x to bundle your app after integrating the SDK.

### v4.19.0

v4.19.0 was released on September 25, 2023.

<Admonition type="tip" title="Tip">After integrating this version of the SDK into your app, you might encounter an error if you use Webpack 4.x to bundle your app. To resolve this issue: <ul><li> If you intend to use Webpack 4.x, upgrade the SDK to v4.19.1.</li><li> If you prefer to continue using v4.19.0, Agora recommends bundling your app with Webpack 5.x or other tools such as Vite.</li></ul></Admonition>

#### Compatibility changes

**Dynamic low-quality video profile adjustment**

Before 4.19.0, you had to call `setLowStreamParameter` before `publish` to set the video profile for the low-quality video stream. This meant that changing the profile after publishing required republishing, impacting the viewing experience.

As of this release, you can call `setLowStreamParameter` after `publish` to dynamically adjust the resolution, bitrate, and frame rate of the low-quality video stream. Agora recommends modifying your `setLowStreamParameter` calls as needed after upgrading to this release. For example, in scenarios such as live streaming and video conferences, as the number of hosts in the channel increases, you can dynamically adjust the video profile of the low-quality video stream to relieve bandwidth pressure.

#### New features

**Tree shaking support**

As of this release, the SDK supports [tree shaking](https://webpack.js.org/guides/tree-shaking/), which removes unused code during the build process, reducing your app's size after integrating the SDK. To use this feature, see [App size optimization](../reference/downloads?platform=web).

**Dual display of video stream**

This release adds the `clone` method, allowing you to duplicate the current camera or screen sharing video track and customize display parameters. This can be useful in scenarios such as video conferencing and online education, where you want to display the same video stream with two sets of display parameters, including resolution, frame rate, and bitrate. For example, you can have one display set to high definition and the other to low definition.

**Switch between front and rear cameras**

To improve camera switching on mobile devices, this release adds the `facingMode` parameter to the `ICameraVideoTrack.setDevice` method. You can specify whether to use the front or rear camera on the mobile device.
<ProductWrapper notAllowed="voice-calling">
See <Link to="{{Global.API_REF_WEB_ROOT}}/interfaces/icameravideotrack.html#setdevice">`setDevice`</Link> for details.
</ProductWrapper>

<ProductWrapper product="voice-calling">
See <Link to="{{Global.API_REF_WEB_ROOT_VOICE_SDK}}/interfaces/icameravideotrack.html#setdevice">`setDevice`</Link> for details.
</ProductWrapper>

**Third-party video moderation**

As of this release, the SDK supports integration with third-party video moderation services.

<ProductWrapper notAllowed="voice-calling">
See `setImageModeration` in the <Link to="{{Global.API_REF_WEB_ROOT}}/index.html">API Reference</Link> for details.
</ProductWrapper>

<ProductWrapper product="voice-calling">
See `setImageModeration` in the <Link to="{{Global.API_REF_WEB_ROOT_VOICE_SDK}}/index.html">API Reference</Link> for details.
</ProductWrapper>

**Beta features**

End-to-end media encryption and Super Clarity extension are released in beta.
See [beta documentation](https://docs-beta.agora.io/en/video-calling/reference/release-notes) for details.

#### Improvements

**Optimized automatic mode**

In the automatic mode, the SDK initially attempts a direct connection to Agora SD-RTN™. If the attempt fails, the SDK automatically switches to TCP/TLS 443. To enhance the connection experience in restricted networks, this release optimizes the SDK's automatic mode, improving connection speed and stability. The optimized automatic mode no longer uses proxies, resulting in the deprecation of the `AgoraRTCClient.on("join-fallback-to-proxy")` callback.

**Other improvements**

This release also includes the following improvements:

- Reduces the time to first frame rendering. To enable this improvement, please [contact technical support](mailto:support@agora.io).
- Adds token expiration as a reason for a user leaving a channel in the `AgoraRTCClient.on("connection-state-change")` callback for easier troubleshooting.
- Adds `sendJitterMs` and `sendRttMs` to local audio track information, reporting jitter (ms) and round-trip time (ms) for sent audio packets.

#### Fixed issues

This release fixes the following issues:

- Under normal network conditions, the SDK occasionally misreported uplink network quality as `5` in the first few seconds after joining a channel.
- The local and remote audio and video packet loss rates reported by the SDK under the `currentPacketLossRate` attribute were inaccurate.
- On Windows devices using Chrome 115 browser, if the local user's screen sharing remained static without mouse movement, screen sharing stopped.
- During the procedure of subscribing to remote media streams, instances arose where the absence of audio was sporadically encountered by the local user when the remote user republished the audio stream. Likewise, when the remote user republished the video stream, occasional occurrences of a black screen were observed by the local user.
- Memory was not promptly released after calling `IBufferSourceAudioTrack.close`.

#### API changes

**Added**

- `ICameraVideoTrack.clone` and `ILocalVideoTrack.clone`

- `facingMode` to the `setDevice` method

- `TOKEN_EXPIRE` to the `ConnectionDisconnectedReason` enum

- `setImageModeration`

- `AgoraRTCClient.on("image-moderation-connection-state-change")`

- `ImageModerationConfiguration`

- `ImageModerationConnectionState`

- `sendJitterMs` and `sendRttMs` to the `LocalAudioTrackStats` interface

- `sendJitterMs` and `sendRttMs` to the  `LocalVideoTrackStats` interface

- `getRTCRtpTransceiver`

- `AgoraRTCClient.on("transceiver-updated")`

**Deprecated**

- `AgoraRTCClient.on("join-fallback-to-proxy")`

### v4.18.3

v4.18.3 was released on September 20, 2023.

#### Fixed issues

v4.18.3 fixes the following issue:

- The SDK failed to obtain audio and video statistics on Safari 17.

### v4.18.2

v4.18.2 was released on July 11, 2023.

#### Fixed issues

v4.18.2 fixes the following issues:

- In certain circumstances, Video SDK for Web triggered microphone and camera device permission prompts after it
  finished loading.

### v4.18.1

v4.18.1 was released on July 03, 2023.

#### Improvements

**Error handling support for event listeners**

As of this release, when an error occurs during the execution of the callback function assigned to the event listener (`listener`), the SDK does not interrupt normal operation. Instead, the SDK captures the exception and provide error information in the logs.

**Enhanced concurrency control for asynchronous methods**

This release optimizes concurrency control for asynchronous methods. When the following asynchronous methods are invoked concurrently, the SDK executes them in the order they were called, ensuring consistency:

- `join` and `leave`
- `publish` and `unpublish`
- `subscribe` and `unsubscribe`

Taking `publish` and `unpublish` as an example, if you call `unpublish` immediately after calling `publish`:

- In versions earlier than 4.18.1, `unpublish` might not take effect, which means the media track could remain published.
- As of version 4.18.1, the actual result is consistent with the order of these method calls, which means the media track is correctly unpublished.

#### Fixed issues

This release fixed the issue that the following callbacks were not triggered when an external camera or microphone was initially connected to a device without any available cameras or microphones:

- `onCameraChanged` or `AgoraRTC.on("camera-changed")`
- `onMicrophoneChanged` or `AgoraRTC.on("microphone-changed")`

### v4.18.0

v4.18.0 was released on June 12, 2023.

#### New features

**Variable playback speed for audio files**

To facilitate changing the playback speed of audio effect or music files, v4.18.0 modifies the `IBufferSourceAudioTrack` class as follows:

- Adds the `setAudioBufferPlaybackSpeed` method, which can be called before or after a user joins a channel.
- Adds the `playbackSpeed` property to retrieve the current playback speed.

**Custom signaling proxy**

v4.18.0 adds the `setProxyServer` method to allow customization of the signaling proxy server used by the SDK.

**Flexible event listening for AgoraRTC objects**

As of v4.18.0, the `IAgoraRTC` class inherits all methods from the `EventEmitter` class, providing a flexible way of listening to all events emitted by the `AgoraRTC` object.

Using `onCameraChanged` as an example:

```javascript
// Previous event listening (earlier than v4.18.0)
AgoraRTC.onCameraChanged = (info) => {
  console.log("camera changed!", info.state, info.device);
};
// New event listening (v4.18.0 and later)
AgoraRTC.on("camera-changed", (info) => {
  console.log("Camera changed!", info.state, info.device);
});
```

You can continue using the previous approach. However, for higher flexibility and extensibility, Agora recommends modifying the listening approach for the following events after upgrading the SDK:

- `onAutoplayFailed`
- `onCameraChanged`
- `onMicrophoneChanged`
- `onPlaybackDeviceChanged`
- `onSecurityPolicyViolation`
- `onAudioAutoplayFailed`: Deprecated, see `onAutoplayFailed` instead

Scalable Video Coding, access to encoded data, and enhanced connection experience in restricted networks are released in beta.
See [beta documentation](https://docs-beta.agora.io/en/video-calling/reference/release-notes) for details.

#### Improvements

**Shorter time to join channel**

As of v4.18.0, the SDK enables WebSocket message compression by default, reducing the time to join a channel in poor network conditions.

**Other improvements**

v4.18.0 also includes the following improvements:

- Improves the retry mechanism by adding a 3s retry rule to switch a downgraded video resolution to a higher one. This prevents the video resolution from remaining low when the network conditions improve, resulting in a better user experience.
- Upgrades the Cloud Proxy service to enhance its stability in different network environments.

#### API changes

**Added**

- `setProxyServer`
- `setAudioBufferPlaybackSpeed` method and `playbackSpeed` property to `IBufferSourceAudioTrack`
- The following methods inherited from the `EventEmitter` class to the `IAgoraRTC` class:
  - `on`
  - `off`
  - `once`
  - `getListeners`
  - `removeAllListeners`

<div class="alert info">These methods support the following event names as parameters:<ul><li>`"camera-changed"`</li><li>`"microphone-changed"`</li><li>`"playback-device-changed"`</li><li>`"autoplay-failed"`</li><li>`"security-policy-violation"`</li></ul></div>

#### Fixed issues

v4.18.0 fixes the following issues:

- Mobile devices experienced delays in receiving notifications for the [broadcaster leave channel event](../develop/receive-notifications?platform=web#104-broadcaster-leave-channel).
- Users experienced a black screen while watching video streams encoded with H.264 in older browser versions.
- Memory usage increased when using the SDK with the Virtual Background or Image Enhancer extension.
- The SDK continued to use the expired token during reconnection attempts after generating a new token using the `renewToken` method.

### v4.17.2

v4.17.2 was released on April 20, 2023.

#### Fixed issues

This release fixes the issue where the `getCurrentFrameData` method returned abnormal data.

### v4.17.1

v4.17.1 was released on April 19, 2023.

#### Compatibility changes

<div class="alert note">Chrome 107 prevents users from sharing the current tab by default. If you need to allow users to share the current tab on Chrome 107 and later versions, please upgrade your SDK to v4.17.1 or later as soon as possible.</div>

To accommodate changes related to screen sharing in Chrome 107 (refer to [Chrome documentation](https://developer.chrome.com/docs/web-platform/screen-sharing-controls/)), this release introduces the following changes to the `config` parameter in the `createScreenVideoTrack` method:

- Deprecates the `screenSourceType` property. If you are using this property, replace it with the newly added `displaySurface` property after upgrading to this version.
- Adds new properties: `selfBrowserSurface`, `surfaceSwitching`, and `systemAudio`.

<ProductWrapper notAllowed="voice-calling">
For detailed explanations of these properties, see [ScreenVideoTrackInitConfig](https://api-ref.agora.io/en/video-sdk/web/4.x/interfaces/screenvideotrackinitconfig.html) in the API reference.
</ProductWrapper>
<ProductWrapper product="voice-calling">
For detailed explanations of these properties, see [ScreenVideoTrackInitConfig](https://api-ref.agora.io/en/voice-sdk/web/4.x/interfaces/screenvideotrackinitconfig.html) in the API reference.
</ProductWrapper>

#### Improvements

**Improved flexibility in setting video profiles**

This release improves the flexibility in setting video profiles for different types of video tracks:

- You can now specify the resolution and the frame rate when calling `createCustomVideoTrack` to create a custom video track, by passing in values for the `width`, `height`, and `frameRate` parameters.
- After creating a screen track or a custom video track, you can dynamically adjust the video profile using `LocalVideoTrack.setEncoderConfiguration`. Please note that there is a known issue with calling this method on a screen track in certain versions of macOS Safari. [See issue details](known-issues).

For details, see more about [setting video profiles](../develop/ensure-channel-quality#video-profile-table).

**Other improvements**

This release also includes the following improvements:

- The time required to create tracks using `createMicrophoneAudioTrack` or `createMicrophoneAndCameraTracks` on Safari browsers is reduced.

- When you have two `AgoraRTCClient` objects created locally, you have the option to block certain callbacks from one `AgoraRTCClient` to another. These callbacks include those triggered when joining or leaving a channel, and publishing or unpublishing streams. For example, if you are using Client A for publishing a screen track and Client B for publishing a camera track, and you enable this feature to block callbacks, Client A and B will not receive the following callbacks from each other:

  - `AgoraRTCClient.on("user-published")`
  - `AgoraRTCClient.on("user-joined")`
  - `AgoraRTCClient.on("user-unpublished")`
  - `AgoraRTCClient.on("user-left")`
  - `AgoraRTCClient.on("published-user-list")`
  - `AgoraRTCClient.on("user-info-update")`

To enable this feature, contact technical support.

#### API changes

**Added**

- `displaySurface` (replacement for `screenSourceType`), `selfBrowserSurface`, `surfaceSwitching`, and `systemAudio` in the `ScreenVideoTrackInitConfig` interface
- `width`, `height`, and `frameRate` in the `createCustomVideoTrack` method
- `LocalVideoTrack.setEncoderConfiguration`

**Deleted**

- `ILocalVideoTrack.setBeautyEffect`


### v4.17.0

v4.17.0 was released on March 22, 2023.

#### New features

**Dynamic switching of local video streams**

This release adds the `ILocalVideoTrack.replaceTrack` method to increase the flexibility to switch local video tracks.

For example, to switch from one camera to another before v4.17.0, you needed to call `IAgoraRTCClient.unpublish` to
unpublish the current track and then call `IAgoraRTCClient.publish` to publish a new track.
As of v4.17.0, you can call `ILocalVideoTrack.replaceTrack` directly.

#### Improvements

**Optimized reconnection mechanism**

As of v4.17.0, the SDK defaults to showing the last video frame before disconnection during reconnection,
which prevents a black screen during the reconnection process. This optimization is not available on Safari due to Safari's limitations.

**Other improvements**

This release also includes the following improvements:

- The accuracy of SDK-related quality metrics on [Analytics](/agora-analytics/overview/product-overview) is improved.
- The time required to join a channel is reduced. This optimization is not available on Firefox due to Firefox's limitations.

#### API changes

**Added**

- `ILocalVideoTrack.replaceTrack`

**Deleted**

- `ILocalVideoTrack.setBeautyEffect`

#### Fixed issues

On Safari on iOS 14.7 and later, performing subscribing and unsubscribing operations repeatedly to multiple audio streams could result in not hearing remote users.


### v4.16.1

<Vpd k="PRODUCT" /> v4.16.1 was released on February 7, 2023.

#### Fixed issues

This release fixes the following issue:

- When using Video SDK for Web v4.16.0, the video freeze rate showed in Agora Analytics is much higher than the correct value.

### v4.16.0

<Vpd k="PRODUCT" /> v4.16.0 was released on January 5, 2023.

#### Improvements

This release adds the following enhancements:

**Compatibility for deprecated RTCMediaStreamTrackStats on Chrome**

Chrome plans to deprecate the stats dictionary `RTCMediaStreamTrackStats`.
See the service announcement on [discuss-webrtc@googlegrooups.com](https://groups.google.com/g/discuss-webrtc/c/9c8ZjberEcI).
This change affects the following media track statistics returned by the SDK:

|  Statistics             | Affected fields                                              |
| :---------------------- | :----------------------------------------------------------- |
| `LocalVideoTrackStats`  | <li>`sendFrameRate`</li><li>`sendResolutionHeight`</li><li>`sendResolutionWidth`</li> |
| `RemoteVideoTrackStats` | <li>`receiveFrameRate`</li><li>`receiveResolutionHeight`</li><li>`receiveResolutionWidth`</li><li>`renderFrameRate`</li><li>`receiveDelay`</li> |
| `RemoteAudioTrackStats` | <li>`receiveDelay`</li><li>`receiveLevel`</li>               |

To ensure the accuracy of these media track statistics on Chrome, please upgrade the SDK to v4.16.0 or later as soon as possible.

**Other improvements**

This version of the SDK also includes the following improvements:

- The cause of the  [`HTMLMediaElement` error event](https://developer.mozilla.org/en-US/docs/Web/API/HTMLMediaElement/error_event)
is now recorded in the log.
- The size of the SDK package is reduced.

#### Fixed issues

This release fixes the following issues:

- Media operations failed when the SDK was attempting to reconnect to the network.
- When relaying media streams across channels, [`ChannelMediaRelayConfiguration.addDestChannelInfo`](https://api-ref.agora.io/en/voice-sdk/web/4.x/interfaces/ichannelmediarelayconfiguration.html#adddestchannelinfo)
could not set `uid` to `0` to identify the relay stream in the destination channel.
- Some known issues on iOS 14.x.


### v4.15.1

v4.15.1 was released on December 2, 2022.

#### Fixed issues

This release fixes the following issue:

- No audio was received on iOS 13.7.

### v4.15.0

v4.15.0 was released on October 31, 2022.

#### New features

The latest features in this release are:

##### Audio stream filter (Beta)

v4.15.0 introduces filtering audio streams based on volume. Once this function is enabled, Agora SD-RTN™ ranks all subscribed audio streams by volume. By default, the three audio streams with the highest volume are transported to others in the channel. To change the number of audio streams to be transported, contact [support@agora.io](mailto:support@agora.io).

Agora enables channel hosts to control whether the audio streams being published are filtered based on volume. Streams that are not filtered bypass this filter mechanism and are transported directly to the receivers. In scenarios with a large number of publishers, enabling this function helps reduce the bandwidth and device system pressure for the receivers.

To enable this function, contact [support@agora.io](mailto:support@agora.io).

##### VP9 codec

Video SDK for Web v4.15.0 adds support for the VP9 codec in the following browsers:

|         | Supported browsers<sup>①</sup>                               |
| ------- | ------------------------------------------------------------ |
| Desktop | <li>Chrome 65 or later</li><li>Firefox 69 or later</li><li>Edge 79 or later</li> <li>Safari 16 or later</li>|
| Android | <li>Chrome 68 or later</li><li>Wechat v8.0.6 or later </li><li>Other apps that use WKWebView: WebView v65.0.3325.109 or later</li> |
| iOS     | Safari 16 or later |

<div class="alert info">① To ensure the best user experience, best practice is to use the latest version of the browsers listed above.</div>

To start a call using the VP9 codec, apps you connect to built using for Android, iOS, Windows, or macOS must use Video SDK v4.0.1 or greater.

##### CSP violation callback

v4.15.0 adds the `AgoraRTC.onSecurityPolicyViolation` callback. When Agora fails to load a resource or send a request due to Content Security Policy(CSP) violations, the Video SDK triggers this callback. When you receive this callback, modify your CSP configuration to ensure that you can access Agora-related services.

#### Improvements

The SDK has the following improvements:

- The accuracy of network quality reported by `AgoraRTCClient.on("network-quality")` in certain scenarios has increased.
- Resumption of audio or video streams when the user switches between Wi-Fi networks is faster.

#### API changes

**Added**

- `IAgoraRTC.onSecurityPolicyViolation`

#### Compatibility changes

Cloud Proxy default mode has changed. In Video SDK for Web v4.15.0, the `mode` parameter in `startProxyServer` defaults to `3`. This represents the Force UDP cloud proxy mode. In this mode, Video SDK always transmits data over UDP. For details, see [Restricted network connection with Cloud Proxy](/video-calling/develop/cloud-proxy).

### v4.14.2

v4.14.2 was released on October 27, 2022.

#### Fixed issues

This release fixes the following issue:

- When using WeChat browsers on iOS 14.x, no audio is received from the first channel the user subscribes to.

### v4.14.1

v4.14.1 was released on October 24, 2022.

#### Fixed issues

This release fixes the following issues:

- On Electron v17.x, screen sharing did not work properly. To solve this issue, add the following code in the main process:
  ```javascript
  const {  ipcMain, desktopCapturer } = require("electron");

  ipcMain.handle("DESKTOP_CAPTURER_GET_SOURCES", (event, opts) => desktopCapturer.getSources(opts));
  ```
- On desktop Safari, if autoplay was blocked for all videos, they kept trying to replay resulting in video freeze.
- On mobile browsers, the video freeze rate calculated by the SDK was higher than the actual value when the browser was running in the background.
- In Android WebView, the default poster (a gray play button) of the video element showed before video playback.
- Media stream relay failed after the SDK resumed connection to the network.
- During a media stream relay, the SDK continued to send heartbeats after the user left the source channel.


### v4.14.0

v4.14.0 was released on August 31, 2022. 

#### Compatibility changes

**getVolumeLevel accuracy improvement**

As of v4.14.0, the SDK calibrates the calculation of the volume returned in  `getVolumeLevel`. The volume range is still [0,1], where 1 represents the highest audio level. If your business scenario depends on the volume returned in `getVolumeLevel`  (for example, a speaker icon shows according to the volume), ensure that you check the returned volume after upgrading to v4.14.0.

#### Fixed issues

This release fixes the following issue:

- The received Opus stereo audio had no stereo effect.
- On versions earlier than Chrome 76, the `decodeFrameRate` returned by the `getRemoteVideoStats` method was 0.
- On WeChat browsers running on iOS 14.1 and 14.2, the first subscribed audio stream was silent.
- After calling `LocalVideoTrack.setBeautyEffect` to enable image enhancement, calling `LocalVideoTrack.unpipe` caused an error.
- On Windows Chrome 103 and later versions, enabling the dual-stream mode did not take effect in certain scenarios.

### v4.13.0

v4.13.0 was released on July 25, 2022.

#### New features

<ProductWrapper notAllowed="voice-calling">
**Adding support for media processing extensions**

As of v4.13.0, the SDK supports using media processing extensions on remote audio and video tracks (extension support for local audio and video tracks was added in [v4.10.0](#410)).

Currently, Agora provides the following extension for remote audio tracks:

| Extension | Description| Documentation|
| :---------------------------------- | :----------------------------------------------------------- | :----------------------------------------------------------- |
| Spatial Audio Extension (Beta) | Enables a real-time audio blurring or air absorption effect for a user's audio based on the user's position relative to other users, which makes conversations more immersive. | Contact [support@agora.io](mailto:support@agora.io) for full details. |

</ProductWrapper>
#### Improvements

**AI Noise Suppression and virtual background**

The AI Noise Suppression extension and virtual background extension are converted from beta release to official release. To experience the AI Noise Suppression or virtual background extension, contact [support@agora.io](mailto:support@agora.io).

**Callback for token expiration**

v4.13.0 improved the logic of triggering the callback for token expiration. If a token expires when the user's device is in sleep mode or disconnected from network, the SDK triggers the `token-privilege-did-expire` event when the device resumes operation and attempts to reconnect to the SDK.

#### API changes

**Added**

- `RemoteAudioTrack.pipe`
- `RemoteAudioTrack.unpipe`
<ProductWrapper notAllowed="voice-calling">
- `RemoteVideoTrack.pipe`
- `RemoteVideoTrack.unpipe`
</ProductWrapper>
### v4.12.2
v4.12.2 was released on July 7, 2022. This release improved the automatic mode for SDK connectivity (In this mode, the SDK first attempts a direct connection to Agora SD-RTN™; if the attempt fails, the SDK automatically switches to TCP/TLS 443).

### v4.12.1
v4.12.1 was released on June 27, 2022. This release fixed the following issues:

- Subscribing to remote streams occasionally failed after disconnection.
<ProductWrapper notAllowed="voice-calling">
- On Firefox, performing subscribing and unsubscribing operations repeatedly to multiple video streams occasionally caused video freezing.
</ProductWrapper>

### v4.12.0
v4.12.0 was released on June 15, 2022.

#### Improvements

**Media processing extensions**

Media processing extensions have the following changes:

- The [Image Enhancement Extension (Beta)](https://www.npmjs.com/package/agora-extension-beauty-effect) is released. This extension incorporates and upgrades the built-in image enhancement feature (enabled by  <Link to="{{global.API_REF_WEB_ROOT}}/interfaces/ilocalvideotrack.html#setbeautyeffect">setBeautyEffect</Link>)) of the Agora Web SDK 4.x. You can adjust parameters including the contrast, brightness, and smoothness levels, in order to touch up the image for effects such as skin lightening and skin smoothing. For details, see [Use the Image Enhancement Extension](./beauty_effect_web_ng).
<ProductWrapper notAllowed="voice-calling">
- The [Virtual Background Extension (Beta)](https://www.npmjs.com/package/agora-extension-virtual-background) supports animated virtual backgrounds as of v1.0.0-beta-3. You can set a user's background as a short video. For details, see [Use the Virtual Background Extension](./virtual_background_web_ng).
</ProductWrapper>
#### Fixed issues

v4.12.0 fixed the issue that when dual-stream mode was enabled on Safari, calling methods such as `Track.setEnabled(false)` and `Track.close()` could not turn off the camera indicator light.

### v4.11.1
v4.11.1 was released on May 9, 2022. This release fixed the following issues:

- Subscribing to audio streams might cause no sound on Firefox.
- Compatibility issues occurred in Safari on iOS 12 and in the WeChat built-in browser on iOS 13.

### v4.11.0

v4.11.0 was released on April 1, 2022.

#### Compatibility changes

As of v4.11.0, the SDK adopts an automatic mode by default to ensure connectivity. In this mode, the SDK first attempts a direct connection to Agora SD-RTN™; if the attempt fails, the SDK automatically switches to TCP/TLS 443. You can listen for such auto-switch events through `client.on("join-fallback-to-proxy")`.

#### Improvements

**Channel capacity improvement**

As of v4.11.0, a single channel can support up to 128 concurrent online hosts, who can publish media streams at the same time. The number of audience members in a channel is unlimited. Each host or audience member can subscribe to a maximum of 50 hosts at the same time.

To experience this improvement, contact support@agora.io.

####  Fixed issues

v4.11.0 fixed the following issues:

-   Angular’s dependency zone.js caused an error when `Promise.finally` was called in the SDK.

-   On Chrome, AEC could not be enabled when sending stereo sound.

-   On Chrome 100, the SDK reported inaccurate statistics for the decoding frame rate and sending frame rate.

-   When dual-stream mode was enabled, calling `unpublish` without parameters caused the method call to fail.

### v4.10.2

v4.10.2 was released on March 24, 2022. This release fixed the issue that calling `join` in certain scenarios might cause proxy exceptions.

### v4.10.1

v4.10.1 was released on March 17, 2022 and added the dependency of TypeScript type definitions for Agora Extension `agora-rte-extension` in `package.json`. If you use TypeScript for type checking, Agora suggests that you update TypeScript to v4.3.2 or later.

### v4.10.0

v4.10.0 was released on March 11, 2022.

#### New features

<ProductWrapper notAllowed="voice-calling">

**Adding support for media processing extensions**

v4.10.0 supports using media processing extensions in the <Vpd k="NAME"/>. The following extensions are currently free to use during the beta period. For guidance on how to integrate and use the extensions, refer to the documentation listed in the following table:


| Extension                           | Description                                                                                                       | Documentation                                                                    |
|-------------------------------------|-------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------|
| Virtual Background Extension (Beta) | Enables users to replace their actual background with a solid color or custom image, or to blur their background. | [Use the Virtual Background Extension (Beta)](../develop/virtual-background) |
| AI Noise Suppression Extension (Beta)        | Reduces many types of sudden noise and reduces vocal distortion when multiple people speak at the same time.      | [AI Noise Suppression](../develop/ai-noise-suppression) |

</ProductWrapper>

#### API changes

**Added**

-   `AgoraRTC.registerExtensions`

-   `LocalTrack.pipe`

-   `LocalTrack.unpipe`

-   `LocalTrack.processorDestination`


### v4.9.4

v4.9.4 was released on March 16, 2022 and fixed the failure to access localStorage when loading the SDK in an iFrame in Chrome Incognito mode.

### v4.9.3

v4.9.3 was released on March 3, 2022. This release fixed several internal issues.

### v4.9.1

v4.9.1 was released on February 24, 2022. This release fixed several internal issues.

### v4.9.0

v4.9.0 was released on February 17, 2022.

#### New features
<ProductWrapper notAllowed="voice-calling">
**Setting the video stream type of all remote users**

v4.9.0 adds the `setRemoteDefaultVideoStreamType` method. After you call `enableDualStream` to enable dual-stream mode on the senders' clients, `setRemoteDefaultVideoStreamType` enables receivers to choose whether to receive the high-quality or low-quality stream of all remote users.
</ProductWrapper>
**Cloud Proxy Force TCP mode**

v4.9.0 adds Force TCP mode for the Agora Cloud Proxy service. In this mode, the SDK always transmits data over TLS 443. To use this mode, set `mode` as 5 when calling `startProxyServer`.

<ProductWrapper notAllowed="voice-calling">
**Checking the visibility of the `<video>` HTML tag**

After you call `play`, the SDK creates an `<video>` HTML tag for playing video tracks. v4.8.0 adds the following methods and events for checking the visibility of the `<video>` tag:

- `localVideoTrack.on("video-element-visible-status")`
- `remoteVideoTrack.on("video-element-visible-status")`
- `localVideoTrack.getVideoElementVisibleStatus`
- `remoteVideoTrack.getVideoElementVisibleStatus`

When `localTrack.isPlaying` or `remoteTrack.isPlaying` is `true` but you cannot see any video, the above methods or events can help you check whether the `<video>` tag is visible or not and learn the reason when the `<video>` tag is invisible.
</ProductWrapper>

#### Improvements

-   Improves the accuracy of the `client.on("is-using-cloud-proxy")` event.
<ProductWrapper notAllowed="voice-calling">
-   If you set the video resolution but do not set the bitrate, the SDK now can automatically calculate and set a reasonable bitrate according to the resolution and frame rate. This improvement helps to avoid bandwidth overload due to a high bitrate.
</ProductWrapper>
#### Issues fixed

v4.9.0 fixed the following issues:
<ProductWrapper notAllowed="voice-calling">
-   When you call `play` to play a local video track and pass in a DOM element from another window, the SDK reported an error.
</ProductWrapper>
-   When using v4.8.0 together with Angular and zone.js, users might fail to join a channel because zone.js modified the promise object.

-   Several known issues on iOS.

#### API changes

**Added**
<ProductWrapper notAllowed="voice-calling">
-   `setRemoteDefaultVideoStreamType`
-   `localVideoTrack.on("video-element-visible-status")`
-   `remoteVideoTrack.on("video-element-visible-status")`
-   `localVideoTrack.getVideoElementVisibleStatus`
-   `remoteVideoTrack.getVideoElementVisibleStatus`
</ProductWrapper>
-   `client.on("join-fallback-to-proxy")`

### v4.8.2
<ProductWrapper notAllowed="voice-calling">
v4.8.2 was released on January 27, 2022. This release fixed the issue that on iOS WeChat, the video playback might go black after being interrupted by a screen lock.
</ProductWrapper>
### v4.8.1

v4.8.1 was released on January 6, 2022. This release fixed an internal issue.

### v4.8.0

v4.8.0 was released on December 29, 2021.

#### New features
<ProductWrapper notAllowed="voice-calling">
**Checking the visibility of the &lt;video&gt; HTML tag**

After you call `play`, the SDK creates an `<video>` HTML tag for playing video tracks. v4.8.0 adds the following methods and events for checking the visibility of the `<video>` tag:

-   `localVideoTrack.on("video-element-visible-status")`

-   `remoteVideoTrack.on("video-element-visible-status")`

-   `localVideoTrack.getVideoElementVisibleStatus`

-   `remoteVideoTrack.getVideoElementVisibleStatus`

When `localTrack.isPlaying` or `remoteTrack.isPlaying` is `true` but you cannot see any video, the above methods or events can help you check whether the `<video>` tag is visible or not and learn the reason when the `<video>` tag is invisible.
</ProductWrapper>
#### Improvements

v4.8.0 made some internal improvements.

#### Issues fixed

v4.8.0 fixed the following issues:

-   When receiving streams on iOS Safari as an audience member, the host’s voice could be heard, but the volume returned by the `client.on("volume-indicator")` event was 0.

-   When sending streams on iOS Safari, if you first call `setDevice` and then `setEncoderConfiguration`, the SDK returns an error.

#### API changes
<ProductWrapper notAllowed="voice-calling">
**Added**

-   `localVideoTrack.on("video-element-visible-status")`

-   `remoteVideoTrack.on("video-element-visible-status")`

-   `localVideoTrack.getVideoElementVisibleStatus`

-   `remoteVideoTrack.getVideoElementVisibleStatus`
</ProductWrapper>

### v4.7.3

v4.7.3 was released on November 17, 2021. This release avoided the issue that on the Safari browser in iOS 15.1, after a call was interrupted, the <Vpd k="NAME"/> failed to resume playing the remote media.

### v4.7.2

v4.7.2 was released on October 14, 2021, with the following changes:
<ProductWrapper notAllowed="voice-calling">
-   Avoided the [issue](https://bugs.webkit.org/show_bug.cgi?id=230537) that on the Safari browser in iOS 15, after a call was interrupted by a phone call, the <Vpd k="NAME"/> might fail to resume sending the local media and playing the remote media.

-   Avoided the [black screen issue](https://bugs.webkit.org/show_bug.cgi?id=230532) that might occur when using `videoTrack.play(element, {mirror: true})` to play the video on the desktop or mobile Safari 15 browser.
</ProductWrapper>
-   Fixed the issue that calling `AgoraRTC.checkSystemRequirements()` on the Edge browser only returned `false`.

### v4.7.1

v4.7.1 was released on September 13, 2021. This release fixed some issues on Safari 11 and iPad Chrome.

### v4.7.0

v4.7.0 was released on September 1, 2021.

#### Compatibility changes

As of v4.7.0, if you enable media stream encryption, the SDK automatically disables encryption and resets the encryption configurations after a user leaves the channel. To re-enable the encryption, call `setEncryptionConfig` before the user joins the channel again.

#### Improvements

This release makes the following improvements:

-   Optimizes the end-user experience of the <Vpd k="NAME"/> on the mobile browser.

-   Improves the accuracy of the volume obtained by `getVolumeLevel`.

-   Adds the support of enabling dual-stream mode on Safari.

#### Issues fixed

This release fixed the following issues:

-   After calling `LocalAudioTrack.setVolume` to adjust the local volume, the local user could not perceive the volume change.

-   When the log level was set to none, the SDK nevertheless output the initialization logs.

-   The promise returned by `LocalAudioTrack.setDevice` could get stuck in a pending state.

### v4.6.3

v4.6.3 was released on August 10, 2021. This release fixed an occasional issue: After the user closes a tab or browser on the local client, the remote client does not receive the `user-left` event immediately.

### v4.6.2

v4.6.2 was released on July 30, 2021. This release fixed the issue that the SDK did not destroy all the media players created during a call or live streaming. Chrome 92 introduced a limit on the number of media players that can be created in a particular tab: 75 for the desktop. After you play tracks several times, the undestroyed media players in the SDK might cause the playback failure in the tab.

### v4.6.1

v4.6.1 was released on July 21, 2021. This release fixed an internal error.

### v4.6.0

v4.6.0 was released on July 16, 2021.

#### New features

**Interactive Live Streaming Standard**

As of v4.6.0, the <Vpd k="NAME"/> supports Interactive Live Streaming Standard. The major difference between Agora Interactive Live Streaming Standard and Agora Live Interactive Streaming Premium is the latency level on the audience’s client:

-   Interactive Live Streaming Premium: Ultra-low latency (400 ms to 800 ms) from the host’s client to an audience member’s client.

-   Interactive Live Streaming Standard: Low latency (1500 ms to 2000 ms) from the host’s client to an audience member’s client.

The charges for Standard and Premium are different. For details, see the [product overview](./product-overview) and [pricing](./pricing) of Interactive Live Streaming Standard.

You can set the latency level of the audience role in the following two ways:

-   When calling `createClient` to create a client object, set the `role` parameter as `"audience"` and the `level` parameter in `clientRoleOptions` as `1`.

-   When calling the `setClientRole` method, set the `role` parameter as `"audience"` and the level parameter in `clientRoleOptions` as `1`.

**The mute states of local tracks**

v4.6.0 adds the `localTrack.setMuted` method to stop sending the media data of local tracks. The differences between this method and `localTrack.setEnabled` are as follows:
<ProductWrapper notAllowed="voice-calling">
-   After the method call of `localVideoTrack.setEnabled(false)` to stop sending video, the SDK also immediately turns off the camera light and stops video capture, while `localVideoTrack.setMuted` does not stop video capture.
</ProductWrapper>
-   Calling `setEnabled(true)` takes longer to resume sending the media data than by than calling `setMuted(false)`.

#### Improvements

**Dealing with autoplay blocking**
<ProductWrapper notAllowed="voice-calling">
To deal with the autoplay blocking of video on iOS, v4.6.0 deprecates the `onAudioAutoplayFailed` callback, and adds the `onAutoplayFailed` callback instead to indicate an audio or video autoplay failure.
</ProductWrapper>
On most web browsers, inaudible media are not affected by autoplay blocking. However, on iOS Safari with low power mode enabled, or on other iOS in-app browsers that implement a custom autoplay policy, such as the WeChat browser, the autoplay of inaudible media is blocked.

#### Issues fixed

v4.6.0 fixes the following issues:

-   The method call of `localAudioTrack.setVolume` did not take effect immediately.

-   Using multiple clients on one web page caused unexpected issues.

-   The SDK did not check whether the App ID was a string of 1 to 256 bytes in size.

#### API changes

**Added**

-   `localTrack.setMuted`

-   `onAutoplayFailed`

-   `clientRoleOptions` in `ClientConfig`

-   `options` in the `setClientRole` method

**Deprecated**

-   `onAudioAutoplayFailed`

### v4.5.0

v4.5.0 was released on May 25, 2021.

#### New features

**AEC (Acoustic Echo Canceller) for the audio played on the local client**

In a scenario where multiple users play a media file at the same time, such as watching a movie together, if the user A plays the media file through [HTMLMediaElement](https://developer.mozilla.org/en-US/docs/Web/API/HTMLMediaElement) on Chrome with a speaker, the SDK captures the audio played by a speaker together with the voice of the user A. The other users can hear the audio sent by the user A and the audio played locally, which sounds like an echo. To deal with this echo issue, v4.5.0 adds the `processExternalMediaAEC` method. You can call `processExternalMediaAEC` and pass in the `HTMLMediaElement` to enable the AEC for the audio played on the local client.

#### Improvements

**Channel encryption**

To strengthen the security of the key, v4.5.0 adds two encryption modes, `"aes-128-gcm2"` and `"aes-256-gcm2"`, which use the PBKDF2 (Password-Based Key Derivation Function 2). When calling `setEncryptionConfig` and setting the encryption mode as `"aes-128-gcm2"` or `"aes-256-gcm2"`, you need to set `secret` and `salt`. For how to generate and set `secret` and `salt`, see [Media Stream Encryption](/video-calling/develop/media-stream-encryption).

**Network geofencing**

As of v4.5.0, when calling setArea to specify the region for connection, you can use the `areaCode` parameter to specify a large region and use the `excludedArea` parameter to specify a small region. The region for connection is the large region excluding the small region. You can only specify the large region as `"GLOBAL"`. For details, see [Network Geofencing](../../video-calling/advanced/geofencing).

<ProductWrapper notAllowed="voice-calling">
**The preset video encoder configurations for screen sharing**

v4.5.0 adds the following preset video encoder configurations for screen sharing in ScreenEncoderConfigurationPreset:

-   `"480p_3"`: The resolution is 640 × 480 and the frame rate is 15 fps.

-   `"720p_3"`: The resolution is 1280 × 720 and the frame rate is 15 fps.

-   `"1080p_3`": The resolution is 1920 × 1080 and the frame rate is 15 fps.
</ProductWrapper>
#### Issues fixed

v4.5.0 fixes the following issues:

-   The `OptimizationMode` setting did not take effect.

-   On iOS, when the <Vpd k="NAME"/> captures media, noises might occur on the local client.
<ProductWrapper notAllowed="voice-calling">
-   On Firefox, after the stream transmitted by the SDK switched from high quality to low quality, the video resolution obtained by the `getRemoteVideoStats` method was still the resolution of the high-quality stream.
</ProductWrapper>
-   On Chrome, after you called `remoteAudioTrack.setVolume` to adjust the volume, if the playback was paused and then resumed, the volume changed back to the original one.

-   On Chrome, the `LocalAudioTrack.setVolume` method did not take effect.

#### API changes

**Added**

-   `processExternalMediaAEC`

-   `clientRoleOptions` in `ClientConfig`

-   `options` in the `setClientRole` method

-   `salt` in the `setEncryptionConfig` method

-   `"aes-128-gcm"` and `"aes-256-gcm"` in `EncryptionMode`

-   `excludedArea` in the `setArea` method

### v4.4.0

v4.4.0 was released on April 2, 2021.

#### Compatibility changes

**Firewall domain whitelist**

As of v4.4.0, the destination domains required for your firewall whitelist changes to:

    .agora.io
    .edge.agora.io
    .sd-rtn.com
    .edge.sd-rtn.com

If you upgrade the SDK to v4.4.0, update your firewall domain whitelist to ensure you can use Agora products in environments with restricted network access.

#### Improvements

**AES-GCM encryption mode**

In scenarios requiring high security, to ensure the confidentiality, integrity and authenticity of data, and to improve the computational efficiency of data encryption, v4.4.0 adds the following encryption modes in `EncryptionMode`:

-   `"aes-128-xts"`: 128-bit AES encryption, GCM mode.

-   `"aes-256-gcm"`: 256-bit AES encryption, GCM mode.

Once you enable the built-in encryption, all users in the same channel must use the same encryption mode and key, including the server-side users, such as the Agora recording service.

**Cloud proxy**
<ProductWrapper notAllowed="voice-calling">
v4.4.0 adds the `client.on("is-using-cloud-proxy")` event. The SDK triggers this event after the local client successfully publishes a media stream to indicate whether the media stream is forwarded by the [Cloud proxy service](../develop/cloud-proxy).
</ProductWrapper>
**Error code**

If you start media capturing after disabling the media capture device on Windows, the error thrown by the SDK changes from `UNEXPECTED_ERROR` to `NOT_READABLE`.

#### Issues fixed

v4.4.0 fixes the following issues:

-   The SDK did not trigger the `"first-frame-decoded"` event for a remote audio track.

-   The return value of `AgoraRTC.checkSystemRequirement` was inaccurate.

-   When the network had multiple IP addresses, the cloud proxy service did not take effect.

#### API changes

**Added**

-   `client.on("is-using-cloud-proxy")`

-   `"aes-128-gcm"` and `"aes-256-gcm"` in `EncryptionMode`

### v4.3.0

v4.3.0 was released on January 26, 2021.

#### New features

**Cloud proxy**

This release optimizes the Agora cloud proxy architecture and enhances the connectivity of the <Vpd k="NAME"/> in environments with restricted network access. The optimized Agora cloud proxy service also supports regional connection.

You can contact (mailto:support@agora.io) to apply for using the optimized Agora cloud proxy service and set the `mode` parameter as `3` when calling `startProxyServer`. For details, see [Cloud proxy service](../develop/cloud-proxy).

### v4.2.1

v4.2.1 was released on December 23, 2020. This release fixed the incorrect error that the SDK throws when you pass an illegal parameter in the client.publish method.

### v4.2.0

v4.2.0 was released on December 1, 2020.

#### New features

**Regional connection**

This release adds the `AgoraRTC.setArea` method for specifying the region for connection. After specifying the region, the SDK connects to the Agora servers within that region. The following regions are supported:

-   China

-   North America

-   Europe

-   Asia, excluding Mainland China

-   Japan

-   India

-   Global

This advanced feature applies to scenarios that have regional restrictions.
<ProductWrapper notAllowed="voice-calling">
**Video transmission optimization strategy**

This release adds the `localVideoTrack.setOptimizationMode` method for setting the video transmission optimization mode:

-   `"balanced"`: Uses the default transmission optimization strategy.

-   `"detail"`: Prioritizes clarity.

-   `"motion"`: Prioritizes smoothness.

See the API reference for the introduction to each transmission optimization mode. This method applies to scenarios where you need to dynamically adjust the optimization mode during a video call, live streaming, or screen sharing. For example, during the screen sharing, before you change the shared content from slides to a video, you can change the optimization mode from `"detail"` to `"motion"` to ensure smoothness in poor network conditions.
</ProductWrapper>
**Network quality of remote users**

This release adds the `AgoraRTCClient.getRemoteNetworkQuality` method for getting the uplink and downlink network quality of all the remote users to whom the local user subscribes.

**Cloud proxy**

This release changes the `mode` parameter of the `AgoraRTCClient.startProxyServer` method from `boolean` to `number`.

#### Improvements
<ProductWrapper notAllowed="voice-calling">
-   After disabling an audio or video tracks by calling `setEnabled`, you can still call `setDevice` to switch devices.
</ProductWrapper>
-   After you call `AgoraRTCClient.setEncryptionConfig` to enable the built-in encryption, when the user uses a weak secret, the SDK outputs a warning message to the Web Console and prompts the user to use a strong secret. A strong secret must contain at least eight characters and be a combination of uppercase and lowercase letters, numbers, and special characters.

#### Fixed issues
<ProductWrapper notAllowed="voice-calling">
-   When you disabled a local video track, you could not publish another video track.

-   After enabling dual-stream mode, if you called `setEnabled(false)` to disable a video track during the process of publishing, the publishing failed and could not be recovered.
</ProductWrapper>
-   After an audience member tried to publish a local track in live mode but failed, the audience member could not publish this track even after switching the role to host.

-   After dual-stream mode was enabled, a bug during the disconnection would occasionally cause publishing to fail after reconnection.
<ProductWrapper notAllowed="voice-calling">
-   After unpublishing a local camera video track and then publishing a screen-sharing track, the video bitrate was fixed at around 700 Kbps, and the resolution and frame rate dropped.
</ProductWrapper>
-   Due to Safari’s limited support for WebAudio, the audio of `BufferSourceAudioTrack` could be distorted.

-   When the SDK gained device permission for the first time, it did not trigger the media device change events (`onMicrophoneChanged`, `onCameraChanged`, or `onPlaybackDeviceChanged`). The SDK only triggered these events for a subsequent device change.

#### API changes

**Added**

-   `AgoraRTC.setArea`
<ProductWrapper notAllowed="voice-calling">
-   `localVideoTrack.setOptimizationMode`
</ProductWrapper>
-   `AgoraRTCClient.getRemoteNetworkQuality`

**Changed**

-   Changed the type of the `mode` parameter in `AgoraRTCClient.startProxyServer` from `boolean` to `number`

### v4.1.1

v4.1.1 was released on October 27, 2020. This release fixed the following issues:

-   Improved the accuracy of the `event_network_quality` event.
<ProductWrapper notAllowed="voice-calling">
-   The method call of `createCameraVideoTrack` did not stop on Safari when the SDK cannot find a video capture device.
</ProductWrapper>
-   After calling `unsubscribe` to unsubscribing from an unpublished track of a remote user, the subsequent subscribing and unsubscribing operations failed to take effect.
<ProductWrapper notAllowed="voice-calling">
-   Reduced the performance degradation due to frequent method calls of `setEnabled` to enable and disable a video track in dual-stream mode.

-   Occasional errors when `client.getLocalVideoStats` was called on Safari.
</ProductWrapper>
### v4.1.0

v4.1.0 was released on September 4, 2020.

#### New features
<ProductWrapper notAllowed="voice-calling">
**Screenshot capture**

v4.1.0 adds the `getCurrentFrameData` method which gets the data of the video frame being rendered.
</ProductWrapper>
**Audio playback device management**

v4.1.0 adds the following APIs to manage audio playback devices:

-   `setPlaybackDevice`: Sets the audio playback device, for example, the speaker. This method supports Chrome only.

-   `getPlaybackDevices`: Retrieves the audio playback devices available.

-   `onPlaybackDeviceChanged`: Occurs when an audio playback device is added or removed.

#### Improvements

-   Fully supports Chromium-based versions of Microsoft Edge (versions 80 and later).

-   Improves the accuracy of the `network-quality` event.

-   Supports sharing audio when sharing Chrome tabs on macOS.

#### Fixed issues
<ProductWrapper notAllowed="voice-calling">
-   Information retrieved by `checkVideoTrackIsActive` on Safari is inaccurate.
</ProductWrapper>
-   Occasional failure of reconnection after enabling dual-stream mode.

-   Occasional failure to call `setEnabled` after leaving the channel.

-   Failure to push streams to CDN with transcoding and without transcoding at the same time.

-   Occasional failure to automatically re-subscribe to the remote streams after disconnection, indicated by the `UNEXPECTED_RESPONSE: ERR_SUBSCRIBE_REQUEST_INVALID` error.

-   Failure to join different channels with the same UID in one browser tab.

-   Occasional misreport on connection states due to frequent channel join and leave.

#### API changes

**Added**
<ProductWrapper notAllowed="voice-calling">
-   `LocalVideoTrack.getCurrentFrameData`

-   `RemoteVideoTrack.getCurrentFrameData`
</ProductWrapper>
-   `AgoraRTC.getPlaybackDevices`

-   `LocalAudioTrack.setPlaybackDevice`

-   `RemoteAudioTrack.setPlaybackDevice`

-   `AgoraRTC.onPlaybackDeviceChanged`

-   `Client.getLocalAudioStats`

-   `Client.getRemoteAudioStats`
<ProductWrapper notAllowed="voice-calling">
-   `Client.getLocalVideoStats`

-   `Client.getRemoteVideoStats`
</ProductWrapper>
**Deprecated**
<ProductWrapper notAllowed="voice-calling">
-   The `LocalTrack.getStats` and `RemoteTrack.getStats` methods. Use the `Client.getLocalAudioStats`, `Client.getRemoteAudioStats`, `Client.getLocalVideoStats` and `Client.getRemoteVideoStats` methods instead.
</ProductWrapper>
### v4.0.1

v4.0.1 was released on July 18, 2020. This release fixed the following issues:
- Failure to publish local tracks on Chrome 70.
- Publish operation may not be aborted when leaving the channel.

### v4.0.0

v4.0.0 was released on July 15, 2020.

#### Compatibility changes

v4.0.0 deletes the `LocalTrack.setMute` method and adds the `LocalTrack.setEnabled` method for enabling or disabling a local track. The advantages of this change are as follows:

-   Eliminates the concept of "mute" to avoid confusion between mute states and publishing states.

-   In versions earlier than v4.0.0, the SDK triggers the `Client.on("user-mute-updated")` callback when the remote user calls `setMute` to change the mute state.

-   As of v4.0.0, the SDK triggers the existing `Client.on("user-unpublished")` or `Client.on("user-published")` callbacks when the remote user calls `setEnabled` to enable or disable a track.
<ProductWrapper notAllowed="voice-calling">
-   After you call `setMute(true)`, the SDK sends black video frames or silenced audio frames. If you mute a local video track, the camera light stays on, which might adversely impact the user experience. In contrast, if you disable a local video track by calling `setEnabled(false)`, the SDK immediately turns off the camera and stops capturing video.
</ProductWrapper>
> The `setEnabled` method changes media input behaviors, so it is an asynchronous operation and returns the result through the `Promise` object.

#### New features
<ProductWrapper notAllowed="voice-calling">
**Video encoding strategy**

v4.0.0 adds the `optimizationMode` property in the `CameraVideoTrackInitConfig`, `ScreenVideoTrackInitConfig`, and `CustomVideoTrackInitConfig` interfaces. When creating a video track by calling `createCameraVideoTrack`, `createCustomVideoTrack`, or `createScreenVideoTrack`, you can choose whether to prioritize video quality or smoothness by setting optimizationMode as the following:

-   `"detail"`: Prioritizes video quality.

-   The SDK ensures high-quality images by automatically calculating a minimum bitrate based on the capturing resolution and frame rate. No matter how poor the network condition is, the sending bitrate will never be lower than the minimum value.

-   In most cases, the SDK does not reduce the sending resolution, but may reduce the frame rate.

-   `"motion"`: Prioritizes video smoothness.

-   In poor network conditions, the SDK reduces the sending bitrate to minimize video freezes.

-   In most cases, the SDK does not reduce the frame rate, but may reduce the sending resolution.

> The `optimizationMode` property of the video track created by calling createScreenVideoTrack is set as `"detail"` by default.
</ProductWrapper>
#### Improvements
<ProductWrapper notAllowed="voice-calling">
-   Redesigns the `withAudio` parameter in `AgoraRTC.createScreenVideoTrack`. In addition to `enable` and `disable`, you can also set `withAudio` as `auto`. In this setting, the SDK shares the audio, dependent on whether the browser supports this function.

-   Does not allow setting the `withAudio` parameter as `"all"` any more to avoid code repetition. As of v4.0.0, you can only set `withAudio` as `"audio"` or `"video"`. This change involves the following APIs:
</ProductWrapper>
-   The `Client.subscribe` method.

-   The `Client.on("user-published")` and `Client.on("user-unpublished")` callbacks.

#### Fixed issues

v4.0.0 fixed the following issues:

-   After the local user called `unpublish`, the SDK triggerred the `Client.on("user-left")` callback on the remote side.
<ProductWrapper notAllowed="voice-calling">
-   Periodic video blur when sharing the screen in `"rtc"` mode.
</ProductWrapper>
-   Occasional publishing failure when calling `publish` and `unpublish` frequently.

-   The `Client.on("network-quality")` callback was inaccurate.

#### API changes

**Added**

-   The `Client.localTracks` interface

-   The `LocalTrack.setEnabled` method
<ProductWrapper notAllowed="voice-calling">
-   The `optimizationMode` property in ``` CameraVideoTrackInitConfig, ``ScreenVideoTrackInitConfig ```, and `CustomVideoTrackInitConfig` interfaces
</ProductWrapper>
**Updated**
<ProductWrapper notAllowed="voice-calling">
-   Adds the value of `auto` to the withAudio parameter in `AgoraRTC.createScreenVideoTrack`.
</ProductWrapper>
-   Removes the value of `"all"` from the mediaType parameter in `Client.subscribe`.

-   The `mediaType` parameter in the `Client.on("user-published")` and `Client.on("user-unpublished")` callbacks does report `"all"`

**Deprecated**

-   The `LocalAudioTrackStats.muteState` property
<ProductWrapper notAllowed="voice-calling">
-   The `LocalVideoTrackStats.muteState` property

-   The `RemoteVideoTrackStats.muteState` property
</ProductWrapper>
-   The `RemoteAudioTrackStats.muteState` property

**Deleted**

-   The `Client.on("user-mute-updated")` callback

-   The `LocalTrack.setMute` method

-   The `AgoraRTCRemoteUser.audioMuted` property
<ProductWrapper notAllowed="voice-calling">
-   The `AgoraRTCRemoteUser.videoMuted` property
</ProductWrapper>
-   The `LocalTrack.getUserId` method

</PlatformWrapper>