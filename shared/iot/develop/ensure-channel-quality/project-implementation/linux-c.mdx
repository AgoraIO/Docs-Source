<PlatformWrapper platform="linux-c">

### Implement channel quality features

To implement channel quality features, take the following steps:

1. **Configure the <Vpd k="SDK" /> log file**

    To customize the location, and content of the log file, add the following code to `main(...)` before `rval = agora_rtc_init(p_appid, &event_handler, &service_opt);`

    ```cpp
    // Configure log file location and logging level
    service_opt.log_cfg.log_path = config->p_sdk_log_dir;
    service_opt.log_cfg.log_level = RTC_LOG_DEBUG;
    ```

1. **Specify the audio codec, sampling rate and the number of channels**

    You set the audio codec, sampling rate, and the number of channels in `channel_options` that you pass to `agora_rtc_join_channel`. To set these parameters, modify the following lines in `main(...)` method according to your requirements:

    ```cpp
    channel_options.audio_codec_opt.audio_codec_type = config->audio_codec_type;
    channel_options.audio_codec_opt.pcm_sample_rate = config->pcm_sample_rate;
    channel_options.audio_codec_opt.pcm_channel_num = config->pcm_channel_num;
    ```
  
    Choose from `AUDIO_CODEC_TYPE_OPUS`, `AUDIO_CODEC_TYPE_G722`, `AUDIO_CODEC_TYPE_G711A`, and `AUDIO_CODEC_TYPE_G711U` built-in audio codecs in the <Vpd k="SDK" />. 
    
    To use your own audio codec, set `channel_options.audio_codec_opt.audio_codec_type` to `AUDIO_CODEC_DISABLED`. When you call `agora_rtc_send_audio_data`, set the `data_type` parameter of `audio_frame_info` to your encoding format. This setting transmits the audio encoding format as is to the receiving end. When you disable use of a built-in audio codec, <Vpd k="SDK" /> does not process the audio. The receiving end obtains the encoded audio data and the encoding format through the `__on_audio_data` callback and decodes it using a custom decoder.
    
1. **Configure Bandwidth Estimation**  

    You configure BandWidth Estimation (BWE) parameters before joining a channel. For example, based on the [definition levels of a webcam](#definition-levels-of-a-webcam), the minimum value can be set to 400 kbps, and the maximum value can be set to 4200 kbps. The starting value is between the minimum and the maximum value. If the initial encoding is SD, the initial bit rate can be set to 500 kbps, based on the table.

    To specify these parameters, replace the `agora_rtc_set_bwe_param` call in `main(...)` with the following:
    
    ```cpp
    // Configure Bandwidth Estimation
    // Min, max and starting bit rates in bps
    uint32_t min_bps = 400000;
    uint32_t max_bps = 4200000;
    uint32_t start_bps = 500000;
    rval = agora_rtc_set_bwe_param(min_bps,  max_bps,  start_bps);
    ```

1. **Respond to target bit rate changes**

    When network bandwidth changes, <Vpd k="SDK"/> triggers the `onTargetBitrateChanged` callback to prompt the <Vpl k="CLIENT"/> to adjust the sending bit rate. The `targetBps` value returned by the callback is the maximum recommended encoding bit rate of the video encoder.

    In this example, you use [definition levels of a webcam](#definition-levels-of-a-webcam) to switch resolution depending on the reported target bit rate. To do this, replace the `onTargetBitrateChanged` method under `agoraRtcEvents` with the following:

    ```cpp
    // Adjust the sending code rate in real time
    static void __on_target_bitrate_changed(const char *channel, uint32_t target_bps)
    {
        // The current code rate is graded according to 100 K, rounded down
        curTargetBitrate = target_bps/100000 * 100;
        diffTargetBitrate = abs(curTargetBitRate - lastTargetBitrate);

        // If the difference between the detected bandwidth and the set encoding rate is more than 100 K, rewrite and adjust the encoding parameters
        if ( (diffTargetBitrate >= 100 ) && (lowBitrateL1 < curTargetBitrate < highBitrateL3) )
        {
            if (lowBitrateL1 < curTargetBitrate < highBitrateL1)
            {
                curResolutionLevel = L1;
            }
            else if (lowBitrateL2 < curTargetBitrate < highBitrateL2)
            {
                curResolutionLevel = L2;
            }
            else
            {
                curResolutionLevel = L3;
            }
            
            // Adjust encoding resolution
            if (curResolutionLevel != lastResolutionLevel)
            {
                // setEncodeResolution(curResolutionLevel);
            }
            // Set the encoding rate
            // setEncodeBitrate(curTargetBitrate);

            lastResolutionLevel = curResolutionLevel;
            lastTargetBitrate = curTargetBitrate;
        }
    }
    ```

1. **Manage audio and video streaming status**

    When a user taps a `Checkbox`, you pause or resume sending local audio and video streams. To do this, add the following code to the `onCreate` method in the `MainActivity` class:
    
    ```cpp
    agora_rtc_mute_local_audio ( connection_id_t conn_id, bool mute)
    agora_rtc_mute_local_video ( connection_id_t conn_id, bool mute)
    ```
    
    To pause and resume playing remote audio or video streams call `agora_rtc_mute_local_audio ( connection_id_t conn_id, bool mute)` or `agora_rtc_mute_local_video ( connection_id_t conn_id, bool mute)`.

1. **Handle muting and unmuting notifications of remote streams**

    When a remote user mutes or unmutes their audio or video stream, you receive notification of these changes. In this example, you write log messages when you receive the `__on_user_mute_audio` and `__on_user_mute_video` callbacks:

    ```cpp
    static void __on_user_mute_audio(connection_id_t conn_id, uint32_t uid, bool muted)
    {
    LOGI("[conn-%u] audio: uid=%u muted=%d", conn_id, uid, muted);
    }

    static void __on_user_mute_video(connection_id_t conn_id, uint32_t uid, bool muted)
    {
    LOGI("[conn-%u] video: uid=%u muted=%d", conn_id, uid, muted);
    }
    ```

</PlatformWrapper>