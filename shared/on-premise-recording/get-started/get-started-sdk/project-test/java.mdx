<PlatformWrapper platform="linux-java">

Agora provides an open source sample project on GitHub for your reference. Download or view the [Agora Recording Java SDK](https://github.com/AgoraIO-Extensions/Agora-Recording-Java-SDK) project for a more detailed example.

Follow these steps to compile, configure, and run the Agora recording sample using the Spring Boot project.

1. **Compile the project**

   Open a terminal and navigate to the `Examples-Mvn` directory. Run the following command to build the project:

   ```bash
   mvn clean package
   ```

   After the build completes successfully, the output JAR file appears in the `target/generated` directory as `agora-example.jar`.

2. **Configure your App ID and token**

   In the `Examples-Mvn` directory, create a `.keys` file and add your Agora credentials:

   ```env
   appId=YOUR_APP_ID
   token=YOUR_TOKEN
   ```

   Replace `YOUR_APP_ID` and `YOUR_TOKEN` with your actual values.

3. **Prepare native libraries**

   Ensure that the `libs/native/linux/x86_64/` directory contains the following `.so` files:

   - `libagora_rtc_sdk.so`
   - `librecording.so`
   - `libagora-fdkaac.so`
   - `libaosl.so`

   <Admonition type="info" info="info">
   These libraries must be available at runtime. If any are missing, the application will fail to load the native dependencies.
   </Admonition>

4. **Run the sample application**

   From the `Examples-Mvn` directory, run the following command:

   ```bash
   LD_LIBRARY_PATH="$LD_LIBRARY_PATH:libs/native/linux/x86_64" \
   java -Dserver.port=18080 -jar target/agora-example.jar
   ```

   The Spring Boot server starts and listens on port `18080`. To use a different port, update the `-Dserver.port` parameter.

5. **Start and stop a recording session**

   - **Start recording**

     Send an HTTP request to the following endpoint:

     ```text
     http://<your-server-ip>:18080/api/recording/start?configFileName=mix_stream_recorder_audio_video_water_marks.json
     ```

   - **Stop recording**

     Replace `<taskId>` with the value returned from the start response:

     ```text
     http://<your-server-ip>:18080/api/recording/stop?taskId=<taskId>
     ```

   <Admonition type="info" info="info">
   Place all configuration files (such as `mix_stream_recorder_audio_video_water_marks.json`) in the `Examples-Mvn/src/main/resources/` directory.
   </Admonition>

</PlatformWrapper>
