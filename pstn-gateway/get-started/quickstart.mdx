---
title: "Quickstart"
sidebar_position: 1
type: docs
platform_selector: false
description: >
    Trigger inbound and outbound PSTN and SIP calls to connect to the audio in an Agora channel.
---

export const toc = [{}];

Developers can use <Vg k="COMPANY" /> REST APIs to connect phone users to real-time sessions through PSTN or SIP. Whether the session is audio-only or includes video, these users join through their phone for the audio portion of the channel.

## Understand the tech
<Vg k="COMPANY" /> REST APIs allow developers to trigger inbound and outbound PSTN(Public Switched Telephone Network) and SIP(Session Initiation Protocol) calls. These then connect into an <Vg k="COMPANY" /> channel enabling end-users to participate with their phone for the audio leg of the conference call.

<Admonition type="info" title="Note">Contact [technical support](mailto:support@agora.io) to provision your **AppID** with this service. <Vg k="COMPANY" /> will provide you with an **authorization header** to include in the API requests below.</Admonition>

## Prerequisites

Ensure that you have implemented the [SDK quickstart](../get-started/get-started-sdk) in your project.

## Implement PSTN and SIP gateway

This section explains how to implement PSTN and SIP gateway functionality using <Vg k="COMPANY" /> REST APIs.

### Inbound PSTN

In this scenario, the end-user dials the phone number displayed to them and enters the PIN when prompted. If they enter the correct PIN, the system connects them to the <Vg k="COMPANY" /> channel.

 - URL: https://sipcm.agora.io/v1/api/pstn
 - Method: POST

#### Request body parameters as JSON

```json
{
  "action":"inbound", 
  "appid":"fs9f52d9dcc1f406b93d97ff1f43c554f",
  "token":"006d2776fef40dc864dc7a438e3b871IACGnkorQsr0iCpBmzNwKEdzKuAv1b1zRcMy0cOradw6mHN/il8AAAAAIgCQqbAFeaVzZgQAAQDw0oBmAgDw0oBmAwDw0oBmBADw0oBm",
  "uid":"123",
  "channel":"pstn",
  "region":"AREA_CODE_NA",
}
```

 - **appid**(string): <Vg k="COMPANY" /> project app ID
 - **token**(string) [optional]: Generated <Vg k="COMPANY" /> RTC access token
 - **uid**(string or int) [optional]: A user uid
 - **channel**(string): An <Vg k="COMPANY" /> channel name
 - **region**(string): User's region where they will likely be located and calling from. Values:
    - **AREA_CODE_NA**: North America
    - **AREA_CODE_EU**: Europe
    - **AREA_CODE_AS**: Asia, excluding Mainland China
    - **AREA_CODE_JP**: Japan
    - **AREA_CODE_IN**: India
    - **AREA_CODE_CN**: Mainland China

#### Success response example

 - **Status Code**: 200 OK
 - **Content Type**: application/json
 - **Body**:
   ```json
   {  
     "did": "17377583411",
     "display": "+1 (737) 758 3411",
     "pin": "780592",
   }
   ```

    - **did**: Phone number to dial
    - **display**: Phone number to dial in a more friendly display format
    - **pin**: Pin to enter when prompted

#### Error code responses

 - **401**: Unauthorized
 - **500**: Missing Parameters
 - **503**: No resource currently available

### Outbound PSTN

Here, the system calls the end-user and connects them directly to the channel when they answer.

 - URL: https://sipcm.agora.io/v1/api/pstn
 - Method: POST

#### Request body parameters as JSON

```json
{
  "action":"outbound",
  "appid":"fs9f52d9dcc1f406b93d97ff1f43c554f",
  "token":"006d2776fef40dc864dc7a438e3b871IACGnkorQsr0iCpBmzNwKEdzKuAv1b1zRcMy0cOradw6mHN/il8AAAAAIgCQqbAFeaVzZgQAAQDw0oBmAgDw0oBmAwDw0oBmBADw0oBm",
  "uid":"123",
  "channel":"pstn",
  "region":"AREA_CODE_NA",
  "prompt":"true",
  "to":"+447712886400#333",
  "from":"+1800222333",
  "timeout":"3600",
  "sip":"acme.pstn.ashburn.twilio.com"
}
```

 - **appid**(string): <Vg k="COMPANY" /> project app ID
 - **token**(string) [optional]: A generated access token
 - **uid**(string or int) [optional]: A user uid
 - **channel**(string): An <Vg k="COMPANY" /> channel name
 - **prompt**(string): Play the callee a voice prompt and wait for them to press a digit. If set to "lazy" then any DTMF may be pressed.
 - **to**(string): End-user's phone number to dial. You can optionally add a # followed by numbers which will be played as DTMF once the call connects.
 - **from**(string): Calling number displayed on the end-user's phone during ringing.
 - **sip**(string): Termination sip uri or leave blank if being routed by this service.
 - **timeout**(string) [optional]: Max duration for outbound call in seconds. Default 3600 seconds which is 1 hour.
- **region**(string): User's region where they will likely be located and calling from. Values:
    - **AREA_CODE_NA**: North America
    - **AREA_CODE_EU**: Europe
    - **AREA_CODE_AS**: Asia, excluding Mainland China
    - **AREA_CODE_JP**: Japan
    - **AREA_CODE_IN**: India
    - **AREA_CODE_CN**: Mainland China

#### Success response example

- **Status Code**: 200 OK
- **Content Type**: application/json
- **Body**:
   ```json
   {
     "success": true,
     "callid": "88877-55Asdd7-55Asdd",
     "reason": "Busy",
   }
   ```

    - **success**: If 'true' the call has connected and 'callid' will be included in the response. If 'false', the call has failed and the 'reason' will be included in the response.
    - **callid** [optional]: This can be used to end the call
    - **reason** [optional]: The call failed because the user was 'Busy' or the destination was 'Invalid'.

#### Error code responses

- **401**: Unauthorized
- **500**: Missing Parameters
- **503**: No resource currently available

If this API returns success 'true' the call has been connected. If it returns success 'false' there will be a reason.

### Inbound SIP

The system requests an inbound SIP address in this case. When someone dials that address, it routes the call to the specified user or channel session.

- URL: https://sipcm.agora.io/v1/api/pstn
- Method: POST

#### Request body parameters as JSON

```json
{
  "action":"inboundsip",
  "appid":"fs9f52d9dcc1f406b93d97ff1f43c554f",
  "token":"006d2776fef40dc864dc7a438e3b871IACGnkorQsr0iCpBmzNwKEdzKuAv1b1zRcMy0cOradw6mHN/il8AAAAAIgCQqbAFeaVzZgQAAQDw0oBmAgDw0oBmAwDw0oBmBADw0oBm",
  "uid":"123",
  "channel":"test",
  "region":"AREA_CODE_NA",
}
```

- **appid**(string): <Vg k="COMPANY" /> project app ID
- **token**(string) [optional]: Generated access token
- **uid**(string or int) [optional]: A user uid
- **channel**(string): An <Vg k="COMPANY" /> channel name
- **region**(string): User's region where they will likely be located and calling from. Values:
    - **AREA_CODE_NA**: North America
    - **AREA_CODE_EU**: Europe
    - **AREA_CODE_AS**: Asia, excluding Mainland China
    - **AREA_CODE_JP**: Japan
    - **AREA_CODE_IN**: India
    - **AREA_CODE_CN**: Mainland China

#### Success response example

- **Status Code**: 200 OK
- **Content Type**: application/json
- **Body**:
   ```json
   {  
     "sip": "sip:pstn_783410988998@2.4.6.7:5080",
   }
   ```

    - **sip**: SIP address to dial to join the call

#### Error code responses

- **401**: Unauthorized
- **500**: Missing Parameters
- **503**: No resource currently available

Using this API you can bridge an outbound call from your provider with an inbound SIP address into <Vg k="COMPANY" />.

### Static PIN

If provisioned, the service can call out to an external REST endpoint providing the number is dialed and pin is entered. The REST endpoint can choose to accept the PIN and return the details needed to join the user to the channel or error status 404 if the PIN is not valid.

- URL: https://example.customer.com/api/pinlookup
- Method: POST

#### Request body parameters as JSON

```json
{
  "did":"17177440111",
  "pin":"334455",
}
```

- **did**: Dialled phone number
- **pin**: Entered pin number

#### Success response example

- **Status Code**: 200 OK
- **Content Type**: application/json
- **Body**:
   ```json
   {  
     "token":"006d2776fef40dc864dc7a438e3b871IACGnkorQsr0iCpBmzNwKEdzKuAv1b1zRcMy0cOradw6mHN/il8AAAAAIgCQqbAFeaVzZgQAAQDw0oBmAgDw0oBmAwDw0oBmBADw0oBm",
     "uid":"123",
     "channel":"test",
     "appid":"fs9f52d9dcc1f406b93d97ff1f43c554f",
   }
   ```

    - **token**(string): A generated access token or the App ID if tokens are not enabled.
    - **uid**(string or int): A user uid
    - **channel**(string): An <Vg k="COMPANY" /> channel name
    - **appid**(string): <Vg k="COMPANY" /> appid for your project

#### Error code responses

- **404**: Not found

This API allows you to give your users a pin that will not expire.

### IP configuration

To enable outbound and inbound PSTN and SIP calls, the following IP address configurations are required.

#### Outbound IPs

Add the following IP addresses to any Access Control List which restrict outbound calling by IP:
- 3.9.67.24
- 52.3.185.227
- 52.9.29.181
- 34.233.232.16

#### Inbound IPs

Point inbound calls at one of these IPs with the other being a failover:
- 52.3.185.227
- 52.9.29.181
