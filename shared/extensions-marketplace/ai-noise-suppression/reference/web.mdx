<PlatformWrapper platform="web">

- For a working example, check out the [AI Denoiser web demo](https://webdemo.agora.io/aiDenoiser/index.html) and the associated [source code](https://github.com/AgoraIO/API-Examples-Web/tree/main/Demo/aiDenoiser).

### API reference

This section provides the API reference for the AI Denoiser extension.

#### IAIDenoiserExtension

##### checkCompatibility

Checks whether the current browser supports the AI Denoiser extension. The result returned by this method is for reference only.

```typescript
checkCompatibility(): boolean;
```

_Since v1.1.0_

##### createProcessor

Creates an `IAIDenoiserProcessor` instance.

```typescript
createProcessor(): IAIDenoiserProcessor;
```

##### setLogLevel

Sets the log level. For available log levels, see [AIDenoiserLogLevel](#aidenoiserloglevel).

```typescript
public setLogLevel(level: AIDenoiserLogLevel)
```

_Since v2.0.0_

##### onloaderror

Callback for Wasm dependency file loading failures.

```typescript
onloaderror?: (error: Error) => void;
```

_Deprecated since v2.0.0_

#### IAIDenoiserProcessor

##### kind

The processor type, either video or audio.

```typescript
get kind(): 'video' | 'audio';
```

##### enabled

Whether the extension is enabled:
- `true`: Enabled.
- `false`: Not enabled.

```typescript
get enabled(): boolean;
```

##### enable

Enables the AI denoising feature.

```typescript
enable(): void | Promise<void>;
```

##### disable

Disables the AI denoising feature.

```typescript
disable(): void | Promise<void>;
```

This method must be called after [`pipe`](/api-ref/rtc/javascript/interfaces/imicrophoneaudiotrack.html#pipe).

##### setMode

Sets the denoising mode.

```typescript
setMode(mode: AIDenoiserProcessorMode): Promise<void>;
```

_Since v1.1.0_

You can call this method in the [onoverload](#onoverload) callback to switch to stationary noise suppression to reduce overhead. See [AIDenoiserProcessorMode](#aidenoiserprocessormode) for details.

This method must be called after [`pipe`](/api-ref/rtc/javascript/interfaces/imicrophoneaudiotrack.html#pipe).

##### setLevel

Sets the denoising intensity. See [AIDenoiserProcessorLevel](#aidenoiserprocessorlevel) for details.

```typescript
setLevel(level: AIDenoiserProcessorLevel): Promise<void>;
```

_Since v1.1.0_

This method must be called after [`pipe`](/api-ref/rtc/javascript/interfaces/imicrophoneaudiotrack.html#pipe).

##### setLatency

Sets the denoising latency level. See [AIDenoiserProcessorLatency](#aidenoiserprocessorlatency) for details.

```typescript
setLatency(latency: AIDenoiserProcessorLatency): Promise<void>;
```

_Since v2.0.0_

This method must be called after [`pipe`](/api-ref/rtc/javascript/interfaces/imicrophoneaudiotrack.html#pipe).

##### dump

Dumps audio data during the denoising process to help troubleshoot and analyze denoising issues.

```typescript
dump(): void;
```

This method must be called after [`pipe`](/api-ref/rtc/javascript/interfaces/imicrophoneaudiotrack.html#pipe).

Calling this method triggers 9 `dump` events, returning audio data processed by the extension 30 seconds before and 60 seconds after the method call, for a total of 9 audio files (see audio file description). Then it triggers the `dumpend` event, indicating that the audio data dump has completed.

**Audio file description**

Each audio file is encoded in PCM format with a duration of 30 seconds. The filename contains the following information:

- The processing stage of the audio data, one of the following:
   - `input`: Audio data awaiting denoising.
   - `ns_out`: Audio data after noise suppression.
   - `agc_out`: Audio data after voice enhancement.
- Audio sample rate.
- Number of channels.
- Dump time: If the dump time is T (in seconds), the file contains audio data from the range [T-30, T].

Example audio filename: `input_16000hz_1ch_0.pcm`

**Note**

- If you disable AI denoising before the `dump` event triggers 9 times, the dump process terminates immediately and triggers the `dumpend` event. In this case, fewer than 9 audio data files are returned.
- If the extension processes less than 30 seconds of audio, the corresponding audio file duration is also less than 30 seconds.

##### ondump

Callback for dumping audio data.

```typescript
ondump?: (blob: Blob, name: string) => void;
```

_Deprecated since v2.0.0_

This callback returns the following parameters:

- `blob`: The audio data file.
- `name`: The name of the audio data file.

##### ondumpend

Callback indicating that audio data dumping has completed.

```typescript
ondumpend?: () => void;
```

_Deprecated since v2.0.0_

##### onoverload

Callback for when denoising processing takes too long.

```typescript
onoverload?: (elapsedTime: number) => void;
```

_Deprecated since v2.0.0_

**Parameters**

- `elapsedTime`: The time (in milliseconds) the extension takes to process one audio frame. This value is for reference only; precision depends on the browser's timing accuracy. For example, Firefox has lower time precision.

##### on callbacks

Listens for events.

```typescript
on(event: "pipeerror", listener: AIDenoiserProcessorPipeErrorCallback): void;
on(event: "overload", listener: AIDenoiserProcessorOverloadCallback): void;
on(event: "dump", listener: AIDenoiserProcessorDumpCallback): void;
on(event: "dumpend", listener: AIDenoiserProcessorDumpEndCallback): void;
```

_Since v2.0.0**, the AI Denoiser extension listens for the following events using `on_
- `pipeerror`: Wasm dependency file loading failure event. Replaces the `onloaderror` callback.
- `overload`: Denoising processing takes too long event. Replaces the `onoverload` callback.
- `dump`: Audio data dump event. Replaces the `ondump` callback.
- `dumpend`: Audio data dump completed event. Replaces the `ondumpend` callback.

#### Type definitions

##### AIDenoiserExtensionOptions

AI Denoiser extension initialization parameters.

```typescript
export interface AIDenoiserExtensionOptions {
  assetsPath: string
}
```

**Parameters**

- `assetsPath`: The URL path to the Wasm files required by the AI Denoiser extension. Do not include a trailing slash in the path, for example, `./external`.

The extension constructs the full path to the Wasm file based on `assetsPath`. If an incorrect path causes the Wasm file to fail loading, you receive a `pipeerror` event.

##### AIDenoiserProcessorMode

Denoising mode.

```typescript
export enum AIDenoiserProcessorMode {
  NSNG = "NSNG",
  STATIONARY_NS = "STATIONARY_NS",
}
```

**Values**

- `NSNG`: AI denoising. This mode suppresses both stationary and non-stationary noise types.
- `STATIONARY_NS`: Stationary noise suppression. This mode only suppresses stationary noise. Use this mode only when AI denoising processing takes too long.

##### AIDenoiserProcessorLevel

Denoising intensity.

```typescript
export enum AIDenoiserProcessorLevel {
  SOFT = "SOFT",
  AGGRESSIVE = "AGGRESSIVE",
}
```

**Values**

- `SOFT`: (Recommended) Soft denoising.
- `AGGRESSIVE`: Aggressive denoising. Increasing the denoising intensity to aggressive increases the probability of damaging the voice signal.

##### AIDenoiserLogLevel

AI Denoiser extension log level.

```typescript
export enum AIDenoiserLogLevel {
  DEBUG = "DEBUG",
  INFO = "INFO",
  WARN = "WARN",
  ERROR = "ERROR",
  NONE = "NONE",
}
```

**Values**

- `DEBUG`: (0) Prints debug information, general information, warnings, and error logs.
- `INFO`: (1) Prints general information, warnings, and error logs.
- `WARN`: (2) Prints warnings and error logs.
- `ERROR`: (3) Prints error logs only.
- `NONE`: (4) Prints no logs.

##### AIDenoiserProcessorLatency

AI denoising latency level.

```typescript
export enum AIDenoiserProcessorLatency {
  LOW = "LOW",
  FULL = "FULL",
}
```

**Values**

- `LOW`: Low latency mode (approximately 40 ms). In this mode, denoising performance is slightly reduced.
- `FULL`: High latency mode.

</PlatformWrapper>
