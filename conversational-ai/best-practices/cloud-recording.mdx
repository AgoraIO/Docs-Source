---
title: Record conversations with Cloud Recording
sidebar_position: 4
platform_selector: false
description: >
   Configure Cloud Recording to record AI agent conversations
---

This guide explains how to configure Agora [Cloud Recording](/cloud-recording/overview/product-overview) to work with conversational AI agents and avoid common audio issues.

## Common issues and solutions

When intelligent agents and Cloud Recording are used on the same channel, two main issues can affect the audio experience:

1. **Audio scene conflict** - The agent's audio optimization fails and may cause a brief audio interruption when recording starts.
1. **Silent audio at recording start** - The agent publishes audio streams even when not speaking, creating silence at the beginning of recorded files.


The following table shows the causes and solutions for these issues:

| Issue | Symptom | Solution |
|-------|---------|----------|
| Audio scene conflict | When a user joins a channel during Cloud Recording, the agent's audio scene reverts to default mode, causing a brief audio interruption when recording starts. | Set the agent's `audio_scenario` parameter to `"chorus"`. |
| Silent audio at recording start | The recording file begins with a period of silence. | Set the agent's `publish_audio_auto_publishing` parameter to `false`. |

## Configure the agent

To avoid these issues, configure the agent's launch request with the following parameters.

### Set audio scene to chorus

Set the agent's `audio_scenario` parameter to `"chorus"` to ensure stable audio processing on channels shared with Cloud Recording.

Add or modify the `audio_scenario` field in the agent's startup parameters:

```json
{
    "properties": {
        "parameters": {
        "audio_scenario": "chorus" // Use "chorus" instead of "AI_Server"
        }
    }
}
```

### Disable automatic audio publishing

Set the agent's `publish_audio_auto_publishing` parameter to `false` to prevent silent segments in recordings.

Add the following field to the `rtc` configuration:

```json
{
    "properties": {
        "parameters": {
            "rtc": {
                "publish_audio_auto_publishing": false
            }
        // Other parameters
        }
    }
}
```

## Complete configuration example

The following example shows a complete agent launch request with the optimized configuration:

```json
{
    "name": "TestConvoAgent",
    "properties": {
        "channel": "{{AccessChannel}}",
        "token": "{{token}}",
        "agent_rtc_uid": "0",
        "remote_rtc_uids": [
            "*"
        ],
        "idle_timeout": 30,
        "advanced_features": {
            "enable_bhvs": true
        },
        "llm": {
            "url": "https://api.openai.com/v1/chat/completions",
            "api_key": "<your_llm_api_key>",
            "system_messages": [
                {
                    "role": "system",
                    "content": "You are a helpful chatbot."
                }
            ],
            "greeting_message": "Hello, how can I help you?",
            "failure_message": "Sorry, I don't know how to answer this question.",
            "max_history": 10,
            "params": {
                "model": "gpt-4o-mini"
            }
        },
        "tts": {
            "vendor": "microsoft",
            "params": {
                "key": "<your_tts_api_key>",
                "region": "eastus",
                "voice_name": "en-US-AndrewMultilingualNeural"
            }
        },
        "turn_detection": {
            "silence_duration_ms": 640
        },
        "parameters": {
            "enable_dump": true,
            "enable_error_message": true,
            "audio_scenario": "chorus",
            "enable_delay": true,
            "rtc": {
                "publish_audio_auto_publishing": false
            }
        }
    }
}
```

## Start Cloud Recording

After starting the agent, start Cloud Recording by calling the [Start Cloud Recording API](/cloud-recording/reference/restful-api#start).

The following example shows a complete Cloud Recording start request body:

```json
{
	"cname":"{{AccessChannel}}",
	"uid":"{{RecordingUID}}",
	"clientRequest":{
		"token":"{{token}}",
		"recordingConfig":{
			"maxIdleTime":120,
			"streamTypes":0,
			"audioProfile":1,
			"channelType":1
		},
        "recordingFileConfig": {
            "avFileType": [
                "hls",
                "mp4"
            ]
        },
		"storageConfig":{
			"vendor":{{Vendor}},
			"region":{{Region}},
			"bucket":"{{Bucket}}",
			"accessKey":"{{AccessKey}}",
			"secretKey":"{{SecretKey}}"
		}	
	}
}
```