import Authorization from '@docs/shared/media-gateway/reference/rest-api/authorization.mdx';
import CodeBlock from '@theme/CodeBlock';
import PostmanLink from '@docs/shared/media-gateway/reference/rest-api/postman-link.mdx';
import RestAPILayout from '@site/src/components/rest-api/RestAPILayout'; 
import LeftColumn from '@site/src/components/rest-api/LeftColumn'; 
import RightColumn, { Section } from '@site/src/components/rest-api/RightColumn'; 
import ParameterList, { Parameter } from '@site/src/components/rest-api/ParameterList'; 
import PathParameter from '@site/src/components/rest-api/PathParameter'; 
import { Tabs, TabItem } from '@site/src/components/rest-api/Tabs';

<RestAPILayout>

  <LeftColumn
    title={frontMatter.title}
    method="GET"
    endpoint="https://api.agora.io/:region/v1/projects/:appId/rtls/ingress/online-streams/:sid"
  >

This method queries an ongoing push based on SID.

### Request

**Path parameters**

<PathParameter name="appId" type="string" required={true}>
  The app ID provided by <Vg k="COMPANY"/> to each developer. After creating a project in <Vg k="CONSOLE"/>, you can get an app ID. The app ID is a unique identifier for a project.
</PathParameter>
<PathParameter name="region" type="string" required={true}>
  Create an area for pushing the streaming key. <Vg k="COMPANY"/> supports creation of stream keys by region. Currently, the following regions are supported: 
  <ul>
    <li>`na`: North America</li>
    <li>`eu`: Europe</li>
    <li>`ap`: Asia, except mainland China</li>
    <li>`cn`: Mainland China</li>
  </ul>
  <Admonition type="caution" title="Important">
    Make sure that: 
    <ul>
      <li>The `region` value is the same as for the input source stream.</li>
      <li>The domain names for setting the `region` parameter and streaming are the same.</li>
      <li>The `region` value is in lowercase.</li>
    </ul>
  </Admonition>
</PathParameter>
<PathParameter name="sid" type="string" required={true}>
  The streaming session ID is the unique identifier for each initiated streaming task. It can be obtained by [querying the streaming list](query-streaming-list) or receiving the payload of the [message notification callback](../../../../develop/receive-notifications).
</PathParameter>


**Headers**

<ParameterList title="HEADER" required={true}>
  <Parameter name="X-Request-ID" type="UUID" required={true}>
    The UUID (Universally Unique Identifier) of the request. After passing in this field, the <Vg k="COMPANY"/> server will return this field in the response header. It is recommended to assign `X-Request-ID` a value. If no value is assigned, the <Vg k="COMPANY"/> server will automatically generate a UUID and pass it in.
  </Parameter>
  <Parameter name="Authorization" type="string" required={true}>
  <Authorization/>
  </Parameter>
</ParameterList>

### Response

**Headers**

<ParameterList title="HEADER" required={true}>
  <Parameter name="X-Request-ID" type="UUID" required={true}>
    The UUID (Universally Unique Identifier) of the request. After passing in this field, the <Vg k="COMPANY"/> server will return this field in the response header. It is recommended to assign `X-Request-ID` a value. If no value is assigned, the <Vg k="COMPANY"/> server will automatically generate a UUID and pass it in.
  </Parameter>
</ParameterList>

**Response body**

If the status code is `200`, the request succeeds, and the response body includes the following parameters:
<ParameterList name="BODY" required={true}>
<Parameter name="status" type="string">
  The status of this request. <code>success</code> means the request succeeds.
</Parameter>

<Parameter name="data" type="object">
  Includes the following fields:
  <Parameter name="sid" type="string">
    A streaming session ID. A unique <code>sid</code> will be generated for each stream.
  </Parameter>
  <Parameter name="channel" type="string">
    The name of the <Vg k="COMPANY"/> channel associated with the streaming key.
  </Parameter>
  <Parameter name="uid" type="string">
    The user UID in the <Vg k="COMPANY"/> channel associated with the streaming key.
  </Parameter>
  <Parameter name="url" type="string">
    The push address in the <code>$domain/live/$streamkey</code> format.
  </Parameter>
  <Parameter name="status" type="string">
    The flow status. Possible values are:
    <ul>
      <li><code>"Started"</code>: Connection has been established, waiting to stream audio and video.</li>
      <li><code>"Running"</code>: Is being streamed.</li>
    </ul>
  </Parameter>
</Parameter>

<Parameter name="beginAt" type="string">
  Streaming start time in the <code>"2024-01-01 01:01:01.001"</code> format.
</Parameter>

<Parameter name="bitrate" type="integer">
  The source stream bitrate (audio + video) of the pushed stream, in Kbps.
</Parameter>

<Parameter name="video" type="object">
  Video stream parameters, returned only if the status is <code>"Running"</code>:
  <Parameter name="width" type="number">
    Video width in pixels.
  </Parameter>
  <Parameter name="height" type="number">
    Video height in pixels.
  </Parameter>
  <Parameter name="fps" type="number">
    Video frame rate in frames per second.
  </Parameter>
</Parameter>

<Parameter name="audio" type="object">
  Audio stream parameters, returned only if the status is <code>"Running"</code>:
  <Parameter name="channels" type="number">
    The number of audio channels.
  </Parameter>
  <Parameter name="sampleRate" type="number">
    Audio sampling rate in Hz.
  </Parameter>
</Parameter>
</ParameterList>
If the status code is not `200`, the request fails. See the `message` field in the response body for the reason for this failure. For details about possible response status codes, see [Response status codes](../../response-status-codes).

<PostmanLink />
</LeftColumn>
<RightColumn>
<Section title="Authorization">
The endpoint requires [RESTful Authentication](/media-gateway/reference/restful-authentication#implement-basic-http-authentication).
</Section>
<Section title="Request example">
  <Tabs groupId="code-examples">
    <TabItem value="cURL" label="cURL" default>
    ```shell
    curl --request GET \
      --url https://api.agora.io/region/v1/projects/appId/rtls/ingress/online-streams/sid \
      --header 'Accept: application/json' \
      --header 'Authorization: Basic 123' \
      --header 'X-Request-ID: '
    ```
    </TabItem>
    <TabItem value="node" label="Node" default>
    ```js
    fetch("https://api.agora.io/region/v1/projects/appId/rtls/ingress/online-streams", {
        method: "GET",
        headers: {
            "Accept": "application/json",
            "Authorization": "Basic 123",
            "X-Request-ID": ""
        }
    })
    .then(res => res.json())
    .then(console.log)
    .catch(console.error);
    ```
    </TabItem>
    <TabItem value="python" label="Python" default>
    ```python
    url = "https://api.agora.io/region/v1/projects/appId/rtls/ingress/online-streams"
    headers = {
        "Accept": "application/json",
        "Authorization": "Basic 123",
        "X-Request-ID": ""
    }

    res = requests.get(url, headers=headers)
    ```
    </TabItem>
  </Tabs>  
</Section>
<Section title="Response example">
```json
{
  "status" : "string" ,
  "data" : [
    {
      "sid" : "string" ,
      "channel" : "string" ,
      "uid" : "string" ,
      "url" : "string" ,
      "status" : "string" ,
      "beginAt" : "string" ,
      "bitrate" : 0 ,
      "video" : {
        "width" : 0 ,
        "height" : 0 ,
        "fps" : 0
      } ,
      "audio" : {
        "channels" : 0 ,
        "sampleRate" : 0
      }
    }
  ]
}
```
</Section>
</RightColumn>
</RestAPILayout>
