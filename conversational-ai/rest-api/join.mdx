---
title: 'Start a conversational AI agent'
sidebar_position: 1
type: docs
platform_selector: false
description: >
  Create and start a Conversational AI agent instance.
---

import CodeBlock from '@theme/CodeBlock';
import MultiCodeBlock, { CodeGroup, CodeItem } from '@app/mdx-components/MultiCodeBlock';

Use this endpoint to create and start a <Vpd k="NAME" /> instance.

### API Endpoint

- Method: `POST`
- Endpoint: `https://api.agora.io/cn/api/conversational-ai-agent/v1/projects/{appid}/join`

### Path parameters

| Parameter   | Type | Required | Description   |
|:--------|:---------|:----|:--------------|
| `appid` | string | Yes | The App ID of the project|

### Request body parameters
The request body must be a JSON object containing the following parameters:

| Parameter | Type    | Required | Description   |
|:----------------------|:-------------|:--------------|:--------|
| `name`  | string| Yes   | The unique identifier of the agent. The same identifier cannot be used repeatedly.  |
| `properties`   | object| Yes   | Configuration details of the agent. |
| ⇒`channel` | string| Yes   | The name of the channel to join.|
| ⇒`token`   | string| Yes   | The authentication token for the channel.   |
| ⇒`agent_rtc_uid` | integer | Yes   | RTC user ID. When `0` is specified, it means random assignment, but the token needs to be modified accordingly. |
| ⇒`remote_rtc_uid` | integer | Yes   | RTC subscriber ID. Use `0` to subscribe to all users in the channel. In one-on-one scenarios, the subscriber ID must be specified and cannot be `0`. |
| `rtc_codec` | integer | Optional | Default value: `-1` <li> `0`: PCMU</li> <li>`8`: PCMA</li> <li>`9`: G722</li> <li>`120`: OPUS</li> <li>`122`: OPUSFB</li>|
| ⇒`audio_scenario` | integer | Yes  | Audio mode: <li>`0`: Default configuration</li> <li>`9`: AI QOS (requires the AI QOS client version)</li>|
| ⇒`input_modalities` | [string] | Yes | Input mode. Supports `["text"]`, `["text", "image"]`  |
| ⇒`output_modalities` | [string] | Yes | Output mode. Supports `["audio"]`, `["text"]`, `["text", "audio"]`|
| ⇒`idle_timeout` | integer | Yes   | The maximum idle time of the agent in seconds. `0` means that the agent will not stop until it is manually exited. Default value `30`. |
| ⇒`enable_aivadmd` | boolean | Optional    | Whether to enable AIVAD and music detection. This feature is a value-added service, please refer to pricing for details. Default value `false`|
| ⇒`enable_bhvs` | boolean | Optional     | Whether to enable background noise reduction. This feature is a value-added service, please refer to pricing for details. Default value `true`  |
| ⇒`tts` | object | Optional | Text-to-speech (TTS) module configuration. |
| ⇒⇒`voice_id` | integer | Optional | Tone ID, see the supported tones list for details. Default value `female-shaonv`| 
| ⇒⇒`speed` | integer | Optional | The agent's speaking speed percentage. The normal speaking speed is 100% and the value range is [50,200]. Default value `100` |
| ⇒⇒`volume` | integer | Optional | Agent volume setting. The value range is [1,10]. Default value `1` |
| ⇒`custom_llm` | object  | Optional| Custom large language model configuration.    |
| ⇒⇒`url` | string | Yes | Custom LLM callback address..   |
| ⇒⇒`token` | string | Optional | Custom LLM verification token. It is empty by default. Best practice is to enable the token in a production environment.  |
| ⇒⇒`prompt` | string | Optional   | A prompt that the custom LLM supports; will be passed in as a system message. |
| ⇒⇒`model` | string | Optional    | Model ID that may be required by a custom LLM. |
| ⇒⇒`max_tokens` | integer | Optional | The maximum number of completion tokens that a custom LLM may require. Default value `1024` |
| ⇒⇒`max_history` | integer | Optional | The number of short-term memory entries cached in the custom LLM. `0` means no short-term memory is cached. User and assistant log entries separately. Default value `10`  |
| ⇒⇒`greeting` | string | Optional | Agent greeting. If provided, the first RTC user in the channel is automatically greeted when joining.  |
| ⇒⇒`failure_message` | string | Optional | Prompt for agent activation failure. If provided, it is returned through TTS when the custom LLM call fails. |
| ⇒⇒`extra_metadata` | object | Optional | The context information carried by the agent. If provided, it is passed to the server through  `metadata` parameters every time a custom LLM is requested. <Admonition type="info">Third-party large model services do not support this parameter and it is only applicable to self-built scenarios.</Admonition>  |
| ⇒⇒`metadata_enabled` | boolean | Optional | Whether to carry context: <li>`true`: Carry</li> <li>`false`: (Default) Do not carry</li>  |
| ⇒`vad` | object   | Optional | Voice activity detection (VAD) configuration. |
| ⇒⇒`interrupt_threshold` | number  | Optional | Interrupt sensitivity, the value range is (0.0 - 1.0]. The larger the value, the higher the sensitivity. Default value `0.8` |
| ⇒⇒`prefix_padding_ms` | integer | Optional | Padding duration (ms) at the beginning of audio recognition. Default value `300` |
| ⇒⇒`silence_duration_ms` | integer | Optional | Audio silence duration (ms). Default value `500` |
| ⇒⇒`threshold` | number  | Optional | VAD recognition sensitivity. Default value `0.5` |
| ⇒`asr` | object   | Optional | Automatic speech recognition (ASR) settings.    |
| ⇒⇒`language` | string | Yes (if `asr` is provided) | Language: <li>`en-US`: English</li> <li>`zh-CN`: (Default) Chinese (supports mixed Chinese and English)</li> |

### Request examples

Use one of the following request examples as a starting point:

<MultiCodeBlock caption="Sample request:">
<CodeGroup label="Select">
<CodeItem language="bash" name="curl">{`curl --request post \\
--url https://api.agora.io/cn/api/conversational-ai-agent/v1/projects/:appid/join \\
--data '
\{
  "name": "unique_name",
  "properties": {
    "channel": "channel_name",
    "token": "token",
    "agent_rtc_uid": 1234,
    "remote_rtc_uid": 123,
    "audio_scenario": 9,
    "input_modalities": [
      "text"
    ],
    "output_modalities": [
      "text"
    ],
    "idle_timeout": 120,
    "enable_aivadmd": true,
    "enable_bhvs": true,
    "custom_llm": {
      "url": "https://api.minimax.chat/v1/text/chatcompletion_v2",
      "token": "xxx",
      "prompt": "You are a helpful chatbot.",
      "model": "abab6.5s-chat",
      "greeting": "Hello, how can I help you?",
      "max_history": 10,
      "max_token": 1024,
      "failure_message": "Sorry, I don't know how to answer this question.",
      "extra_metadata": {
        "userName": "John"
      },
      "metadata_enabled": true
    },
    "tts": {
      "voice_id": "male-qn-qingse"
    },
    "asr": {
      "language": "en-US"
    }
  }
}'`}</CodeItem>


  <CodeItem language="python" name="Python">{`import requests\n
url = "https://api.agora.io/cn/api/conversational-ai-agent/v1/projects/:appid/join"\n
payload = {
    "name": "unique_name",
    "properties": {
        "channel": "channel_name",
        "token": "token",
        "agent_rtc_uid": 1234,
        "remote_rtc_uid": 123,
        "audio_scenario": 9,
        "input_modalities": ["text"],
        "output_modalities": ["text"],
        "idle_timeout": 120,
        "enable_aivadmd": True,
        "enable_bhvs": True,
        "custom_llm": {
            "url": "https://api.minimax.chat/v1/text/chatcompletion_v2",
            "token": "xxx",
            "prompt": "You are a helpful chatbot.",
            "model": "abab6.5s-chat",
            "greeting": "Hello, how can I help you?",
            "max_history": 10,
            "max_token": 1024,
            "failure_message": "Sorry, I don't know how to answer this question.",
            "extra_metadata": { "userName": "John" },
            "metadata_enabled": True
        },
        "tts": { "voice_id": "male-qn-qingse" },
        "asr": { "language": "en-US" }
    }
}\n
response = requests.request("post", url, json=payload)\n
print(response.text)
  `}</CodeItem>

  <CodeItem language="js" name="Node.js">{`const url = 'https://api.agora.io/cn/api/conversational-ai-agent/v1/projects/:appid/join';
const options = {
  method: 'post',
  body: JSON.stringify({
    name: 'unique_name',
    properties: {
      channel: 'channel_name',
      token: 'token',
      agent_rtc_uid: 1234,
      remote_rtc_uid: 123,
      audio_scenario: 9,
      input_modalities: ['text'],
      output_modalities: ['text'],
      idle_timeout: 120,
      enable_aivadmd: true,
      enable_bhvs: true,
      custom_llm: {
        url: 'https://api.minimax.chat/v1/text/chatcompletion_v2',
        token: 'xxx',
        prompt: 'You are a helpful chatbot.',
        model: 'abab6.5s-chat',
        greeting: 'Hello, how can I help you?',
        max_history: 10,
        max_token: 1024,
        failure_message: 'Sorry, I don't know how to answer this question.',
        extra_metadata: {userName: 'John'},
        metadata_enabled: true
      },
      tts: {voice_id: 'male-qn-qingse'},
      asr: {language: 'en-US'}
    }
  })
};\n
fetch(url, options)
  .then(res => res.json())
  .then(json => console.log(json))
  .catch(err => console.error(err));`}</CodeItem>

</CodeGroup>
</MultiCodeBlock>

### Response

- If the returned status code is `200`, the request was successful. The response body contains the result of the request.

- If the returned status code is not `200`, the request failed. The response body includes the error code and description. Refer to status codes to understand the possible reasons for failure.

### Response body

| Parameter   | Type |  Description   |
|:--------|:---------|:--------------|
| `agent_id`    | string   | Unique id of the agent instance. |
| `create_ts`   | integer  | Timestamp of when the agent was created|
| `state` | string   | Current status    |

**Sample response**

```json
{
  "agent_id": "Unique id of the agent instance.",
  "create_ts": null,
  "state": "Current status."
}
```