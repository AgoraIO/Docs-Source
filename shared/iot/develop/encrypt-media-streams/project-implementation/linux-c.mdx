<PlatformWrapper platform="linux-c">

1. Follow all required steps of project implementation of [<Vg k="GET_STARTED"/>](../get-started/get-started-sdk/#implement-audio-and-video-communication) <Vpd k="NAME"/> project that you can reuse in your own project to integrate <Vpd k="SDK"/>. 

1.  **Add variables to hold the encryption mode, encryption key and salt**

    Open the file `<extracted-folder>/agora_rtsa_sdk/example/hello_rtsa/hello_rtsa.c` in a code editor and add the following declation in `mian()` after `char params[512];`:

    ```c
    const char * encryptionMode = "<encryption mode, depending on your choice of an encryption method>";
    const char * encryptionKey = "<32-byte key generated through OpenSSL>";
    const char * encryptionSaltBase64 = "<Base64-encoded, salt generated through OpenSSL>";
    ```
1. **Enable encryption**

    To enable encryption, you set `enable_aut_encryption` to `true` for `rtc_channel_options_t channel_options;`. Add the following line in `mian()` after `channel_options.auto_subscribe_video = true`:

    ```c
    channel_options.enable_aut_encryption = true;
    ```
1. **Set encryption parameters**

    You specify the media stream encryption method and the related parameters in JSON format by calling `agora_rtc_set_params` method. Depending on your choice of an encryption method, you need to set any one of the below parameters:

    
    1. **SM4-128-ECB** encryption

        ```c
        // SM4-128-ECB encryption parameter
        "{\"rtc.encryption\": {\"enable\": true,\"mode\":\"SM4-128-ECB\", \"master_key\": \"<encryptin key>\"}}"
        ```

    1. **AES-128-GCM** encryption

        ```c
        // AES-128-GCM encryption parameter
        "{\"rtc.encryption\": {\"enable\": true, \"mode\": \"AES-128-GCM\", \"master_key\": \"<encryptin key>\"}}"
        ```
        To set parameter for any one of the above encryption methods, set the `encryptionMode` variables as per your choice of encryption and paste below code before calling of `agora_rtc_join_channel` function in `main()`: 

        ```c
        // set encryption parameters
        memset(params, '\0', sizeof(params));
        snprintf(params, sizeof(params), "{\"rtc.encryption\": {\"enable\": true,\"mode\": \"%s\", \"master_key\": \"%s\" }}", encryptionMode, encryptionKey);
        rval = agora_rtc_set_params(params);
        if (rval != 0) {
            LOGE("set encryption key failed, reason: %s", agora_rtc_err_2_str(rval));
            return -1;
        }


    1. **AES-128-GCM2** encryption

        ```c
        // AES-128-GCM2 encryption parameter
        "{\"rtc.encryption\": {\"enable\": true, \"mode\": \"AES-128-GCM2\", \"master_key\": \"<encryptin key>\", \"salt\": \"<encryptionSaltBase64>\", \"salt_type\": \"BASE64\"}}"
        ```

        To set `AES-128-GCM2` encryption method parameters, set the `encryptionMode` variables as **"AES-128-GCM2"** and paste below code before calling of `agora_rtc_join_channel` function in `main()`: 

        ```c
        // set encryption parameters
        memset(params, '\0', sizeof(params));
        snprintf(params, sizeof(params), "{\"rtc.encryption\": {\"enable\": true,\"mode\": \"%s\", \"master_key\": \"%s\", \"salt_type\": \"BASE64\"}}" }}", encryptionMode, encryptionKey, encryptionSaltBase64);
        rval = agora_rtc_set_params(params);
        if (rval != 0) {
            LOGE("set encryption key failed, reason: %s", agora_rtc_err_2_str(rval));
            return -1;
        }

1. **Disable encryption**

    To disable encryption, use the following code:

    ```c
    // Disable built-in encryption
    agora_rtc_set_params("{\"rtc.encryption\": {\"enable\": false}}");
    ```
    
</PlatformWrapper>