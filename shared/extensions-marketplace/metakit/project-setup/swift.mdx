Before using the MetaKit plugin, follow these steps to configure your project.

### Add MetaKit Plugin Dependencies

Follow these steps to obtain and integrate the MetaKit plugin:

1. Go to the [Download](./resources) page, download, and extract the MetaKit iOS plugin.

2. Open the folder and copy the files from the `/SDK` path to the corresponding project path.

    | Library                              | Integration Path   |
    |:------------------------------------|:-------------------|
    | `AgoraMetaKitExtension.xcframework` | `/SDKExtension`    |
    | `AgoraMetaKit.xcframework`          | `/SDKExtension`    |

    <Admonition type="caution" title="Note">
    Agora provides plugin support in the XCFramework format for the `arm64` architecture but not for the `armv7` architecture.
    </Admonition>

3. Open your project in Xcode and [add the required dynamic libraries](https://help.apple.com/xcode/mac/current/#/dev51a648b07), ensuring that the **Embed** attribute of the added dynamic libraries is set to **Embed & Sign**.

    ![Dynamic libraries](/images/extensions-marketplace/metakit-extension-ios-step2.png)
    
### Configure MetaKit Resources

1. Open the MetaKit iOS plugin folder. The `/assets` path contains Bundle file resources needed for different scenes and functionalities. The table below lists the resource names, purposes, and sizes:

    | Resource     | Requirement | Description                                                                                                               | Size     |
    |--------------|-------------|---------------------------------------------------------------------------------------------------------------------------|----------|
    | `SceneBase`  | Required    | Basic scene resources. All functional modules are built on these resources, which include support for hot updates.         | 2.5 MB   |
    | `Avatar`     | Optional    | Virtual human model resources, including the virtual human figures `girl` and `huamulan`. Supports face capture, face pinching, and costume changing capabilities. | <ul><li>`girl`: 17.4 MB</li><li>`huamulan`: 3.1 MB (no face pinching or costume changing support)</li></ul> |
    | `Animoji`    | Optional    | Animoji model resources, including the Animoji figures `dog`, `girlhead`, and `arkit`. Supports face capture capabilities. | <ul><li>`dog`: 1.5 MB</li><li>`girlhead`: 4 MB</li><li>`arkit`: 44 KB</li></ul> |
    | `AREffect`   | Optional    | Lighting effects and 360 background resources, including 3D lighting, ambient lights, advertising lights, screen ripples, aurora effects, and portrait edge flames. | 4.9 MB   |


2. Combine the basic resources (`SceneBase`) and the sub-package resources of specific functional modules (`Avatar`, `AvatarHeadMask`, and `AREffect`) into a single resource package to experience the corresponding functional modules. The functional modules and their corresponding resource package combinations are shown in the table below:

    | Functional Module | Resource Package Combination         |
    |-------------------|---------------------------------------|
    | Virtual Human     | `SceneBase` and `Avatar`              |
    | Animoji           | `SceneBase` and `AvatarHeadMask`      |
    | Lighting Effects  | `SceneBase` and `AREffect`            |
    | 360 Background    | `SceneBase` and `AREffect`            |


    For example, to experience the Virtual Human and 360 Background, combine the `SceneBase`, `Avatar`, and `AREffect` into a single resource directory (as shown in the image below). Once the resource directory is prepared, place it in the iOS sandbox. When [loading scene resources](#load-scene-resources), set the absolute path of this resource directory to MetaKit.

    ![Functional modules](/images/extensions-marketplace/metakit-extension-ios-step3.png)

### Add iOS Device Permissions

Open the project's `Info.plist` file and edit the property list to add the microphone and camera permissions required for the MetaKit plugin.

| Permission                               | Description                                                                              |
|------------------------------------------|------------------------------------------------------------------------------------------|
| `Privacy - Microphone Usage Description` | Required for audio functions.                                                            |
| `Privacy - Camera Usage Description`     | Needed for features like facial animation and background segmentation for AI inference.  |

