import Authorization from '@docs/shared/common/channel-management-api/authorization.mdx';
import CodeBlock from '@theme/CodeBlock';
import MultiCodeBlock, { CodeGroup, CodeItem } from '@app/mdx-components/MultiCodeBlock';
import RestAPILayout from '@site/src/components/rest-api/RestAPILayout';
import LeftColumn from '@site/src/components/rest-api/LeftColumn';
import RightColumn, { Section } from '@site/src/components/rest-api/RightColumn';
import ParameterList, { Parameter } from '@site/src/components/rest-api/ParameterList';
import PathParameter from '@site/src/components/rest-api/PathParameter';
import { Tabs, TabItem } from '@site/src/components/rest-api/Tabs';


<RestAPILayout>


<LeftColumn
  title="Query channel list"
  method="GET"
  endpoint="https://api.agora.io/dev/v1/channel/{appid}"
>

This method gets the list of all channels under a specified project.

For details on how the API works, see the [Reference](#reference) section.

### Request 

#### Path parameters

Pass the following path parameters in the request URL:

  <PathParameter name="appid" type="string" required={true}>
    The App ID of the project. You can get it through one of the following methods:
    <ul>
      <li>Copy from the <Link to="{{Global.AGORA_CONSOLE_URL}}"><Vg k="CONSOLE" /></Link></li>
      <li> Call the [Get all projects](../../agora-console-rest-api#get-all-projects) API, and read the value of the `vendor_key` field in the response body.</li>
    </ul>
  </PathParameter>
  <PathParameter name="page_no" type="number" required={false}>
    The page number that you want to query. The default value is 0, which represents the first page.The value of <code>page_no</code> cannot exceed <code>(total number of channels / page_size - 1)</code>; otherwise, the specified page does not contain any channel.
  </PathParameter>
  <PathParameter name="page_size" type="number" required={false}>
    The number of channels on a page. The value range is [1,500], and the default value is 100.
  </PathParameter>

#### Request header

<Authorization/>

### Response

If the status code is `200`, the request succeeds, and the response body includes the following parameters:

<ParameterList title="OK">
  <Parameter name="success" type="boolean" required={true}>
    The state of this request:
    <ul>
      <li>``true``: Success.</li>
      <li>``false``: Reserved for future use.</li>
    </ul>
  </Parameter>

  <Parameter name="data" type="object" required={true}>
    Channel statistics, including the following fields:
    <Parameter name="channels" type="array" required={true}>
      The list of channels. This array contains multiple objects, where each object represents a channel and includes the following fields:
      <Parameter name="channel_name" type="string" required={true}>
        The channel name.
      </Parameter>
      <Parameter name="user_count" type="number" required={true}>
        The total number of users in the channel.
      </Parameter>
      **Note**: If the specified page does not contain any channel, this field is empty.
    </Parameter>

    <Parameter name="total_size" type="number" required={true}>
      The total number of channels under the specified project.
    </Parameter>
  </Parameter>
</ParameterList>


If the status code is not `200`, the request fails. See the `message` field in the response body for the reason for this failure. For details about possible response status codes, see [Response status codes](../../response-status-code).


## Reference

This API gets the channel list by page. In the request URL, you can specify the page number and the number of channels shown on the page. A successful request returns the channel list of the specified page according to the set `page_size`.

<Admonition type="info" title="Note">If the number of users in a channel changes frequently, the query results may be inaccurate. The following situations may occur: <ul><li>A channel appears repeatedly in different pages.</li><li>A channel does not appear in any page.</li></ul></Admonition>

</LeftColumn>
<RightColumn>
<Section title="Authorization">
The endpoint requires [RESTful authentication](/video-calling/channel-management-api/restful-authentication).
</Section>
<Section title="Request example">

  <Tabs groupId="code-examples">
    <TabItem value="curl" label="curl" default>
    ```bash
    curl --request GET \
      --url http://api.sd-rtn.com/dev/v1/channel/appid \
      --header 'Accept: application/json' \
      --header 'Authorization: '
    ```
    </TabItem>
    <TabItem value="python" label="Python" default>
    ```python
    import http.client

    conn = http.client.HTTPConnection("api.sd-rtn.com")

    headers = {
        'Authorization': "",
        'Accept': "application/json"
    }

    conn.request("GET", "/dev/v1/channel/appid", headers=headers)

    res = conn.getresponse()
    data = res.read()

    print(data.decode("utf-8"))
    ```
    </TabItem>
    <TabItem value="node" label="Node.js" default>
    ```js
    const url = 'http://api.sd-rtn.com/dev/v1/channel/appid';
    const options = {method: 'GET', headers: {Authorization: '', Accept: 'application/json'}};

    try {
      const response = await fetch(url, options);
      const data = await response.json();
      console.log(data);
    } catch (error) {
      console.error(error);
    }
    ```
    </TabItem>
  </Tabs>
</Section>

<Section title="Response example">
```json
{
  "success": true,
  "data": {
    "channels": [
      {
        "channel_name": "lkj144",
        "user_count": 3
      }
    ],
    "total_size": 1
  }
}
```
</Section>
</RightColumn>

</RestAPILayout>
