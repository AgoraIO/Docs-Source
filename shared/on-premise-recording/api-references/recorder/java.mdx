This class manages media in a channel.

## AgoraMediaRtcRecorder

| API | Description |
|---|---|
| [`AgoraMediaRtcRecorder`](#agoramediartcrecorder) | Creates an instance of `AgoraMediaRtcRecorder`. |
| [`initialize`](#initialize-1) | Initializes the recorder instance with service and whether to enable composite mode. |
| [`joinChannel`](#joinchannel) | Joins an Agora RTC channel. |
| [`leaveChannel`](#leavechannel) | Leaves the current channel. |
| [`enableEncryption`](#enableencryption) | Enables or disables built-in encryption. |
| [`subscribeAllAudio`](#subscribeallaudio) | Subscribes to audio streams from all remote users. |
| [`subscribeAllVideo`](#subscribeallvideo) | Subscribes to video streams from all remote users. |
| [`unsubscribeAllAudio`](#unsubscribeallaudio) | Unsubscribes from audio streams of all remote users. |
| [`unsubscribeAllVideo`](#unsubscribeallvideo) | Unsubscribes from video streams of all remote users. |
| [`subscribeAudio`](#subscribeaudio) | Subscribes to the audio stream of a specific remote user. |
| [`unsubscribeAudio`](#unsubscribeaudio) | Unsubscribes from the audio stream of a specific remote user. |
| [`subscribeVideo`](#subscribevideo) | Subscribes to the video stream of a specific remote user. |
| [`unsubscribeVideo`](#unsubscribevideo) | Unsubscribes from the video stream of a specific remote user. |
| [`setAudioVolumeIndicationParameters`](#setaudiovolumeindicationparameters) | Sets the interval for the `onAudioVolumeIndication` callback. |
| [`setVideoMixingLayout`](#setvideomixinglayout) | Configures the video mixing layout. |
| [`setRecorderConfig`](#setrecorderconfig) | Sets the configuration for the recorder instance. |
| [`setRecorderConfigByUid`](#setrecorderconfigbyuid) | Sets the recorder configuration for a specific user. |
| [`startRecording`](#startrecording) | Starts recording. |
| [`stopRecording`](#stoprecording) | Stops recording. |
| [`startSingleRecordingByUid`](#startsinglerecordingbyuid) | Starts recording for a specific user. |
| [`stopSingleRecordingByUid`](#stopsinglerecordingbyuid) | Stops recording for a specific user. |
| [`registerRecorderEventHandler`](#registerrecordereventhandler) | Registers an event handler for recording events. |
| [`unregisterRecorderEventHandler`](#unregisterrecordereventhandler) | Unregisters a previously registered event handler. |
| [`enableAndUpdateVideoWatermarks`](#enableandupdatevideowatermarks) | Adds a watermark to the video stream. |
| [`disableVideoWatermarks`](#disablevideowatermarks) | Removes watermarks from the video stream. |
| [`enableAndUpdateVideoWatermarksByUid`](#enableandupdatevideowatermarksbyuid) | Adds a watermark to the video stream of a specific user. |
| [`disableVideoWatermarksByUid`](#disablevideowatermarksbyuid) | Disables watermarks for a specific user’s video stream. |
| [`renewToken`](#renewtoken) | Renews the Token for the current session. |
| [`release`](#release-2) | Releases native resources associated with the recorder instance. |

### `AgoraMediaRtcRecorder`

Creates an instance of `AgoraMediaRtcRecorder`.

```java
public AgoraMediaRtcRecorder(long handle)
```

#### Parameters

| Parameter | Type   | Description                             |
| --------- | ------ | --------------------------------------- |
| `handle`  | `long` | Native handle of the recorder instance. |


<a id="initialize-1"></a>  
### `initialize`

Initializes the recorder instance and sets the service and whether to enable composite mode.

```java
public int initialize(AgoraService service, boolean enableMix)
```

#### Parameters

| Parameter   | Type           | Description                                                                                                                  |
| ----------- | -------------- | ---------------------------------------------------------------------------------------------------------------------------- |
| `service`   | `AgoraService` | Agora service instance. Must be initialized before calling this method. See [`AgoraService`](#agoraservice).                  |
| `enableMix` | `boolean`      | Whether to enable composite recording:- `true`: (default) Enable composite recording.- `false`: Enable individual recording. |

#### Returns

* `0`: Success
* `< 0`: Failure

### `joinChannel`

Joins an Agora RTC channel.

```java
public int joinChannel(String token, String channelName, String userId)
```

#### Parameters

| Parameter     | Type     | Description                                                            |
| ------------- | -------- | ---------------------------------------------------------------------- |
| `token`       | `String` | Token used for authentication.                                         |
| `channelName` | `String` | Name of the channel to join. Max 64 bytes. Allowed characters include: <br/> - a-z, A-Z, 0-9 <br/> - Spaces <br/> - Special characters: `! # $ % & ( ) + - : ; < = . > ? @ [ ] ^ _ { } | ~ ,` |
| `userId` | `String` | Local user ID. If set to null, the system assigns one automatically. |

#### Returns

* `0`: Success
* `< 0`: Failure

### `leaveChannel`

Leaves the current channel.

```java
public int leaveChannel()
```

#### Returns

* `0`: Success
* `< 0`: Failure

### `enableEncryption`

Enables or disables built-in encryption. Call this before joining a channel. All users in the channel must use the same encryption mode and key.

```java
public int enableEncryption(boolean enabled, EncryptionConfig config)
```

#### Parameters

| Parameter | Type               | Description                                                                  |
| --------- | ------------------ | ---------------------------------------------------------------------------- |
| `enabled` | `boolean`          | Whether to enable encryption:- `true`: Enable- `false`: (default) Disable    |
| `config`  | `EncryptionConfig` | Encryption configuration. See [`EncryptionConfig`](#encryptionconfig). |

#### Returns

* `0`: Success
* `< 0`: Failure

### `subscribeAllAudio`

Subscribes to audio streams from all remote users. Automatically subscribes to users who join later.

```java
public int subscribeAllAudio()
```

#### Returns

* `0`: Success
* `< 0`: Failure

### `subscribeAllVideo`

Subscribes to video streams from all remote users. Automatically subscribes to new users.

```java
public int subscribeAllVideo(VideoSubscriptionOptions options)
```

#### Parameters

| Parameter | Type                       | Description                                                        |
| --------- | -------------------------- | ------------------------------------------------------------------ |
| `options` | `VideoSubscriptionOptions` | See [`VideoSubscriptionOptions`](#videosubscriptionoptions). |

#### Returns

* `0`: Success
* `< 0`: Failure

### `unsubscribeAllAudio`

Stops subscribing to audio from all users. Auto-unsubscribes from new users unless explicitly subscribed again.

```java
public int unsubscribeAllAudio()
```

#### Returns

* `0`: Success
* `< 0`: Failure

### `unsubscribeAllVideo`

Stops subscribing to video from all users.

```java
public int unsubscribeAllVideo()
```

#### Returns

* `0`: Success
* `< 0`: Failure

### `subscribeAudio`

Subscribes to a specific user's audio stream.

```java
public int subscribeAudio(String userId)
```

#### Parameters

| Parameter | Type     | Description                    |
| --------- | -------- | ------------------------------ |
| `userId`  | `String` | Remote user's ID to subscribe. |

#### Returns

* `0`: Success
* `< 0`: Failure
  - `-2`: Invalid `userId`

### `unsubscribeAudio`

Stops subscribing to a specific user's audio stream.

```java
public int unsubscribeAudio(String userId)
```

#### Parameters

| Parameter | Type     | Description                      |
| --------- | -------- | -------------------------------- |
| `userId`  | `String` | Remote user's ID to unsubscribe. |

#### Returns

* `0`: Success
* `< 0`: Failure
    - `-2`: Invalid `userId` 

### `subscribeVideo`

Subscribes to a specific user's video stream.

```java
public int subscribeVideo(String userId, VideoSubscriptionOptions options)
```

#### Parameters

| Parameter | Type                       | Description                                                                       |
| --------- | -------------------------- | --------------------------------------------------------------------------------- |
| `userId`  | `String`                   | Remote user's ID to subscribe.                                                    |
| `options` | `VideoSubscriptionOptions` | Video options. See [`VideoSubscriptionOptions`](#videosubscriptionoptions). |

#### Returns

* `0`: Success
* `< 0`: Failure
    - `-2`: Invalid `userId` 

### `unsubscribeVideo`

Stops subscribing to a specific user's video stream.

```java
public int unsubscribeVideo(String userId)
```

#### Parameters

| Parameter | Type     | Description                      |
| --------- | -------- | -------------------------------- |
| `userId`  | `String` | Remote user's ID to unsubscribe. |

#### Returns

* `0`: Success
* `< 0`: Failure
  - `-2`: Invalid `userId`

### `setAudioVolumeIndicationParameters`

Sets the interval (ms) for the [`onAudioVolumeIndication`](#onaudiovolumeindication) callback.

```java
public int setAudioVolumeIndicationParameters(int intervalInMs)
```

#### Parameters

| Parameter      | Type  | Description                                                |
| -------------- | ----- | ---------------------------------------------------------- |
| `intervalInMs` | `int` | Interval in ms. Default is 500. ≤10 disables the callback. |

#### Returns

* `0`: Success
* `< 0`: Failure

### `setVideoMixingLayout`

Configures the layout of mixed video streams.

This method sets the position and size of each video stream in the output layout.

```java
public int setVideoMixingLayout(VideoMixingLayout layout)
```

#### Parameters

| Parameter | Type                | Description                                                                                        |
| --------- | ------------------- | -------------------------------------------------------------------------------------------------- |
| `layout`  | `VideoMixingLayout` | The configuration of the video mixing layout. See [`VideoMixingLayout`](#videomixinglayout). |

#### Returns

* `0`: The method call was successful.
* `< 0`: The method call failed.

### `setRecorderConfig`

Sets the configuration for the recorder instance.

```java
public int setRecorderConfig(MediaRecorderConfiguration config)
```

<Admonition type="warn" info="info">
 Call this method **before** starting the recording.
</Admonition>

#### Parameters

| Parameter | Type                         | Description                                                                                                |
| --------- | ---------------------------- | ---------------------------------------------------------------------------------------------------------- |
| `config`  | `MediaRecorderConfiguration` | The configuration for the recorder. See [`MediaRecorderConfiguration`](#mediarecorderconfiguration). |

#### Returns

* `0`: The method call was successful.
* `< 0`: The method call failed.

### `setRecorderConfigByUid`

Sets the recorder configuration for a specific user.

```java
public int setRecorderConfigByUid(MediaRecorderConfiguration config, String userId)
```

#### Parameters

| Parameter | Type                         | Description                                                                                        |
| --------- | ---------------------------- | -------------------------------------------------------------------------------------------------- |
| `config`  | `MediaRecorderConfiguration` | The recorder configuration. See [`MediaRecorderConfiguration`](#mediarecorderconfiguration). |
| `userId`  | `String`                     | The user ID for whom to set the recording configuration.                                           |

#### Returns

* `0`: The method call was successful.
* `< 0`: The method call failed.

### `startRecording`

Starts the recording process.

```java
public int startRecording()
```

<Admonition type="info" info="info">
You must call [`setRecorderConfig`](#setrecorderconfig) before starting the recording.
</Admonition>

#### Returns

* `0`: The method call was successful.
* `< 0`: The method call failed.


### `stopRecording`

Stops the recording process.

This method stops all ongoing recordings and saves the recorded files.


```java
public int stopRecording()
```

#### Returns

* `0`: The method call was successful.
* `< 0`: The method call failed.

### `startSingleRecordingByUid`

Starts recording for the specified user.

```java
public int startSingleRecordingByUid(String userId)
```

#### Parameters

| Parameter | Type     | Description                         |
| --------- | -------- | ----------------------------------- |
| `userId`  | `String` | The user ID to start recording for. |

#### Returns

* `0`: The method call was successful.
* `< 0`: The method call failed.

### `stopSingleRecordingByUid`

Stops recording for the specified user.

```java
public int stopSingleRecordingByUid(String userId)
```

#### Parameters

| Parameter | Type     | Description                        |
| --------- | -------- | ---------------------------------- |
| `userId`  | `String` | The user ID to stop recording for. |

#### Returns

* `0`: The method call was successful.
* `< 0`: The method call failed.


### `registerRecorderEventHandler`

Registers a recorder event handler.

Use this method to register an event handler to receive callbacks about recording-related events, such as state changes, errors, and progress updates.

```java
public int registerRecorderEventHandler(IAgoraMediaRtcRecorderEventHandler handler)
```

#### Parameters

| Parameter | Type                                 | Description                                                                                                    |
| --------- | ------------------------------------ | -------------------------------------------------------------------------------------------------------------- |
| `handler` | `IAgoraMediaRtcRecorderEventHandler` | The event handler to register. See [`IAgoraMediaRtcRecorderEventHandler`](#iagoramediartcrecordereventhandler). |

#### Returns

* `0`: The method call was successful.
* `< 0`: The method call failed.


### `unregisterRecorderEventHandler`

Unregisters a previously registered recorder event handler.

```java
public int unregisterRecorderEventHandler(IAgoraMediaRtcRecorderEventHandler handler)
```

#### Parameters

| Parameter | Type                                 | Description                                                                                                      |
| --------- | ------------------------------------ | ---------------------------------------------------------------------------------------------------------------- |
| `handler` | `IAgoraMediaRtcRecorderEventHandler` | The event handler to unregister. See [`IAgoraMediaRtcRecorderEventHandler`](#iagoramediartcrecordereventhandler). |

#### Returns

* `0`: The method call was successful.
* `< 0`: The method call failed.

### `enableAndUpdateVideoWatermarks`

Adds watermarks to the video stream.

```java
public int enableAndUpdateVideoWatermarks(WatermarkConfig[] watermarkConfigs)
```

#### Parameters

| Parameter          | Type                | Description                                                                   |
| ------------------ | ------------------- | ----------------------------------------------------------------------------- |
| `watermarkConfigs` | `WatermarkConfig[]` | The watermark configuration. See [`WatermarkConfig`](#watermarkconfig). |

#### Returns

* `0`: The method call was successful.
* `< 0`: The method call failed.

### `disableVideoWatermarks`

Disables watermarks in the video stream.

```java
public int disableVideoWatermarks()
```

#### Returns

* `0`: The method call was successful.
* `< 0`: The method call failed.

### `enableAndUpdateVideoWatermarksByUid`

Adds watermarks to the video stream of a specified user.

```java
public int enableAndUpdateVideoWatermarksByUid(WatermarkConfig[] watermarkConfigs, String userId)
```

#### Parameters

| Parameter          | Type                | Description                                                                   |
| ------------------ | ------------------- | ----------------------------------------------------------------------------- |
| `watermarkConfigs` | `WatermarkConfig[]` | The watermark configuration. See [`WatermarkConfig`](#watermarkconfig). |
| `userId`           | `String`            | The ID of the user whose video stream should receive the watermark.           |

#### Returns

* `0`: The method call was successful.
* `< 0`: The method call failed.

### `disableVideoWatermarksByUid`

Disables watermarks on the video stream of the specified user.

```java
public int disableVideoWatermarksByUid(String userId)
```

#### Parameters

| Parameter | Type     | Description                                           |
| --------- | -------- | ----------------------------------------------------- |
| `userId`  | `String` | The ID of the user whose video watermark is disabled. |

#### Returns

* `0`: The method call was successful.
* `< 0`: The method call failed.

### `renewToken`

Renews the token for the current session.

When the [`onError`](#onerror) callback reports error code `ERR_TOKEN_EXPIRED (109)`, or the [`onTokenPrivilegeWillExpire`](#ontokenprivilegewillexpire) or [`onTokenPrivilegeDidExpire`](#ontokenprivilegedidexpire) callbacks are triggered, you must generate a new token on your server and call this method to renew it. Otherwise, the SDK will disconnect from the Agora channel.

```java
public int renewToken(String token)
```

#### Parameters

| Parameter | Type     | Description                             |
| --------- | -------- | --------------------------------------- |
| `token`   | `String` | The new token generated by your server. |

#### Returns

* `0`: The method call was successful.
* `< 0`: The method call failed.

<a id="release-2"></a>

### `release`

Releases the native resources associated with the recorder instance.

```java
public int release()
```

#### Returns

* `0`: The method call was successful.
* `< 0`: The method call failed.

