<PlatformWrapper platform="ios">

Agora provides [agora-live](https://github.com/AgoraIO-Usecase/agora-live) repository, it demonstrates how to integrate Agora RTC for Live streaming scenario.

This article introduces how to quickly set up and run this agora-live project to experience the live streaming effect.

### Prerequisites

Before starting, please ensure that the following prerequisites are met:
* RTC Service Activation
* Git
* CocoaPods
* XCode 12.0 or above
* Valid apple developer account
* An iOS Device with iOS 13.0 version or above

_Please Note: Agora recommends running the project on a real device. Some emulators may have missing features or performance issues._




### Clone Agora-Live Repository

To clone the repository locally, run the following command:

```bash
git clone https://github.com/AgoraIO-Usecase/agora-live.git
```

### Integrate FaceUnity 3rd Party

If you want to test FaceUnity functionalities in Agora-live project,  please download the **Demo** file in the [Extensions Marketplace](https://console.agora.io/marketplace/extension/introduce?serviceName=faceunity-ar-en).

![Extension Marketplace-FaceUnity](/images/solutions/live/faceunity_extension_marketplace_1.png)

Then, Copy the <u>authpack.h</u> file to agora-live project's directory(<u>/agora-live/iOS/FULib/</u>).

![AuthPack](/images/solutions/live/authpack_ios_1.png)
![AuthPack](/images/solutions/live/authpack_ios_2.png)


you can copy the required assets to <u>agora-live</u> project's directory(<u>/agora-live/iOS/FULib/Resources/</u>) according to actual business requirement.



![AuthPack](/images/solutions/live/authpack_ios_3.png)

Make sure above steps are completed before executing `"pod install"` command.



### Configure Agora-Live iOS project

Open XCode tool, and open the <u>Agora-Live</u> iOS project(under the directory <u>/(parent directory)/agora-live/iOS/</u>)

![Agora Live iOS Project](/images/solutions/live/agoralive_ios_project.png)


Before running the Agora-live iOS project, you need to set RTC and _Media Pull(Cloud Player)_ parameters as below 

```swift

//
//  KeyCenter.swift
//  OpenLive
//
//  Created by GongYuhua on 6/25/16.
//  Copyright © 2016 Agora. All rights reserved.
//
 
 
@objcMembers
class KeyCenter: NSObject {
     
    /**
     Agora APP ID.
     Agora assigns App IDs to app developers to identify projects and organizations.
     If you have multiple completely separate apps in your organization, for example built by different teams,
     you should use different App IDs.
     If applications need to communicate with each other, they should use the same App ID.
     In order to get the APP ID, you can open the agora console (https://console.agora.io/) to create a project,
     then the APP ID can be found in the project detail page.
     */
    static let AppId: String = "372d14fb805e449a8c8f9f2df07c3dca"
    /**
     Certificate.
     Agora provides App certificate to generate Token. You can deploy and generate a token on your server,
     or use the console to generate a temporary token.
     In order to get the APP ID, you can open the agora console (https://console.agora.io/) to create a project with the App Certificate enabled,
     then the APP Certificate can be found in the project detail page.
     PS: If the project does not have certificates enabled, leave this field blank.
     声网APP证书
     Agora 提供 App certificate 用以生成 Token。您可以在您的服务器部署并生成，或者使用控制台生成临时的 Token。
     进入声网控制台(https://console.agora.io/)，创建一个带证书鉴权的项目，进入项目配置页，即可看到APP证书。
     注意：如果项目没有开启证书鉴权，这个字段留空。
     */
    static let Certificate: String? = nil
     
    /**
     Token.
     Agora provides Temporary Access Token to join the spatial channel with APP ID which enable App Certificate.
     You can use it to test your project.
     You can generate the temporary access token in the project console with the App Certificate enabled.
     PS：If agora_app_certificate is configured, this field will be invalid.
     音视频临时Token
     Agora 提供 音视频临时Token 用以加入带证书鉴权的频道。您可以使用这个Token来做测试。
     进入控制台开启证书鉴权的项目配置页，在APP证书下方有"生成临时音视频token"的按钮，输入频道名即可生成一个临时token。
     注意：如果配置了agora_app_certificate，则这个字段会失效。
     */
     
    static var Token: String? = nil
    /**
     EaseMob APPKEY.
     The application name filled in when creating an application on the EaseMob  console.
     If you need to use Chat Room, you must to set this parameter.
     Please refer to the information on obtaining instant messaging IM from EaseMob for more information(http://docs-im-beta.easemob.com/product/enable_and_configure_IM.html#%E8%8E%B7%E5%8F%96%E7%8E%AF%E4%BF%A1%E5%8D%B3%E6%97%B6%E9%80%9A%E8%AE%AF-im-%E7%9A%84%E4%BF%A1%E6%81%AF).
     */
    static var IMAppKey: String? = "61904637#1136800"
    /**
     EaseMob Client ID.
     Client id of EaseMob, used to generate app tokens to call REST API.
     If you need to use Chat Room, you must to set this parameter.
     Please refer to the information on obtaining instant messaging IM from EaseMob for more information( https://console.easemob.com/user/login/ ).
     环信Client ID
     环信的 client id，用于生成 app token 调用 REST API。
     如需使用语聊房场景，需要设置该参数。
     详见 环信即时通讯云控制台(https://console.easemob.com/user/login/)的应用详情页面。
     */
     
    static var IMClientId: String? = nil
     
    /**
     EaseMob Client Secret.
     Client Secret of EaseMob, used to generate app tokens to call REST API.
     If you need to use Chat Room, you must to set this parameter.
     Please refer to the information on obtaining instant messaging IM from EaseMob for more information( https://console.easemob.com/user/login/ ).
     环信Client Secret
     App 的 client_secret，用于生成 app token 调用 REST API。
     如需使用语聊房场景，需要设置该参数。
     详见 环信即时通讯云控制台( https://console.easemob.com/user/login/ )的应用详情页面。
     */
    static var IMClientSecret: String? = nil
     
    static let CloudPlayerKey: String? = nil
    static let CloudPlayerSecret: String? = nil
     
    static var HostUrl: String = "https://gateway-fulldemo.agoralab.co"
    static var baseServerUrl: String? = "https://service.agora.io/toolbox-overseas/v1/"
    static var onlineBaseServerUrl: String? = baseServerUrl
     
}

```


After creating an Agora project, you can obtain the values of these parameters from the Agora Console. Here are the details:

| Parameter | Description | How to Obtain |
| :-------- | :---------- | :------------ |
| AGORA_APP_ID | Agora project's App ID | Obtain App ID |
| AGORA_APP_CERTIFICATE | Agora project's App Certificate  | Obtain App Certificate |
| CLOUD_PLAYER_KEY | Customer ID required for Agora's RESTful service to input online media streams | Obtain Customer ID and Secret |
| CLOUD_PLAYER_SECRET | Customer secret required for Agora's RESTful service to input online media streams | Obtain Customer ID and Secret |

To obtain these parameters:
1. AGORA_APP_ID: Log in to the Agora Console, navigate to your project, and find the App ID on the project overview page or in the project settings.

2. AGORA_APP_CERTIFICATE: This is an optional parameter, but if you're using Agora's security features, you can generate an App Certificate from the Agora Console. This usually involves selecting a role and a timestamp expiration policy.

3. CLOUD_PLAYER_KEY and CLOUD_PLAYER_SECRET: These are credentials for authenticating your access to Agora's RESTful services, such as for retrieving media streams. You might need to create a customer account or an API key pair specifically for this purpose. The exact steps to obtain these depend on your Agora service plan and whether you have an existing account for this purpose. Typically, you'll find the customer ID and secret in the Agora Console's API credentials section or in the documentation related to the specific service you're using.

Make sure to keep these credentials secure and never share them publicly.

In the <u>agora-live/iOS</u> directory, run `pod install` command, and wait for installing the dependencies completely.

![Agora Live Pod Install](/images/solutions/live/agoralive_podInstall.png)

### Compile and Build agora-live iOS project

To compile and run the _<u>agora-live</u> iOS_ project, follow these steps:

1. After connecting your iOS device, open the project by clicking on the _AgoraEntScenarios.xcworkspace_ file in Xcode and select your iOS device in the iOS Device options.
2. In the _<u>Signing & Capabilities</u>_ section under the **TARGETS** of your project, check the _<u>"Automatically manage signing"</u>_ box and configure your Apple Developer account and Bundle Identifier. The Bundle ID uniquely identifies the app on the device. When developing an app, you need to set a Bundle ID. The Bundle ID set here should match the one you provided when applying for the FaceUnity SDK.
3. Click the _"Play"_ button (which is usually represented by a triangle icon to start compiling.
4. Once the compilation is successful, the Agora Live app will appear on your iOS device. You will need to trust the developer in your iOS system settings before you can open the app.
5. Open the Agora Live app, click _"Live Streaming"_ to start the experience. As a broadcaster, you can create a room; as a viewer, you can join a room.

![Agora Live iOS Project -1 ](/images/solutions/live/aogralive_ios1.png)
![Agora Live iOS Project -2 ](/images/solutions/live/aogralive_ios2.png)
![Agora Live iOS Project -3 ](/images/solutions/live/aogralive_ios3.png)


### Known Issues

##### iOS App: the first line of pod file may cause hang issue since network limitation

![iOS Known Issue -1](/images/solutions/live/ios_known_issue_1.png)


##### iOS App: command "Pod Install" executed failed since ruby version. it raised error message like "undefined method `exists?' for class File"

![iOS Known Issue -2](/images/solutions/live/ios_known_issue_2.png)

</PlatformWrapper>