import Authorization from '@docs/shared/common/channel-management-api/authorization.mdx';
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import CodeBlock from '@theme/CodeBlock';

When using Agora real-time audio and video, you can use the <Vg k="NCS_LONG" /> service to receive channel events.

After activating the service, when a channel event occurs, the <Vg k="NCS_LONG" /> server will deliver the event notification to your message receiving server.

If your server is behind a firewall, you need to call the IP address query API to retrieve the IP addresses of <Vg k="NCS_LONG" /> and configure your firewall to trust all these IP addresses.

Agora occasionally adjusts the <Vg k="NCS_LONG" /> IP addresses. Best practice is to call this endpoint at least every 24 hours and automatically update the firewall configuration.

### Prototype

* Method: `GET`
* Endpoint: `https://api.agora.io/v2/ncs/ip`

### Request parameters

**Request header**

<Authorization/>

### Request examples

Use one of the following code examples to test this request:

<Tabs groupId="language">
<TabItem value="curl" label="Curl" default>
<CodeBlock language="bash">{`curl --request GET \\
  --url https://api.sd-rtn.com/v2/ncs/ip \\
  --header 'Accept: application/json' \\
  --header 'Authorization: '`}</CodeBlock>
</TabItem>

<TabItem value="node" label="Node.js">
  <CodeBlock language="js">{`const http = require('http');\n
const options = {
  method: 'GET',
  hostname: 'api.sd-rtn.com',
  port: null,
  path: '/v2/ncs/ip',
  headers: {
    Authorization: '',
    Accept: 'application/json'
  }
};\n
const req = http.request(options, function (res) {
  const chunks = [];\n
  res.on('data', function (chunk) {
    chunks.push(chunk);
  });\n
  res.on('end', function () {
    const body = Buffer.concat(chunks);
    console.log(body.toString());
  });
});\n
req.end();`}</CodeBlock>
</TabItem>

<TabItem value="python" label="Python">
  <CodeBlock language="python">{`import http.client\n
conn = http.client.HTTPConnection("api.sd-rtn.com")\n
headers = {
    'Authorization': "",
    'Accept': "application/json"
}\n
conn.request("GET", "/v2/ncs/ip", headers=headers)\n
res = conn.getresponse()
data = res.read()\n
print(data.decode("utf-8"))`}</CodeBlock>
</TabItem>

</Tabs>

### Response parameters

For details about possible response status codes, see [Response status codes](../../response-status-code).

If the status code is not `200`, the request fails. See the `message` field in the response body for the reason for this failure.

If the status code is `200`, the request succeeds, and the response body includes the following parameters:

| Parameter | Type    | Description                                                  |
| :-------- | :------ | :----------------------------------------------------------- |
| `data`    | Object  |  <ul><li>`service`<ul><li>`hosts` <ul><li>`primaryIP`: The IP address of the <Vg k="NCS_LONG" /> server. When you receive a response, you need to add the IP address (or list of IP addresses) from this field to the whitelist.</li></ul></li></ul></li></ul> |

### Response example

<CodeBlock language="json" showLineNumbers>
  {`{
  "data": {
    "service": {
      "hosts": [
        {
          "primaryIP": "xxx.xxx.xxx.xxx"
        },
        {
          "primaryIP": "xxx.xxx.xxx.xxx"
        }
      ]
    }
  }
}`}
</CodeBlock>