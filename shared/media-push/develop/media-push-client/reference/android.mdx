<PlatformWrapper platform="android">

<a name="older-v"></a>
### Implementation of earlier versions

This section describes how to implement Media Push using versions of the SDK earlier than v3.6.0.

1. Refer to [Start Interactive Live Video Streaming](start_live_android) or [Start Interactive Live Audio Streaming](start_live_audio_android) to implement the basic audio and video interaction.

2. The host in a channel calls the `setLiveTranscoding` method to set the transcoding configuration of media streams (`LiveTranscoding`), such as the resolution, bitrate, frame rate, and position of any watermark/background. If you need a transcoded picture, set the picture-in-picture layout for each user in the `TranscodingUser` class.

   <div class="alert note">To push streams without transcoding for single-host live streaming, skip steps 2 and 3, directly call <code>addPublishStreamUrl</code>, and set <code>transcodingEnabled (false)</code>.</div>


3. The host in a channel calls the `addPublishStreamUrl` method to add a media stream to the CDN. The address can be dynamically added or deleted after the stream is pushed.

   <div class="alert note">Use <code>transcodingEnabled</code> to set whether transcoding is enabled or not.</div>


4. (Optional) The host in a channel calls the `setLiveTranscoding` method again to update the transcoding configuration of media streams.

   <div class="alert note">When the transcoding configuration is updated, the SDK triggers the <code>onTranscodingUpdated</code> callback and reports the update information to the host.</div>

5. The host in a channel calls the `removePublishStreamUrl` method to remove a media stream from the Media Push.

When the streaming state changes, the SDK triggers the `onRtmpStreamingStateChanged` callback to report the current streaming state to the host. Make sure to wait until you receive the `onRtmpStreamingStateChanged` callback before performing any other actions. If adding or removing a CDN address fails, see <a href="./cdn_streaming_error">Exception Handling for Media Push</a>.



```java
// Java
// CDN transcoding settings.
LiveTranscoding config = new LiveTranscoding();
config.audioSampleRate = TYPE_44100;
config.audioChannels = 2;
config.audioBitrate = 48;
// Width of the video (px). The default value is 360.
config.width = 360;
// Height of the video (px). The default value is 640.
config.height = 640;
// Video bitrate of the video (Kbps). The default value is 400.
config.videoBitrate = 400;
// Video framerate of the video (fps). The default value is 15. Agora adjusts all values over 30 to 30.
config.videoFramerate = 15;
// If userCount > 1ï¼Œset the layout for each user with transcodingUser.
config.userCount = 1;
// Video codec profile. Choose to set as Baseline (66), Main (77), or High (100). If you set this parameter to other values, Agora adjusts it to the default value 100.
config.videoCodecProfile = HIGH;

// Sets the output layout for each user.
LiveTranscoding transcoding = new LiveTranscoding();
LiveTranscoding.TranscodingUser user = new LiveTranscoding.TranscodingUser();
user.uid = 123456;
transcoding.addUser(user);
user.x = 0;
user.audioChannel = 0;
user.y = 0;
user.width = 640;
user.height = 720;

// CDN transcoding settings when using transcoding.
rtcEngine.setLiveTranscoding(transcoding);

// Adds a URL to which the host pushes a stream. Set the transcodingEnabled parameter as true to enable the transcoding service. Once transcoding is enabled, you need to set the live transcoding configurations by calling the setLiveTranscoding method. Agora does not recommend transcoding in the case of a single host.
rtcEngine.addPublishStreamUrl(url, true);

// Removes a URL to which the host pushes a stream.
rtcEngine.removePublishStreamUrl(url);
```

### API reference

The following APIs are recommended by Agora when implementing Media Push:

- [`startRtmpStreamWithoutTranscoding`](./API%20Reference/java/classio_1_1agora_1_1rtc_1_1_rtc_engine.html#a5fec43179baa58dca1952a5f9b4f237a)
- [`startRtmpStreamWithTranscoding`](./API%20Reference/java/classio_1_1agora_1_1rtc_1_1_rtc_engine.html#a9391d6e809be8e54f01e73527fb88160)
- [`updateRtmpTranscoding`](./API%20Reference/java/classio_1_1agora_1_1rtc_1_1_rtc_engine.html#a917ae58f6c4aaddb45370b6e1dbfa951)
- [`stopRtmpStream`](./API%20Reference/java/classio_1_1agora_1_1rtc_1_1_rtc_engine.html#ab2afb755c25d279a8a6980f4676e59d3)
- [`onTranscodingUpdated`](./API%20Reference/java/classio_1_1agora_1_1rtc_1_1_i_rtc_engine_event_handler.html#afcacc60191697a4105364d1b0c411eb1)
- [`onRtmpStreamingStateChanged`](./API%20Reference/java/classio_1_1agora_1_1rtc_1_1_i_rtc_engine_event_handler.html#a7b9f1a5d87480cfd6187c3da0ade3f94)
- [`onRtmpStreamingEvent`](./API%20Reference/java/classio_1_1agora_1_1rtc_1_1_i_rtc_engine_event_handler.html#a2c26ecc40133c2bb18b30f4752edc61c)

The following APIs are still functional but not recommended by Agora when implementing Media Push:

- [`setLiveTranscoding`](./API%20Reference/java/classio_1_1agora_1_1rtc_1_1_rtc_engine.html#a3cb9804ae71819038022d7575834b88c)
- [`addPublishStreamUrl`](./API%20Reference/java/classio_1_1agora_1_1rtc_1_1_rtc_engine.html#a4445b4ca9509cc4e2966b6d308a8f08f)
- [`removePublishStreamUrl`](./API%20Reference/java/classio_1_1agora_1_1rtc_1_1_rtc_engine.html#a87b3f2f17bce8f4cc42b3ee6312d30d4)
- [`onStreamPublished`](./API%20Reference/java/classio_1_1agora_1_1rtc_1_1_i_rtc_engine_event_handler.html#af18840d18833b66254c71ccfad019056)
- [`onStreamUnpublished`](./API%20Reference/java/classio_1_1agora_1_1rtc_1_1_i_rtc_engine_event_handler.html#a3e6f904f9285e925b32a4588f3e5abbd)

</PlatformWrapper>