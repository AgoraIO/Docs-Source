import * as data from '@site/data/variables';
import Prerequisites from '@docs/shared/common/prerequities.mdx';
import ProjectSetup from '@docs/shared/video-sdk/develop/magic-leap/project-setup/index.mdx';
import ProjectImplement from '@docs/shared/video-sdk/develop/magic-leap/project-implementation/index.mdx';
import ProjectTest from '@docs/shared/video-sdk/develop/magic-leap/project-test/index.mdx';
import Reference from '@docs/shared/video-sdk/develop/magic-leap/reference/index.mdx';

Agora <Vg k = "VSDK"/> for Magic Leap allows you to integrate real-time <Vpd k="PRODUCT" /> features into your [Magic
Leap](https://www.magicleap.com/) app. You can enhance the overall user experience and add new possibilities for collaboration and
interaction within Magic Leap environments.

<PlatformWrapper notAllowed="unity">
**Currently you develop for Magic Leap under Unity only.**
</PlatformWrapper>

<PlatformWrapper platform="unity">

This page shows the minimum code you need to integrate high-quality, low-latency <Vpd k="PRODUCT" /> features into your Magic Leap project using <Vpd k="SDK" />.


## Understand the tech

This section explains how you can integrate <Vpd k="PRODUCT" /> features into your Magic Leap project using <Vpd k="SDK" />. The following figure shows the workflow you need to integrate this feature into your app.

<ProductWrapper product="video-calling">
![Video Calling Web UIKit](/images/video-calling/video-call.png)
</ProductWrapper>

<ProductWrapper product="interactive-live-streaming">
![Video Calling Web UIKit](/images/interactive-live-streaming/get-started-sdk-livestreaming.png)

In an <Vpd k="PRODUCT" /> event, hosts stream a video feed to an audience. For example, when a CEO is giving a speech to the company employees, the CEO does not need to see all members of the audience. To represent this in your app, when you join as a host, the local feed is started and  you see your own video feed. When you join as a member of the audience, you see the host's video feed.
</ProductWrapper>


To start a session, implement the following steps in your app:

<ProductWrapper product="interactive-live-streaming">
- *Set the channel profile and role*: For hosts, set the channel profile to `LIVE_BROADCASTING` and their role to `BROADCASTER`. For audience members, set the role to `AUDIENCE`.
</ProductWrapper>
- *Retrieve a token*: A token is a computer-generated string that authenticates a user when your app joins a channel. In a test or production environment, your app retrieves tokens from a server in your security infrastructure.
- *Join a channel*: Call methods to create and join a channel; apps that pass the same channel name join the same channel.
<ProductWrapper product="interactive-live-streaming">
- *Host publishes local video and audio to the channel*: A live streaming event has one or more hosts. Each host can publish their local video to the channel.
- *Audience subscribes to video and audio published by the hosts to the channel*: Audience members view content published by hosts to the channel.
</ProductWrapper>
<ProductWrapper product="video-calling">
- *Send and receive video and audio in the channel*: All users send and receive video and audio streams from all users in the channel.
</ProductWrapper>

## Prerequisites

In order to follow this procedure, you must have:

<Prerequisites />
* Installed [ML Hub](https://developer-docs.magicleap.cloud/docs/guides/getting-started/install-the-tools)
* Installed [Unity Hub](https://unity.com/download)
* [Install and configure the Unity Editor required to develop for Magic Leap 2](https://developer-docs.magicleap.cloud/docs/guides/unity/getting-started/install-the-tools)
 
## Project setup

To integrate <Vpd k="PRODUCT" /> into your Magic Leap project, do the following:

<ProjectSetup />

You are ready to add <Vpd k="PRODUCT" /> features to your Magic Leap project

## Integrate the <Vpd k="PRODUCT" /> demo

When a user opens the app, you initialize <Vg k="ENGINE" />. When the user taps a button, the app joins or leaves a channel. When another user joins the same channel, their video and audio is rendered in the app. This simple workflow enables you to concentrate on implementing <Vg k="COMPANY"/> features and not UX bells and whistles.

This section shows how to integrate the <Vpd k="SDK" />  to implement the <Vpd k="PRODUCT" />  demo into your Magic
  Leap project.

1. [Download](/sdks) the latest version of <Vpd k="SDK" /> for Magic Leap to a local folder.

1. Double-click the download package.

    The Import dialog opens automatically in Unity Editor.

1. Click **Import**.

    In **Project** > **Assets** you see `Agora-RTC-Plugin` and `Agora_MagicLeap2_Plugin`.

You are ready to test the demo.

## Test your implementation

<Vg k="COMPANY"/> recommends you run this project on a physical mobile device, as some simulators may not support the full features of this project. To ensure that you have implemented <Vpd k="PRODUCT" /> in your app:

1. Obtain an App ID with token enabled.

1. [Generate a temporary token](../reference/manage-agora-account#generate-a-temporary-token) in <Vg k="CONSOLE" />.

1. In your browser, navigate to the <Link target="_blank" to="{{Global.DEMO_BASIC_VIDEO_CALL_URL}}"><Vg k="COMPANY" /> web demo</Link> and update `App ID`, `Channel`, and `Token` with the values for your temporary token, then click **Join**.

1. In Unity Editor, double-click **Agora_MagicLeap2_Plugin** > **AgoraEngine** > **ML2Support** > **Demo**.

    The demo scene opens.

1. In **Project**, open **Agora_MagicLeap2_Plugin** > **AgoraEngine** > **ML2Support** > **Scripts** > **Agora
  Controller**.

1. Update `APP_ID`, `TOKEN`, and `CHANNEL_NAME` with the same values you used for the web demo.

1. Connect an ML2 device, then click **Build and Run**.

    The demo app opens.

1. Click **Connect Camera**.

    Video from your ML2 is streamed to the channel and is visible in the web demo. You see the video stream from the
  web demo.

Now you have tested the demo, best practice is to customize the demo source including the custom audio and video
  handling into your Magic Leap 2 project.

## Reference

This section contains information that completes the information in this page, or points you to documentation that explains other aspects to this product.

- [Manual install](../reference/downloads) shows you how to install <Vpd k="SDK" /> manually.

- To ensure communication security in a test or production environment, best practice is to use a token server to ensure communication security, see [Secure authentication with tokens](../develop/authentication-workflow).

<Reference />

</PlatformWrapper>