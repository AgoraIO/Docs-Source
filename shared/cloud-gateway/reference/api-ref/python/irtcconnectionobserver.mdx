---
title: IRTCConnectionObserver Class
---

<span className="index-group-irtcconnectionobserver" style={{display: 'none'}}>IRTCConnectionObserver</span>

<span className="index-desc-irtcconnectionobserver">`IRTCConnectionObserver` class, used to listen to the connection status of the SDK.</span>


<h2 className="anchor index-group-item-irtcconnectionobserver index-api-onconnected" id="onconnected">on_connected</h2>

```python
def on_connected(self, agora_rtc_conn, conn_info, reason)
```

<span className="index-desc-onconnected">Occurs when the connection state of the SDK changes to `3`.</span>

#### Parameters

export const TableHeader29bhcgh93s = [
  {
    label: 'Parameter'
  },
  {
    label: 'Description'
  }
];

<Table header={TableHeader29bhcgh93s}>
  <Tr>
    <Td>`agora_rtc_conn`</Td>
    <Td>RTC connection object. See [`RtcConnection`](./rtcconnection).</Td>
  </Tr>
  <Tr>
    <Td>`conn_info`</Td>
    <Td>Connection information. See [`RTCConnInfo`](./rtcconnection#rtcconninfo).</Td>
  </Tr>
  <Tr>
    <Td>`reason`</Td>
    <Td>
    Connection state change reason:
    - `0`: Establishing a network connection.
    - `1`: Successfully joined the channel.
    - `2`: Network connection interrupted.
    - `3`: Network connection forbidden by the server.
    - `4`: Failed to join the channel.
    - `5`: Left the channel.
    - `6`: Invalid App ID. Please change to a valid App ID and try again.
    - `7`: Invalid channel name. Please change to a valid channel name and try again.
    - `8`: The generated token is invalid. Generally, the following reasons:
      - App Certificate is enabled on the console, but the Token is not used when joining the channel. When App Certificate is enabled, you must use a Token.
      - The uid specified in [`connect`](./rtcconnection#connect) when joining the channel does not match the uid used when generating the Token.
    - `9`: The generated Token is invalid.
    - `10`: This user is banned by the server.
    - `11`: SDK attempts to reconnect due to setting a proxy server.
    - `12`: The network connection state changes due to updating the Token.
    - `13`: The client IP address changes, possibly due to changes in network type or the IP or port of the network operator.
    - `14`: SDK connection to the server times out, enters the automatic reconnection state.
    - `15`: Rejoined the channel successfully.
    - `16`: SDK and the server lose connection.
    - `17`: The connection state changes due to the echo test.
    - `18`: The user changed the local IP address.
    </Td>
  </Tr>
</Table>



<h2 className="anchor index-group-item-irtcconnectionobserver index-api-ondisconnected" id="ondisconnected">on_disconnected</h2>


```python
def on_disconnected(self, agora_rtc_conn, conn_info, reason)
```

<span className="index-desc-ondisconnected">Occurs when the connection state of the SDK changes to `1`.</span>


#### Parameters

export const TableHeader29bhcgh93a = [
  {
    label: 'Parameter'
  },
  {
    label: 'Description'
  }
];

<Table header={TableHeader29bhcgh93a}>
  <Tr>
    <Td>`agora_rtc_conn`</Td>
    <Td>RTC connection object. See [`RtcConnection`](./rtcconnection).</Td>
  </Tr>
  <Tr>
    <Td>`conn_info`</Td>
    <Td>Connection information. See [`RTCConnInfo`](./rtcconnection#rtcconninfo).</Td>
  </Tr>
  <Tr>
    <Td>`reason`</Td>
    <Td>
    Connection state change reason:
    - `0`: Establishing a network connection.
    - `1`: Successfully joined the channel.
    - `2`: Network connection interrupted.
    - `3`: Network connection forbidden by the server.
    - `4`: Failed to join the channel.
    - `5`: Left the channel.
    - `6`: Invalid App ID. Please change to a valid App ID and try again.
    - `7`: Invalid channel name. Please change to a valid channel name and try again.
    - `8`: The generated token is invalid. Generally, the following reasons:
      - App Certificate is enabled on the console, but the Token is not used when joining the channel. When App Certificate is enabled, you must use a Token.
      - The uid specified in [`connect`](./rtcconnection#connect) when joining the channel does not match the uid used when generating the Token.
    - `9`: The generated token is invalid.
    - `10`: This user is banned by the server.
    - `11`: SDK attempts to reconnect due to setting a proxy server.
    - `12`: The network connection state changes due to updating the Token.
    - `13`: The client IP address changes, possibly due to changes in network type or the IP or port of the network operator.
    - `14`: SDK connection to the server times out, enters the automatic reconnection state.
    - `15`: Rejoined the channel successfully.
    - `16`: SDK and the server lose connection.
    - `17`: The connection state changes due to the echo test.
    - `18`: The user changed the local IP address.
    </Td>
  </Tr>
</Table>

<h2 className="anchor index-group-item-irtcconnectionobserver index-api-ontokenprivilegewillexpire" id="ontokenprivilegewillexpire">on_token_privilege_will_expire</h2>

```python
def on_token_privilege_will_expire(self, agora_rtc_conn, token)
```

<span className="index-desc-ontokenprivilegewillexpire">Occurs when the token will expire in 30 seconds.</span>

In the call process, if the Token is about to expire, the SDK triggers this callback 30 seconds before the Token expires to remind the app to update the Token.

When you receive this callback, you need to generate a new Token on the server side and call [`renew_token`](./rtcconnection#renewtoken) to pass the newly generated Token to the SDK.

#### Parameters

| Parameter | Description |
|---------------|------------|
| `agora_rtc_conn` | RTC connection object. See [`RtcConnection`](./rtcconnection). |
| `token` | The token that is about to expire. |




<h2 className="anchor index-group-item-irtcconnectionobserver index-api-ontokenprivilegedidexpire" id="ontokenprivilegedidexpire">on_token_privilege_did_expire</h2>

```python
def on_token_privilege_did_expire(self, agora_rtc_conn)
```

<span className="index-desc-ontokenprivilegedidexpire">Occurs when the token expires.</span>

In the call process, if the token expires, the SDK triggers this callback to remind the app to update the Token.

When you receive this callback, you need to generate a new Token on the server side and call [`connect`](./rtcconnection#connect) to reconnect the channel.

#### Parameters

| Parameter | Description |
|---------------|------------|
| `agora_rtc_conn` | RTC connection object. See [`RtcConnection`](./rtcconnection). |



<h2 className="anchor index-group-item-irtcconnectionobserver index-api-onuserjoined" id="onuserjoined">on_user_joined</h2>

```python
def on_user_joined(self, agora_rtc_conn, user_id)
```

<span className="index-desc-onuserjoined">Occurs when a remote user joins the channel. You can get the remote user's ID through this callback.</span>

#### Parameters

| Parameter | Description |
|---------------|------------|
| `agora_rtc_conn` | RTC connection object. See [`RtcConnection`](./rtcconnection). |
| `user_id` | The remote user's ID. |




<h2 className="anchor index-group-item-irtcconnectionobserver index-api-onuserleft" id="onuserleft">on_user_left</h2>

```python
def on_user_left(self, agora_rtc_conn, user_id, reason)
```

<span className="index-desc-onuserleft">Occurs when a remote user leaves the channel. You can get the reason for the remote user leaving the channel through the `reason` parameter.</span>

#### Parameters

export const TableHeader7yl3129d05 = [
  {
    label: 'Parameter'
  },
  {
    label: 'Description'
  }
];

<Table header={TableHeader7yl3129d05}>
  <Tr>
    <Td>`agora_rtc_conn`</Td>
    <Td>RTC connection object. See [`RtcConnection`](./rtcconnection).</Td>
  </Tr>
  <Tr>
    <Td>`user_id`</Td>
    <Td>The remote user's ID.</Td>
  </Tr>
  <Tr>
    <Td>`reason`</Td>
    <Td>
    Connection state change reason:
    - `0`: Establishing a network connection.
    - `1`: Successfully joined the channel.
    - `2`: Network connection interrupted.
    - `3`: Network connection forbidden by the server.
    - `4`: Failed to join the channel.
    - `5`: Left the channel.
    - `6`: Not a valid App ID. Please change to a valid App ID and try again.
    - `7`: Not a valid channel name. Please change to a valid channel name and try again.
    - `8`: The generated token is invalid. Generally, the following reasons:
      - App Certificate is enabled on the console, but the Token is not used when joining the channel. When App Certificate is enabled, you must use a Token.
      - The uid specified in [`connect`](./rtcconnection#connect) when joining the channel does not match the uid used when generating the Token.
    - `9`: The generated token is invalid.
    - `10`: This user is banned by the server.
    - `11`: SDK attempts to reconnect due to setting a proxy server.
    - `12`: The network connection state changes due to updating the Token.
    - `13`: The client IP address changes, possibly due to changes in network type or the IP or port of the network operator.
    - `14`: SDK connection to the server times out, enters the automatic reconnection state.
    - `15`: Rejoined the channel successfully.
    - `16`: SDK and the server lose connection.
    - `17`: The connection state changes due to the echo test.
    - `18`: The user changed the local IP address.
    </Td>
  </Tr>
</Table>


<h2 className="anchor index-group-item-irtcconnectionobserver index-api-onstreammessageerror" id="onstreammessageerror">on_stream_message_error</h2>

```python
def on_stream_message_error(self, user_id: str, stream_id: int, code: int, missed: int, cached: int)
```

<span className="index-desc-onstreammessageerror">Occurs when a data stream message error occurs. This callback indicates that the local user has not received the stream message sent by the remote user using the [`send_stream_message`](./rtcconnection#sendstreammessage) method.</span>

#### Parameters

| 参数        | 描述  |
|-------------|----------|
| `user_id`   | The user ID that sends the message.              |
| `stream_id` | The Stream ID of the received message.         |
| `code`      | The error code that occurred.                |
| `missed`    | The number of lost messages.                     |
| `cached`    | The number of messages cached when the data stream is interrupted.          |


<h2 className="anchor index-group-item-irtcconnectionobserver index-api-onerror" id="onerror">on_error</h2>

```python
def on_error(self, agora_rtc_conn, error_code, error_msg)
```

<span className="index-desc-onerror">Occurs when an error occurs. This callback indicates that an error related to the network or media occurred during the SDK runtime. Generally, the error reported by the SDK means that the SDK cannot automatically recover and requires intervention from the App or user prompt.</span>

#### Parameters

| Parameter        | Description  |
|-------------|----------|
| `agora_rtc_conn`   | RTC connection object. See [`RtcConnection`](./rtcconnection).              |
| `error_code` | The error code.         |
| `error_msg`      | The error description.                |