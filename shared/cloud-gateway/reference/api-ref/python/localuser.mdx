---
title: LocalUser Class
---


<span className="index-group-localuser" style={{display: 'none'}}>LocalUser</span>

<span className="index-desc-localuser">The `LocalUser` class. Defines the behavior and state of the local user. Each RTC connection has its own user. You can get the local user through [`get_local_user`](./rtcconnection#getlocaluser). Each user has two roles: the host (can send and receive audio and video streams) and the audience (can only receive audio and video streams). </span>


<h2 className="anchor index-group-item-localuser index-api-setuserrole" id="setuserrole">set_user_role</h2>

```python
def set_user_role(self, role)
```

<span className="index-desc-setuserrole">Sets the user role. You can call this method before or after the user connects to the channel.</span>

<Admonition type="caution" title="注意">
If the `role` set in the `token` parameter of [`Connect`](./rtcconnection#connect) is different from the role set here, the connection will fail.
</Admonition>

#### 参数

export const TableHeaderzh3y881jpn = [
  {
    label: 'Parameter'
  },
  {
    label: 'Description'
  }
];

<Table header={TableHeaderzh3y881jpn}>
  <Tr>
    <Td>`role`</Td>
    <Td>
    User role. See [`ClientRoleType`](./apidatatype#clientroletype).
    </Td>
  </Tr>
</Table>

#### Returns

- `0`: Success.
- < `0`: Failure.

<h2 className="anchor index-group-item-localuser index-api-setaudioencoderconfiguration" id="setaudioencoderconfiguration">set_audio_encoder_configuration</h2>

```python
def set_audio_encoder_configuration(self, config)
```

<span className="index-desc-setaudioencoderconfiguration">Sets the audio encoding. The SDK applies the configuration to all audio tracks sent.</span>

#### Parameters

| Parameter | Description |
|---------------|----------------------------------------------------------------------|
| `config` | Audio encoding configuration. See [`AudioEncoderConfiguration`](./apidatatype#audioencoderconfiguration). |

#### Returns

- `0`: Success.
- < `0`: Failure.

<h2 className="anchor index-group-item-localuser index-api-publishaudio" id="publishaudio">publish_audio</h2>

```python
def publish_audio(self, agora_local_audio_track:LocalAudioTrack)
```

<span className="index-desc-publishaudio">Publishes the local audio track to the channel. By default, all published audio tracks are mixed.</span>

#### Parameters

| Parameter | Description |
|---------------|----------------------------------------------------------------------|
| `agora_local_audio_track` | The local audio track to publish. See [`LocalAudioTrack`](./localaudiotrack). |

#### Returns

- `0`: Success.
- < `0`: Failure.
  - `-5`: If the local user's role is not the host, this error is returned.


<h2 className="anchor index-group-item-localuser index-api-unpublishaudio" id="unpublishaudio">unpublish_audio</h2>

```python
def unpublish_audio(self, agora_local_audio_track:LocalAudioTrack)
```

<span className="index-desc-unpublishaudio">Stops publishing the local audio track to the channel.</span>

#### Parameters

| Parameter | Description |
|---------------|----------------------------------------------------------------------|
| `agora_local_audio_track` | The local audio track to stop publishing. See [`LocalAudioTrack`](./localaudiotrack). |

#### Returns

- `0`: Success.
- < `0`: Failure.


<h2 className="anchor index-group-item-localuser index-api-publishvideo" id="publishvideo">publish_video</h2>

```python
def publish_video(self, agora_local_video_track:LocalVideoTrack)
```

<span className="index-desc-publishvideo">Publishes the local video track to the channel.</span>

#### Parameters

| Parameter | Description |
|---------------|----------------------------------------------------------------------|
| `agora_local_video_track` | The local video track to publish. See [`LocalVideoTrack`](./localvideotrack).  |

#### Returns

- `0`: Success.
- < `0`: Failure.



<h2 className="anchor index-group-item-localuser index-api-unpublishvideo" id="unpublishvideo">unpublish_video</h2>

```python
def unpublish_video(self, agora_local_video_track:LocalVideoTrack)
```

<span className="index-desc-unpublishvideo">Stops publishing the local video track to the channel.</span>

#### Parameters

| Parameter | Description |
|---------------|----------------------------------------------------------------------|
| `agora_local_video_track` | The local video track to stop publishing. See [`LocalVideoTrack`](./localvideotrack). |

#### Returns

- `0`: Success.
- < `0`: Failure.



<h2 className="anchor index-group-item-localuser index-api-subscribeaudio" id="subscribeaudio">subscribe_audio</h2>

```python
def subscribe_audio(self, user_id)
```

<span className="index-desc-subscribeaudio">Subscribes to the audio stream sent by a specific remote user in the channel.</span>

#### Parameters

| Parameter | Description |
|---------------|----------------------------------------------------------------------|
| `user_id` | The remote user ID. |

#### Returns

- `0`: Success.
- < `0`: Failure.
  - `-2`: If the user does not exist or `user_id` is invalid, this error is returned.



<h2 className="anchor index-group-item-localuser index-api-subscribeallaudio" id="subscribeallaudio">subscribe_all_audio</h2>

```python
def subscribe_all_audio(self)
```

<span className="index-desc-subscribeallaudio">Subscribes to all the audio streams sent by remote users in the channel. This method automatically subscribes to the audio streams sent by users who join the channel later.</span>

#### Returns

- `0`: Success.
- < `0`: Failure.



<h2 className="anchor index-group-item-localuser index-api-unsubscribeaudio" id="unsubscribeaudio">unsubscribe_audio</h2>

```python
def unsubscribe_audio(self, user_id)
```

<span className="index-desc-unsubscribeaudio">Stops subscribing to the audio stream sent by a specific remote user in the channel.</span>

#### Parameters

| Parameter | Description |
|---------------|----------------------------------------------------------------------|
| `user_id` | The remote user ID. |

#### Returns

- `0`: Success.
- < `0`: Failure.
  - `-2`: If the user does not exist or `user_id` is invalid, this error is returned.



<h2 className="anchor index-group-item-localuser index-api-unsubscribeallaudio" id="unsubscribeallaudio">unsubscribe_all_audio</h2>

```python
def unsubscribe_all_audio(self)
```

<span className="index-desc-unsubscribeallaudio">Stops subscribing to all the audio streams sent by remote users in the channel. This method automatically cancels the subscription of the audio streams sent by users who join the channel later. You must call [`subscribe_audio`](./apidatatype#subscribeaudio) or [`subscribe_all_audio`](subscribeallaudio) to restore the subscription of audio.</span>

#### Returns

- `0`: Success.
- < `0`: Failure.


<h2 className="anchor index-group-item-localuser index-api-setplaybackaudioframebeforemixingparameters" id="setplaybackaudioframebeforemixingparameters">set_playback_audio_frame_before_mixing_parameters</h2>

```python
def set_playback_audio_frame_before_mixing_parameters(self, channels, sample_rate_hz)
```

<span className="index-desc-setplaybackaudioframebeforemixingparameters">Sets the audio data format reported by [`on_playback_audio_frame_before_mixing`](./iaudioframeobserver#onplaybackaudioframebeforemixing).</span>

#### Parameters

| Parameter | Description |
|---------------|----------------------------------------------------------------------|
| `channels` | The number of audio channels, which can be set to `1` (mono) or `2` (stereo). |
| `sample_rate_hz` | The sample rate of the audio data, which can be set to `8000`, `16000`, `32000`, `44100`, or `48000`. |

#### Returns

- `0`: Success.
- < `0`: Failure.

{/*
<h2 className="anchor index-group-item-localuser index-api-setplaybackaudioframeparameters" id="setplaybackaudioframeparameters">set_playback_audio_frame_parameters</h2>

```python
def set_playback_audio_frame_parameters(self, channels, sample_rate_hz, mode, samples_per_call)
```

<span className="index-desc-setplaybackaudioframeparameters">Sets the audio format for playback. This method sets the format of the data reported by [`on_playback_audio_frame_before_mixing`](./iaudioframeobserver#onplaybackaudioframebeforemixing).</span>

#### Parameters

export const TableHeaderd5zowu0o9j = [
  {
    label: 'Parameter'
  },
  {
    label: 'Description'
  }
];

<Table header={TableHeaderd5zowu0o9j}>
  <Tr>
    <Td>`channels`</Td>
    <Td>
    The number of audio channels:
    - `1`: Mono
    - `2`: Stereo
    </Td>
  </Tr>
  <Tr>
    <Td>`sample_rate_hz`</Td>
    <Td>
    The sample rate of the data returned by [`on_playback_audio_frame_before_mixing`](./iaudioframeobserver#onplaybackaudioframebeforemixing):
    - `8000`
    - `16000`
    - `32000`
    - `44100`
    - `48000`
    </Td>
  </Tr>
  <Tr>
    <Td>`mode`</Td>
    <Td>
    音频帧的使用模式：
    - `0`: Read-only mode, where the user only obtains the original data from `AudioFrame` without any modifications.
    - `2`: Read-write mode, where the user obtains and modifies data from `AudioFrame` and returns it to the SDK for encoding and transmission.
    </Td>
  </Tr>
  <Tr>
    <Td>`samples_per_call`</Td>
    <Td>The number of samples returned by [`on_playback_audio_frame_before_mixing`](./iaudioframeobserver#onplaybackaudioframebeforemixing), such as 1024 in a CDN push application.</Td>
  </Tr>
</Table>

#### 返回值

- `0`: Success.
- < `0`: Failure.

*/}

<h2 className="anchor index-group-item-localuser index-api-registeraudioframeobserver" id="registeraudioframeobserver">register_audio_frame_observer</h2>

```python
def register_audio_frame_observer(self, observer:IAudioFrameObserver)
```

<span className="index-desc-registeraudioframeobserver">Registers the audio frame observer. You must implement the [`IAudioFrameObserver`](./iaudioframeobserver) class and register the callback based on your needs.</span>

#### Parameters

| Parameter | Description |
|---------------|----------------------------------------------------------------------|
| `observer` | [`IAudioFrameObserver`](./iaudioframeobserver) class. |

#### Returns

- `0`: Success.
- < `0`: Failure.




<h2 className="anchor index-group-item-localuser index-api-unregisteraudioframeobserver" id="unregisteraudioframeobserver">unregister_audio_frame_observer</h2>

```python
def unregister_audio_frame_observer(self)
```

<span className="index-desc-unregisteraudioframeobserver">Destroys the [`IAudioFrameObserver`](./iaudioframeobserver) object.</span>

#### Returns

- `0`: Success.
- < `0`: Failure.


<h2 className="anchor index-group-item-localuser index-api-registervideoencodedframeobserver" id="registervideoencodedframeobserver">register_video_encoded_frame_observer</h2>

```python
def register_video_encoded_frame_observer(self, agora_video_encoded_frame_observer:IVideoEncodedFrameObserver)
```

<span className="index-desc-registervideoencodedframeobserver">Registers the encoded video frame observer.</span>

#### Parameters

| Parameter | Description |
|---------------|----------------------------------------------------------------------|
| `agora_video_encoded_frame_observer` | The encoded video frame observer. See [`IVideoEncodedFrameObserver`](./ivideoencodedframeobserver.mdx). |

#### Returns

- `0`: Success.
- < `0`: Failure.

<h2 className="anchor index-group-item-localuser index-api-unregistervideoencodedframeobserver" id="unregistervideoencodedframeobserver">unregister_video_encoded_frame_observer</h2>

```python
def unregister_video_encoded_frame_observer(self)
```

<span className="index-desc-unregistervideoencodedframeobserver">Destroys the encoded video frame observer.</span>

#### Returns

- `0`: Success.
- < `0`: Failure.

<h2 className="anchor index-group-item-localuser index-api-subscribevideo" id="subscribevideo">subscribe_video</h2>

```python
def subscribe_video(self, user_id, options:VideoSubscriptionOptions)
```

<span className="index-desc-subscribevideo">Subscribes to the video stream sent by a specific remote user in the channel.</span>

#### Parameters

| Parameter | Description |
|---------------|----------------------------------------------------------------------|
| `user_id` | The remote user ID. |
| `options` | The subscription options. See [`VideoSubscriptionOptions`](./apidatatype#videosubscriptionoptions). |

#### Returns

- `0`: Success.
- < `0`: Failure.
  - `-2`: If the user does not exist or `user_id` is invalid, this error is returned.

<h2 className="anchor index-group-item-localuser index-api-subscribeallvideo" id="subscribeallvideo">subscribe_all_video</h2>

```python
def subscribe_all_video(self, options:VideoSubscriptionOptions)
```

<span className="index-desc-subscribeallvideo">Subscribes to all the video streams sent by remote users in the channel. This method automatically subscribes to the video streams sent by users who join the channel later.</span>

#### Parameters

| Parameter | Description |
|---------------|----------------------------------------------------------------------|
| `options` | The subscription options. See [`VideoSubscriptionOptions`](./apidatatype#videosubscriptionoptions). |

#### Returns

- `0`: Success.
- < `0`: Failure.

<h2 className="anchor index-group-item-localuser index-api-unsubscribevideo" id="unsubscribevideo">unsubscribe_video</h2>

```python
def unsubscribe_video(self, user_id)
```

<span className="index-desc-unsubscribevideo">Stops subscribing to the video stream sent by a specific remote user in the channel.</span>

#### Parameters

| Parameter | Description |
|---------------|----------------------------------------------------------------------|
| `user_id` | The remote user ID. |

#### Returns

- `0`: Success.
- < `0`: Failure.
  - `-2`: If the user does not exist or `user_id` is invalid, this error is returned.

<h2 className="anchor index-group-item-localuser index-api-unsubscribeallvideo" id="unsubscribeallvideo">unsubscribe_all_video</h2>

```python
def unsubscribe_all_video(self)
```

<span className="index-desc-unsubscribeallvideo">Stops subscribing to all the video streams sent by remote users in the channel. This method automatically cancels the subscription of the video streams sent by users who join the channel later. You must call [`subscribe_video`](./apidatatype#subscribevideo) or [`subscribe_all_video`](./apidatatype#subscribeallvideo) to restore the subscription.</span>

#### Returns

- `0`: Success.
- < `0`: Failure.

<h2 className="anchor index-group-item-localuser index-api-registerlocaluserobserver" id="registerlocaluserobserver">register_local_user_observer</h2>

```python
def register_local_user_observer(self, observer:ILocalUserObserver)
```

<span className="index-desc-registerlocaluserobserver">Registers the local user observer.</span>

#### Parameters

| Parameter | Description |
|---------------|----------------------------------------------------------------------|
| `observer` | [`ILocalUserObserver`](./localuserobserver) class. |

#### Returns

- `0`: Success.
- < `0`: Failure.




<h2 className="anchor index-group-item-localuser index-api-unregisterlocaluserobserver" id="unregisterlocaluserobserver">unregister_local_user_observer</h2>

```python
def unregister_local_user_observer(self)
```

<span className="index-desc-unregisterlocaluserobserver">Destroys the local user observer.</span>

#### Returns

- `0`: Success.
- < `0`: Failure.


<h2 className="anchor index-group-item-localuser index-api-registervideoframeobserver" id="registervideoframeobserver">register_video_frame_observer</h2>

```python
def register_video_frame_observer(self, agora_video_frame_observer2:IVideoFrameObserver)
```

<span className="index-desc-registervideoframeobserver">Registers the [`IVideoFrameObserver`](./ivideoframeobserver) object.</span>

#### Parameters

| Parameter | Description |
|---------------|----------------------------------------------------------------------|
| `agora_video_frame_observer2` | [`IVideoFrameObserver`](./ivideoframeobserver) class. |

#### Returns

- `0`: Success.
- < `0`: Failure.

<h2 className="anchor index-group-item-localuser index-api-unregistervideoframeobserver" id="unregistervideoframeobserver">unregister_video_frame_observer</h2>

```python
def unregister_video_frame_observer(self, agora_video_frame_observer2)
```

<span className="index-desc-unregistervideoframeobserver">Destroys the [`IVideoFrameObserver`](./ivideoframeobserver) object.</span>

#### Returns

- `0`: Success.
- < `0`: Failure.

<h2 className="anchor index-group-item-localuser index-api-getrtcconnection" id="getrtcconnection">get_rtc_connection</h2>

```python
def get_rtc_connection(self)
```

<span className="index-desc-getrtcconnection">Gets the `RtcConnection` object.</span>

#### Returns

- `RtcConnection` object: Success.
- `None`: Failure.

<h2 className="anchor index-group-item-localuser index-api-release" id="release">release</h2>

```python
def release(self)
```

<span className="index-desc-release">Releases all resources of the `LocalUser` object.</span>