---
title: RtcConnectionObserver Class
---

<span className="index-group-irtcconnectionobserver" style={{display: 'none'}}>RtcConnectionObserver</span>

<span className="index-desc-irtcconnectionobserver">`RtcConnectionObserver` Class, which is used to monitor the SDK connection state.ã€‚</span>

<h2 className="anchor index-group-item-irtcconnectionobserver index-api-onconnected" id="onconnected">OnConnected</h2>

```go
OnConnected func(con *RtcConnection, conInfo *RtcConnectionInfo, reason int)
```

<span className="index-desc-onconnected">Triggered when the SDK's connection state to the channel changes to `3`.</span>


#### Parameters

export const TableHeader29bhcgh93s = [
  {
    label: 'Parameter'
  },
  {
    label: 'Description'
  }
];

<Table header={TableHeader29bhcgh93s}>
  <Tr>
    <Td>`con`</Td>
    <Td>RTC connection object. See [`RtcConnection`](./rtcconnection) for details.</Td>
  </Tr>
  <Tr>
    <Td>`conInfo`</Td>
    <Td>Connection information. See [`RtcConnectionInfo`](./rtcconnection#RtcConnectionInfo) for details.</Td>
  </Tr>
  <Tr>
    <Td>`reason`</Td>
    <Td>
    Reason for connection state change:
    - `0`: Establishing network connection.
    - `1`: Successfully joined the channel.
    - `2`: Network connection interrupted.
    - `3`: Network connection prohibited by the server.
    - `4`: Failed to join the channel.
    - `5`: Left the channel.
    - `6`: Invalid APP ID. Please use a valid APP ID to rejoin the channel.
    - `7`: Invalid channel name. Please use a valid channel name to rejoin the channel.
    - `8`: Generated Token is invalid. Possible reasons include:
      - App Certificate is enabled on the console, but Token is not used to join the channel. When App Certificate is enabled, Token must be used.
      - The `uid` specified when calling [`Connect`](./rtcconnection#connect) to join the channel does not match the `uid` passed when generating the Token.
    - `9`: Generated Token is invalid.
    - `10`: This user is prohibited by the server.
    - `11`: SDK attempts to reconnect due to proxy server settings.
    - `12`: Network connection state changed due to Token update.
    - `13`: Client IP address changed, possibly due to network type or IP/port change by the network operator.
    - `14`: SDK and server connection keep-alive timeout, entering automatic reconnection state.
    - `15`: Rejoined the channel successfully.
    - `16`: SDK lost connection with the server.
    - `17`: Connection state change caused by echo test.
    - `18`: User changed the local IP address.
    </Td>
  </Tr>
</Table>


<h2 className="anchor index-group-item-irtcconnectionobserver index-api-ondisconnected" id="ondisconnected">OnDisconnected</h2>

```go
OnDisconnected func(con *RtcConnection, conInfo *RtcConnectionInfo, reason int)
```

<span className="index-desc-ondisconnected">Triggered when the SDK's connection state to the channel changes to `1`.</span>

#### Parameters

export const TableHeader29bhcgh93a = [
  {
    label: 'Parameter'
  },
  {
    label: 'Description'
  }
];

<Table header={TableHeader29bhcgh93a}>
  <Tr>
    <Td>`con`</Td>
    <Td>RTC connection object. See [`RtcConnection`](./rtcconnection) for details.</Td>
  </Tr>
  <Tr>
    <Td>`conInfo`</Td>
    <Td>Connection information. See [`RtcConnectionInfo`](./rtcconnection#RtcConnectionInfo) for details.</Td>
  </Tr>
  <Tr>
    <Td>`reason`</Td>
    <Td>
    Reason for connection state change:
    - `0`: Establishing network connection.
    - `1`: Successfully joined the channel.
    - `2`: Network connection interrupted.
    - `3`: Network connection prohibited by the server.
    - `4`: Failed to join the channel.
    - `5`: Left the channel.
    - `6`: Invalid APP ID. Please use a valid APP ID to rejoin the channel.
    - `7`: Invalid channel name. Please use a valid channel name to rejoin the channel.
    - `8`: Generated Token is invalid. Possible reasons include:
      - App Certificate is enabled on the console, but Token is not used to join the channel. When App Certificate is enabled, Token must be used.
      - The `uid` specified when calling [`Connect`](./rtcconnection#connect) to join the channel does not match the `uid` passed when generating the Token.
    - `9`: Generated Token is invalid.
    - `10`: This user is prohibited by the server.
    - `11`: SDK attempts to reconnect due to proxy server settings.
    - `12`: Network connection state changed due to Token update.
    - `13`: Client IP address changed, possibly due to network type or IP/port change by the network operator.
    - `14`: SDK and server connection keep-alive timeout, entering automatic reconnection state.
    - `15`: Rejoined the channel successfully.
    - `16`: SDK lost connection with the server.
    - `17`: Connection state change caused by echo test.
    - `18`: User changed the local IP address.
    </Td>
  </Tr>
</Table>


<h2 className="anchor index-group-item-irtcconnectionobserver index-api-ontokenprivilegewillexpire" id="ontokenprivilegewillexpire">OnTokenPrivilegeWillExpire</h2>

```go
OnTokenPrivilegeWillExpire func(con *RtcConnection, token string)
```

<span className="index-desc-ontokenprivilegewillexpire">Triggered when the token is about to expire within 30 seconds.</span>

During a call, if the token is about to expire, the SDK will trigger this callback 30 seconds in advance to remind the app to update the token.

Upon receiving this callback, you need to generate a new token on your server and then call [`RenewToken`](./rtcconnection#renewtoken) to pass the newly generated token to the SDK.

#### Parameters

| Parameter | Description |
|---------------|------------|
| `con` | RTC connection object. See [`RtcConnection`](./rtcconnection) for details. |
| `token` | The token that is about to expire. |


<h2 className="anchor index-group-item-irtcconnectionobserver index-api-ontokenprivilegedidexpire" id="ontokenprivilegedidexpire">OnTokenPrivilegeDidExpire</h2>

```go
OnTokenPrivilegeDidExpire func(con *RtcConnection)
```

<span className="index-desc-ontokenprivilegedidexpire">Triggered when the token has expired.</span>

During a call, if the token has expired, the SDK will trigger this callback to remind the app to update the token.

Upon receiving this callback, you need to generate a new token on your server and then call [`Connect`](./rtcconnection#connect) to reconnect to the channel.

#### Parameters

| Parameter | Description |
|---------------|------------|
| `con` | RTC connection object. See [`RtcConnection`](./rtcconnection) for details. |


<h2 className="anchor index-group-item-irtcconnectionobserver index-api-onuserjoined" id="onuserjoined">OnUserJoined</h2>

```go
OnUserJoined func(con *RtcConnection, uid string)
```

<span className="index-desc-onuserjoined">Triggered when a remote user joins the channel. You can use this callback to get the ID of the remote user.</span>

#### Parameters

| Parameter | Description |
|---------------|------------|
| `con` | RTC connection object. See [`RtcConnection`](./rtcconnection) for details. |
| `uid` | User ID of the remote user. |


<h2 className="anchor index-group-item-irtcconnectionobserver index-api-onuserleft" id="onuserleft">OnUserLeft</h2>

```go
OnUserLeft func(con *RtcConnection, uid string, reason int)
```

<span className="index-desc-onuserleft">Triggered when a remote user leaves the channel. You can use the `reason` parameter to get the reason why the user left the channel.</span>

#### Parameters

export const TableHeader7yl3129d05 = [
  {
    label: 'Parameter'
  },
  {
    label: 'Description'
  }
];

<Table header={TableHeader7yl3129d05}>
  <Tr>
    <Td>`con`</Td>
    <Td>RTC connection object. See [`RtcConnection`](./rtcconnection) for details.</Td>
  </Tr>
  <Tr>
    <Td>`uid`</Td>
    <Td>User ID of the remote user.</Td>
  </Tr>
  <Tr>
    <Td>`reason`</Td>
    <Td>
    Reason for the connection state change:
    - `0`: Establishing network connection.
    - `1`: Successfully joined the channel.
    - `2`: Network connection interrupted.
    - `3`: Network connection banned by the server.
    - `4`: Failed to join the channel.
    - `5`: Left the channel.
    - `6`: Invalid APP ID. Please use a valid APP ID to rejoin the channel.
    - `7`: Invalid channel name. Please use a valid channel name to rejoin the channel.
    - `8`: The generated Token is invalid. Possible reasons include:
      - App Certificate is enabled in the console, but Token is not used to join the channel. When App Certificate is enabled, Token must be used.
      - The `uid` specified when calling [`Connect`](./rtcconnection#connect) to join the channel does not match the `uid` passed when generating the Token.
    - `9`: The generated Token is invalid.
    - `10`: This user is banned by the server.
    - `11`: SDK attempts to reconnect due to a proxy server setting.
    - `12`: Network connection state changed due to Token update.
    - `13`: Client IP address changed, possibly due to network type or IP/port change by the network operator.
    - `14`: SDK and server connection keep-alive timeout, entering auto-reconnect state.
    - `15`: Successfully rejoined the channel.
    - `16`: SDK lost connection with the server.
    - `17`: Connection state change caused by echo test.
    - `18`: User changed the local IP address.
    </Td>
  </Tr>
</Table>


<h2 className="anchor index-group-item-irtcconnectionobserver index-api-onstreammessageerror" id="onstreammessageerror">OnStreamMessageError</h2>

```go
OnStreamMessageError func(con *RtcConnection, uid string, streamId int, errCode int, missed int, cached int)
```

<span className="index-desc-onstreammessageerror">Triggered when an error occurs in receiving stream messages. This callback indicates that the local user did not receive the stream message sent by the remote user using the [`send_stream_message`](./rtcconnection#sendstreammessage) method.</span>

#### Parameters

| Parameter   | Description  |
|-------------|----------|
| `con` | RTC connection object. See [`RtcConnection`](./rtcconnection) for details. |
| `uid`   | User ID of the sender.              |
| `streamId` | Stream ID of the received message.         |
| `errCode`      | Error code of the occurred error.                |
| `missed`    | Number of missed messages.                     |
| `cached`    | Number of cached messages when the stream was interrupted.          |



<h2 className="anchor index-group-item-irtcconnectionobserver index-api-onerror" id="onerror">OnError</h2>

```go
OnError func(con *RtcConnection, err int, msg string)
```

<span className="index-desc-onerror">Triggered when an error occurs. This callback method indicates that a network or media-related error occurred while the SDK was running. Generally, errors reported by the SDK mean that the SDK cannot automatically recover and requires intervention from the app or user notification.</span>

#### Parameters

| Parameter   | Description  |
|-------------|----------|
| `con`   | RTC connection object. See [`RtcConnection`](./rtcconnection) for details.              |
| `err` | Error code.         |
| `msg`      | Error description.                |
