
<PlatformWrapper platform="android">

### Use a token

The client requests a token from your authentication server corresponding to the user ID and the channel name. You use the received token to join a channel.

```java
// Channel name
String channelId = "xxx";
// User ID
int uid = 0;
// Request a token from the server corresponding to channelId and uid
String token = getToken(channelId, uid);
// Set channel media options
ChannelMediaOptions option = new ChannelMediaOptions();
option.clientRoleType = Constants.CLIENT_ROLE_BROADCASTER;
// Join a channel
engine.joinChannel(token, channelId, 0, option);
```

### Token expiration 

After you join a channel using a token, the SDK triggers an `onTokenPrivilegeWillExpire` callback, 30 seconds before the token is set to expire.

When the token expires, the SDK triggers an `onRequestToken` callback. After receiving the callback, you regenerate a new token on the server side, and then update the token in one of the following ways:

#### Single channel scenario

* Call `renewToken` to pass in the newly generated Token (Recommended).

* Call `updateChannelMediaOptions` to update the token.

* Call `leaveChannel` [2/2] to leave the current channel, and then pass in a new token when calling `joinChannel` [2/2] to rejoin the channel.

#### Multi-channel scenario

If you call `joinChannelEx` to join multiple channels, call the `updateChannelMediaOptionsEx` method to update the token.

The following sample code shows calling `renewToken` to update the token when receiving an `onTokenPrivilegeWillExpire` callback notification.

```java
class RtcEngineEventHandlerImpl extends IRtcEngineEventHandler {
    // Callback is triggered when the token is about to expire
    @Override
    public void onTokenPrivilegeWillExpire(String token) {
        super.onTokenPrivilegeWillExpire(token);

        // Request to generate a fresh token
        String token = getToken();
        // Update token
        engine.renewToken(token);
    }
}
```

</PlatformWrapper>
