<PlatformWrapper platform="windows">

Before joining a channel, set up multi-resolution video streaming by calling the `setSimulcastConfig` method and configuring the `simulcastConfig` parameters.

```cpp
virtual int setSimulcastConfig(const SimulcastConfig& simulcastConfig) = 0;
```

The following snippet shows how `SimulcastConfig` and related classes are defined in the SDK:

```cpp
struct SimulcastConfig {
  // Define extended stream layers
  enum StreamLayerIndex {
    STREAM_LAYER_1 = 0,
    STREAM_LAYER_2 = 1,
    STREAM_LAYER_3 = 2,
    STREAM_LAYER_4 = 3,
    STREAM_LAYER_5 = 4,
    STREAM_LAYER_6 = 5,
    STREAM_LOW = 6,
    STREAM_LAYER_COUNT_MAX = 7
  };

  // Configure video properties for each extended stream
  struct StreamLayerConfig {
    // Resolution
    VideoDimensions dimensions; 
    // Frame rate
    int framerate;
    // Whether this layer is enabled
    bool enable; 
    StreamLayerConfig() : dimensions(0, 0), framerate(0), enable(false) {}
  };

  // Parameter configuration for each extended stream
  StreamLayerConfig configs[STREAM_LAYER_COUNT_MAX];

  // Whether to allow disabling multiple streams dynamically
  // when the sender's performance or uplink network is poor
  bool publish_fallback_enable; 

  SimulcastConfig(): publish_fallback_enable(false) {}
};
```

### Configure parameters

When configuring extended streams, follow these rules:

- Configure the resolution and frame rate of each stream before joining a channel. After joining, you cannot change resolution or frame rate; you can only enable or disable streams using `StreamLayerConfig.enable`.

- Set the resolution and frame rate of each configuration lower than the source stream, defined in `VideoEncoderConfiguration`.

- Decrease the resolution and frame rate for each additional layer.  For example, `STREAM_LAYER_2` must have a lower resolution and frame rate than `STREAM_LAYER_1`, and so on.

- Enable up to three configurations at the same time, including the small stream.

### Sample code

Set the resolution and frame rate of configurations based on your use case and bandwidth. <Vg k="COMPANY" /> recommends configuring only the `StreamLayerConfig` layers you need and setting the others to `enable = false`. The following sample shows how to configure a multi-resolution video stream: 

```cpp
#include "IAgoraRtcEngine.h"
#include "AgoraBase.h"

using namespace agora::rtc;

// Create simulcast configuration
SimulcastConfig config;

// Configure low layer (for low-resolution stream if needed)
config.configs[SimulcastConfig::STREAM_LOW].dimensions.width = 320;
config.configs[SimulcastConfig::STREAM_LOW].dimensions.height = 180;
config.configs[SimulcastConfig::STREAM_LOW].framerate = 15;
config.configs[SimulcastConfig::STREAM_LOW].enable = true;

// Configure high layer (for high-resolution stream if needed)
config.configs[SimulcastConfig::STREAM_LAYER_1].dimensions.width = 1280;
config.configs[SimulcastConfig::STREAM_LAYER_1].dimensions.height = 720;
config.configs[SimulcastConfig::STREAM_LAYER_1].framerate = 30;
config.configs[SimulcastConfig::STREAM_LAYER_1].enable = true;

// Optional: enable on-demand streaming and performance fallback
// Default is false, meaning multiple streams are not automatically disabled
// when performance or uplink network is poor
config.publish_fallback_enable = false;

// Set simulcast configuration
int ret = rtcEngine->setSimulcastConfig(config);
if (ret != 0) {
    // Error handling
}
```

### Subscribe to a stream

A remote user subscribes to the desired video quality level by setting the `streamType` parameter in `setRemoteVideoStreamType`. 

```cpp
// Subscribe to the high-resolution stream
rtcEngine->setRemoteVideoStreamType(remoteUid, VIDEO_STREAM_HIGH);

// Subscribe to video quality layer 1
rtcEngine->setRemoteVideoStreamType(remoteUid, VIDEO_STREAM_LAYER_1);

// Subscribe to the low-resolution stream
rtcEngine->setRemoteVideoStreamType(remoteUid, VIDEO_STREAM_LOW);
```

To update the subscribed video quality level during real-time interaction, you can call `setRemoteVideoStreamType` multiple times.

</PlatformWrapper>
