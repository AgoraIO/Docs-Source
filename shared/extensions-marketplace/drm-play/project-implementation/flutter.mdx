<PlatformWrapper platform="flutter">

### Implement a user interface

In this example, you add two simple buttons to search and play DRM music. To create these buttons, add the following lines to `/app/res/layout/activity_main.xml` before `</RelativeLayout>`:

```dart
ElevatedButton(
    child: Text("Search Music"),
    onPressed: () => {searchMusic()},
),
ElevatedButton(
    child: Text("Play Music"),
    onPressed: () => {playMusic()},
),
```
### Implement DRM content center

To play DRM protected content in your <Vpl k="CLIENT" />:

1. **Declare the variables you need**

    To instantiate `IAgoraMusicContentCenter`, play music, and handle its events, add the following declarations to the `MainActivity` class:

    ```dart
    late final MusicContentCenter _musicContentCenter;
    late final MusicPlayer _musicPlayer;
    late final MediaPlayerSourceObserver _mediaPlayerSourceObserver;
    //bool _initRtmToken = false;
    bool _isPlaying = false;

    List<MusicChartInfo> _musicChartInfos = [];
    MusicCollection? _musicCollection;
    String _currentRequestId = '';
    late Music _selectedMusic;
    MusicCollection? _searchedMusicCollection;
    String _searchMusicRequestId = '';
    String _musicCollectionRequestId = '';
    String _getLyricRequestId = '';

    String rtmToken="0069d2498880e934632b38b0a68fa2f1622IAD9VHNuXnRNdJS/zKGp5aJ2kMijUtj64REWxQv3uNpg1dJjSIgAAAAAEADWgcRD0NeJYwEA6APQ14lj";
    String musicCenterAppId = "<your music center app Id>";
    ```

1. **Set up the music content center**

    1. To configure your `IAgoraMusicContentCenter` you define a `MusicContentCenterConfiguration` instance and pass it to the `initialize` method. To receive preloading and search results, define an `IMusicContentCenterEventHandler` instance and attach it to the music content center. Add the following `setupMusicContentCenter` method to the `MainActivity` class:

        ```dart
        public void setupMusicContentCenter(){
            agoraEngine.loadExtensionProvider("agora_drm_loader_extension");
            musicContentCenter = IAgoraMusicContentCenter.create(agoraEngine);

            contentCenterEventHandler = new IMusicContentCenterEventHandler() {
                @Override
                public void onPreLoadEvent(long songCode, int percent, int status, String msg, String lyricUrl) {
                    showMessage("Song preloaded");
                }

                @Override
                public void onMusicCollectionResult(String requestId, int status, int page, int pageSize, int total, Music[] list) {
                    showMessage("Music collection load result: " + status);
                }

                @Override
                public void onMusicChartsResult(String requestId, int status, MusicChartInfo[] list) {
                    showMessage("Music chart items count: " + list.length);
                    if (list.length > 0) {
                        showMessage(list[0].getName());
                    }
                }

                @Override
                public void onLyricResult(String requestId, String lyricUrl) {
                    showMessage("Lyrics: " + lyricUrl);
                }
            };

            // Configure and initialize the music content center
            MusicContentCenterConfiguration contentCenterConfiguration = new MusicContentCenterConfiguration();
            contentCenterConfiguration.appId = appId;
            contentCenterConfiguration.mccUid = mccUid;
            contentCenterConfiguration.rtmToken = rtmToken;
            contentCenterConfiguration.eventHandler = contentCenterEventHandler;

            // Initialize the music content center
            musicContentCenter.initialize(contentCenterConfiguration);
        }
        ```

    1. To execute this method at startup, add the following line to `setupVideoSDKEngine` after `agoraEngine.enableVideo();`:

        ```dart
        setupMusicContentCenter();
        ```

1. **Find music from the content center**

    <Vg k="RTEE_DRM" /> provides multiple methods to find the music you wish to play. You can search music by keywords or retrieve music charts. To use these methods, add the following code to the `MainActivity` class:

    ```dart
    public void searchMusic(View view){
        // Search Music
        //In a production app, you retrieve the string to search for from your UI.
        musicContentCenter.searchMusic("hello",0,10);

        // Retrieve music charts
        musicContentCenter.getMusicCharts();
    }
    ```

1. **Play music**

    To create a music player and play the selected song, add the following method to the `MainActivity` class:

    ```dart
    public void playMusic(View view){
        long songCode = 0; // The id of the media file to play

        // Preload the song
        // In a production app, your user chooses a result from a call to  searchMusic
        // You use the song code for the selected item to preload and play music.
        musicContentCenter.preload(songCode, null);
        
        // Create music player
        agoraMusicPlayer = musicContentCenter.createMusicPlayer();

        // Open the song to play
        agoraMusicPlayer.open(songCode, 0);
    }
    ```


</PlatformWrapper>