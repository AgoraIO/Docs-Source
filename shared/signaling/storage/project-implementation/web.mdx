<PlatformWrapper platform="web">

The <Vpd k="SDK" /> `storage` sample project implements the <Vpd k="NAME" /> storage logic in the `SignalingManagerStorage` module defined in `<samples-root>/src/storage/signaling_manager_storage.js`. This module encapsulates the `SignalingManagerAuthentication` module from the [Secure authentication](../get-started/authentication-workflow) project, and adds storage functionality such as reading, writing, and updating metadata.

The following code examples show how to implement storage logic in your <Vpd k="NAME" /> <Vpl k="CLIENT" />:

1. **Set local user metadata**

    To set metadata for the local user, you call `setUserMetadata`: 

    ```javascript
    const setUserMetadata = async function (uid, key, value) {
        // Define a data array to hold key-value pairs
        const data = [
            {
                key: key,
                value: value,
                revision: -1, // test
            },
        ];

    const options = {
      userId: uid,
      majorRevision: -1,
      addTimeStamp: true,
      addUserId: true,
    };

        try {
        await signalingManager.getSignalingEngine().storage.setUserMetadata(data, options);
            messageCallback(`User metadata key ${key} saved`);
        } catch (status) {
           console.log(status);
        }
    };
    ```

1. **Update local user metadata**

    To update a key-value pair in the local user's metadata, call `createMetadataItem` and `updateLocalUserMetadata`. 

    ```javascript
    const updateLocalUserMetadata = async function (key, value) {
        const metadataItem  = signalingManager.signalingEngine.createMetadataItem();
        metadataItem.setKey(key);
        metadataItem.setValue(value);

        try {
            await signalingManager.signalingEngine.updateLocalUserMetadata([metadataItem]);
        } catch (status) {
            if (status) {
                const { code, message } = status;
                messageCallback("Error:" + code + ": " + message);
            }
        }
    };
    ```

1. **Receive notification when a user's metadata is updated**

    To get notified of changes in a user's metadata,, handle the `onUserMetadataUpdated` callback:

    ```javascript
    const handleMetadataEvents = async function () {
        signalingManager.signalingEngine.on("UserMetaDataUpdated", function (uid, rtmMetadata) {
            if (typeof rtmMetadata !== "undefined") {
                const eventArgs = { uid: uid, rtmMetadata: rtmMetadata }
                eventsCallback("UserMetaDataUpdated", eventArgs)
            }
        });   
    }
    ```

</PlatformWrapper>