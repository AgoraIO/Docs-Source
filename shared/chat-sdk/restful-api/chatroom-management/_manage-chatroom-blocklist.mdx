import * as data from '@site/data/variables';
import CommonParameter from '@docs/shared/chat-sdk/restful-api/shared/common-parameters.mdx';
import Authorization from '@docs/shared/chat-sdk/restful-api/shared/authorization.mdx';

A chat room block list refers to a list of users that can neither see nor receive chat room messages. Agora Chat provides a complete set of block list management methods, including adding users to the block list and removing them from it, as well as retrieving the members on the block list.

This page shows how to manage a chat room block list by calling the Agora Chat RESTful APIs. Before calling the following methods, ensure that you understand the call frequency limit described in [Limitations](./agora_chat_limitation?platform=RESTful).

## Common parameters <a name="param"></a>

<CommonParameter />

## Authorization

<Authorization />

## Retrieving the chat room block list

Retrieves the block list of the specified chat room.

For each App Key, the call frequency limit of this method is 100 per second.

### HTTP request

```http
GET https://{host}/{org_name}/{app_name}/chatrooms/{chatroom_id}/blocks/users
```

#### Path parameter

For the parameters and detailed descriptions, see [Common parameters](#param).

#### Request header

| Parameter            | Type   | Required | Description                                                         |
| :-------------- | :----- | :------- | :----------------------------------------------------------- |
| `Content-Type`  | String | Yes     | `application/json`                                 |
| `Authorization` | String | Yes    | The authentication token of the user or administrator, in the format of `Bearer ${token}`, where `Bearer` is a fixed character, followed by an English space, and then the obtained token value. |

### HTTP response

#### Response body

If the returned HTTP status code is `200`, the request succeeds, and the `data` field in the response body contains the usernames in the chat room block list.

If the returned HTTP status code is not `200`, the request fails. You can refer to [Status code](./agora_chat_status_code?platform=RESTful) for possible causes.

### Example

#### Request example

```
curl -X GET -H 'Accept: application/json' -H 'Authorization: Bearer YWMt7CoyjusbEeixOi3iod4eDAAAAAAAAAAAAAAAAAAAAAGL4CTw6XgR6LaXXVmNX4QCAgMAAAFnJlhJIwBPGgCqtjiyVnR209iyr8kNbhJhhanNQDdP9CMmpK2G-NIUOQ' 'http://XXXX/XXXX/XXXX/chatrooms/XXXX/blocks/users'
```

#### Response example

```
{
  "action": "get",
  "application": "8be024f0-XXXX-XXXX-b697-5d598d5f8402",
  "uri": "http://XXXX/XXXX/XXXX/chatrooms/XXXX/blocks/users",
  "entities": [],
  "data": [
    "user2",
    "user3"
  ],
  "timestamp": 1543466293681,
  "duration": 0,
  "organization": "XXXX",
  "applicationName": "XXXX",
  "count": 2
}
```

## Adding a user to the chat room block list

Adds the specified user to the chat room block list. Once added to the chat room block list, users receive a notification stating "You are kicked out of the chatroom {chatroom_id}" and can no longer join the chat room. They can neither send nor receive messages in the chat room.

You cannot add the chat room owner to the chat room block list.

For each App Key, the call frequency limit of this method is 100 per second.

### HTTP request

```http
POST https://{host}/{org_name}/{app_name}/chatrooms/{chatroom_id}/blocks/users/{username}
```

#### Path parameter

For the parameters and detailed descriptions, see [Common parameters](#param).

#### Request header

| Parameter            | Type   | Required | Description                                                         |
| :-------------- | :----- | :------- | :----------------------------------------------------------- |
| `Content-Type`  | String | Yes     | `application/json`                                 |
| `Authorization` | String | Yes    | The authentication token of the user or administrator, in the format of `Bearer ${token}`, where `Bearer` is a fixed character, followed by an English space, and then the obtained token value. |

### HTTP response

#### Response body

If the returned HTTP status code is `200`, the request succeeds, and the data field in the response body contains the following parameters.

| Parameter      | Type | Description                                                         |
| :-------- | :----- | :----------------------------------------------------------- |
| `result`  | Boolean | Whether the user is successfully added to the chat room block list. <li>`true`: Yes. </li><li>`false`: No.</li> |
| `user`    | String | The username added to the chat room block list.                                   |

For the parameters and detailed descriptions, see [Common parameters](#param).

If the returned HTTP status code is not `200`, the request fails. You can refer to [Status code](./agora_chat_status_code?platform=RESTful) for possible causes.

### Example

#### Request example

```
curl -X POST -H 'Content-Type: application/json' -H 'Accept: application/json' -H 'Authorization: Bearer YWMt7CoyjusbEeixOi3iod4eDAAAAAAAAAAAAAAAAAAAAAGL4CTw6XgR6LaXXVmNX4QCAgMAAAFnJlhJIwBPGgCqtjiyVnR209iyr8kNbhJhhanNQDdP9CMmpK2G-NIUOQ' 'http://XXXX/XXXX/XXXX/chatrooms/XXXX/blocks/users/user1'
```

#### Response example

```
{
  "action": "post",
  "application": "8be024f0-XXXX-XXXX-b697-5d598d5f8402",
  "uri": "http://XXXX/XXXX/XXXX/chatrooms/XXXX/blocks/users/user1",
  "entities": [],
  "data": {
    "result": true,
    "action": "add_blocks",
    "user": "user1",
    "chatroomid": "XXXX"
  },
  "timestamp": 1542539577124,
  "duration": 27,
  "organization": "XXXX",
  "applicationName": "XXXX"
}
```


## Adding multiple users to the chat room block list

Adds multiple users to the chat room block list. Once added to the chat room block list, users receive a notification stating "You are kicked out of the chatroom {chatroom_id}" and can no longer join the chat room. They can neither send nor receive messages in the chat room.

You can add a maximum of 60 users to the chat room block list at one time. You cannot add the chat room owner to the chat room block list.

For each App Key, the call frequency limit of this method is 100 per second.

### HTTP request

```http
POST https://{host}/{org_name}/{app_name}/chatrooms/{chatroom_id}/blocks/users
```

#### Path parameter

For the parameters and detailed descriptions, see [Common parameters](#param).                                          |

#### Request header

| Parameter            | Type   | Required | Description                                                         |
| :-------------- | :----- | :------- | :----------------------------------------------------------- |
| `Content-Type`  | String | Yes     | `application/json`                                 |
| `Authorization` | String | Yes    | The authentication token of the user or administrator, in the format of `Bearer ${token}`, where `Bearer` is a fixed character, followed by an English space, and then the obtained token value. |

#### Request body

| Parameter        | Type  | Description              |
| :---------- | :---- | :---------------- |
| `usernames` | Array | The array of usernames to be added to the chat room block list. You can specify a maximum of 60 usernames, separated by commas (,). |

### HTTP response

#### Response body

If the returned HTTP status code is `200`, the request succeeds, and the data field in the response body contains the following parameters.

| Parameter      | Type    | Description                                                         |
| :-------- | :------ | :----------------------------------------------------------- |
| `result`  | Boolean | Whether the users are successfully added to the chat room block list.<li>`true`: Yes. </li><li>`false`: No.</li> |
| `reason`  | String  | The reason why the users fail to be added to the chat room block list.                                       |
| `user`    | String  | The usernames added to the chat room block list.                                     |

For the parameters and detailed descriptions, see [Common parameters](#param).

If the returned HTTP status code is not `200`, the request fails. You can refer to [Status code](./agora_chat_status_code?platform=RESTful) for possible causes.

### Example

#### Request example

```
curl -X POST -H 'Content-Type: application/json' -H 'Accept: application/json' -H 'Authorization: Bearer YWMt7CoyjusbEeixOi3iod4eDAAAAAAAAAAAAAAAAAAAAAGL4CTw6XgR6LaXXVmNX4QCAgMAAAFnJlhJIwBPGgCqtjiyVnR209iyr8kNbhJhhanNQDdP9CMmpK2G-NIUOQ' -d '{  
   "usernames": [  
     "user3","user4"  
   ]  
 }' 'http://XXXX/XXXX/XXXX/chatrooms/XXXX/blocks/users'
```

#### Response example

```
{
  "action": "post",
  "application": "8be024f0-XXXX-XXXX-b697-5d598d5f8402",
  "uri": "http://XXXX/XXXX/XXXX/chatrooms/XXXX/blocks/users",
  "entities": [],
  "data": [
    {
      "result": false,
      "action": "add_blocks",
      "reason": "user: user3 doesn't exist in chatroom: XXXX",
      "user": "user3",
      "chatroomid": "XXXX"
    },
    {
      "result": true,
      "action": "add_blocks",
      "user": "user4",
      "chatroomid": "XXXX"
    }
  ],
  "timestamp": 1542540095540,
  "duration": 16,
  "organization": "XXXX",
  "applicationName": "XXXX"
}
```

## Removing a user from the chat room block list

Removes the specified user from the chat room block list. To add a user that is in the block list back to the chat room, you need to remove that user from the block list first.

For each App Key, the call frequency limit of this method is 100 per second.

### HTTP request

```http
DELETE https://{host}/{org_name}/{app_name}/chatrooms/{chatroom_id}/blocks/users/{username}
```

#### Path parameter

For the parameters and detailed descriptions, see [Common parameters](#param).

#### Request header

| Parameter            | Type   | Required | Description                                                         |
| :-------------- | :----- | :------- | :----------------------------------------------------------- |
| `Content-Type`  | String | Yes     | `application/json`                                 |
| `Authorization` | String | Yes    | The authentication token of the user or administrator, in the format of `Bearer ${token}`, where `Bearer` is a fixed character, followed by an English space, and then the obtained token value. |

### HTTP response

#### Response body

If the returned HTTP status code is `200`, the request succeeds, and the data field in the response body contains the following parameters.

| Parameter      | Type    | Description                                                         |
| :-------- | :------ | :----------------------------------------------------------- |
| `result`  | Boolean | Whether the user is successfully removed from the chat room block list.<li>`true`: Yes.</li><li>`false`: No.</li> |
| `user`    | String  | The username removed from the chat room block list.                                     |

For the parameters and detailed descriptions, see [Common parameters](#param).

If the returned HTTP status code is not `200`, the request fails. You can refer to [Status code](./agora_chat_status_code?platform=RESTful) for possible causes.

### Example

#### Request example

```
curl -X DELETE -H 'Accept: application/json' -H 'Authorization: Bearer YWMt7CoyjusbEeixOi3iod4eDAAAAAAAAAAAAAAAAAAAAAGL4CTw6XgR6LaXXVmNX4QCAgMAAAFnJlhJIwBPGgCqtjiyVnR209iyr8kNbhJhhanNQDdP9CMmpK2G-NIUOQ' 'http://XXXX/XXXX/XXXX/chatrooms/XXXX/blocks/users/user1'
```

#### Response example

```
{
  "action": "delete",
  "application": "8be024f0-XXXX-XXXX-b697-5d598d5f8402",
  "uri": "http://XXXX/XXXX/XXXX/chatrooms/XXXX/blocks/users/user1",
  "entities": [],
  "data": {
    "result": true,
    "action": "remove_blocks",
    "user": "user1",
    "chatroomid": "XXXX"
  },
  "timestamp": 1542540470679,
  "duration": 45,
  "organization": "XXXX",
  "applicationName": "XXXX"
}
```

## Removing multiple users from the chat room block list

Removes the specified users from the chat room block list. To add users that are in the block list back to the chat room, you need to remove these users from the block list first. You can remove a maximum of 60 users from the chat room block list at one time.

For each App Key, the call frequency limit of this method is 100 per second.

### HTTP request

```http
DELETE https://{host}/{org_name}/{app_name}/chatrooms/{chatroom_id}/blocks/users/{usernames}
```

#### Path parameter

For the parameters and detailed descriptions, see [Common parameters](#param).

#### Request header

| Parameter            | Type   | Required | Description                                                         |
| :-------------- | :----- | :------- | :----------------------------------------------------------- |
| `Content-Type`  | String | Yes     | `application/json`                                 |
| `Authorization` | String | Yes    | The authentication token of the user or administrator, in the format of `Bearer ${token}`, where `Bearer` is a fixed character, followed by an English space, and then the obtained token value. |

#### Request body

If the returned HTTP status code is `200`, the request succeeds, and the data field in the response body contains the following parameters.

| Parameter       | Type   | Required | Description                                                         |
| :--------- | :----- | :------- | :----------------------------------------------------------- |
| `username` | String | Yes     | The usernames to be removed from the chat room block list. You can specify a maximum of 60 usernames, separated by commas (,).                                        |


### HTTP response

#### Response body

If the returned HTTP status code is `200`, the request succeeds, and the data field in the response body contains the following parameters.

| Parameter      | Type    | Description                                                         |
| :-------- | :------ | :----------------------------------------------------------- |
| `result`  | Boolean | Whether the users are successfully removed from the chat room block list.<li>`true`: Yes.</li><li>`false`: No.</li> |
| `user`    | String  | The usernames removed from the chat room block list.                            |

For the parameters and detailed descriptions, see [Common parameters](#param).

If the returned HTTP status code is not `200`, the request fails. You can refer to [Status code](./agora_chat_status_code?platform=RESTful) for possible causes.

### Example

#### Request example

```
curl -X DELETE -H 'Accept: application/json' -H 'Authorization: Bearer YWMt7CoyjusbEeixOi3iod4eDAAAAAAAAAAAAAAAAAAAAAGL4CTw6XgR6LaXXVmNX4QCAgMAAAFnJlhJIwBPGgCqtjiyVnR209iyr8kNbhJhhanNQDdP9CMmpK2G-NIUOQ' 'http://XXXX/XXXX/XXXX/chatrooms/XXXX/blocks/users/user1%2Cuser2'
```

#### Response example

```
{
  "action": "delete",
  "application": "8be024f0-XXXX-XXXX-b697-5d598d5f8402",
  "uri": "http://XXXX/XXXX/XXXX/chatrooms/XXXX/blocks/users/user1%2Cuser2",
  "entities": [],
  "data": [
    {
      "result": true,
      "action": "remove_blocks",
      "user": "user1",
      "chatroomid": "XXXX" 
    },
    {
      "result": true,
      "action": "remove_blocks",
      "user": "user2",
      "chatroomid": "XXXX"
    }
  ],
  "timestamp": 1542541014655,
  "duration": 29,
  "organization": "XXXX",
  "applicationName": "XXXX"
}
```

## Status codes

For details, see [HTTP Status Code](./agora_chat_status_code?platform=RESTful).