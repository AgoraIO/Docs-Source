import * as data from '@site/data/variables';
import Prerequisites from '@docs/shared/common/prerequities.mdx';
import CreateRunTokenServer from '@docs/shared/common/_create-run-token-server.mdx';
import ProjectImplement from '@docs/shared/video-sdk/authentication-workflow/project-implementation/index.mdx';
import ProjectTest from '@docs/shared/video-sdk/authentication-workflow/project-test/index.mdx';
import TokenServerSourceStructure from '@docs/shared/common/_token-server-source-request-structure.mdx';
import Reference from '@docs/shared/video-sdk/authentication-workflow/reference/index.mdx';
import ProjectImplementUIKit from '@docs/shared/video-sdk/authentication-workflow/project-implementation-uikit/index.mdx';

Authentication is the act of validating the identity of each user before they access a system. <Vg k="COMPANY" /> uses digital tokens to authenticate users and their privileges before they access <Vg k="AGORA_BACKEND" /> to join a channel. Each token is valid for a limited period and works only for a specific channel. For example, you cannot use a token generated for a channel named `AgoraChannel` to join the `AppTest` channel.

This page shows you how to quickly set up an authentication token server, retrieve a token from the server, and use it to connect securely to a specific <Vpd k="NAME"/> channel. You use this server for development purposes. To see how to develop your own token generator and integrate it into your production IAM system, read [Token generators](/video-calling/develop/integrate-token-generation).

## Understand the tech

An authentication token is a dynamic key that is valid for a maximum of 24 hours. On request, a token server returns an authentication token that is valid to join a specific channel.

When users attempt to connect to an <Vg k="COMPANY" /> channel, your <Vpl k="CLIENT" /> retrieves a token from the token server in your security infrastructure. Your <Vpl k="CLIENT" /> then sends this token to <Vg k="AGORA_BACKEND" /> for authentication. <Vg k="AGORA_BACKEND" /> validates the token and reads the user and project information stored in the token. A token contains the following information:


-   The [App ID](../reference/manage-agora-account#get-the-app-id) of your <Vg k="COMPANY" /> project

-   The [App certificate](../reference/manage-agora-account#get-the-app-certificate) of your <Vg k="COMPANY" /> project

-   The channel name

-   The user ID of the user to be authenticated (optional)

-   The privilege of the user, either as a publisher or a subscriber

-   The Unix timestamp showing when the token will expire

The following figure shows the call flow you need to implement to create step-up-authentication with <Vg k="COMPANY" /> <Vpd k="NAME"/>:

![token authentication flow](/images/video-sdk/authentication-logic.png)

<ProductWrapper notAllowed="cloud-recording">
<ProductWrapper notAllowed="on-premise-recording">

## Prerequisites

To follow this procedure, you must have:

-  Implemented the [<Vg k="GET_STARTED"/>](../get-started/get-started-sdk)
-  Created a [Railway](https://railway.app/) account verified through your github account

    If you want to integrate a token generator directly into your security infrastructure, see [Token generators](/video-calling/develop/integrate-token-generation).

<Prerequisites />

</ProductWrapper>
</ProductWrapper>

## Project setup

To integrate token authentication into your <Vpl k="CLIENT" />, do the following:

<ProductWrapper notAllowed="cloud-recording">
<ProductWrapper notAllowed="on-premise-recording">
<ProductWrapper notAllowed="iot">
1.  Open the project you created in the:
    - [<Vg k="UIK"/> quickstart](../get-started/get-started-uikit)
    -  [SDK quickstart](../get-started/get-started-sdk)
</ProductWrapper>
</ProductWrapper>
</ProductWrapper>
<ProductWrapper product="cloud-recording">
1.  Open the project you wish to implement the authentication workflow to.
</ProductWrapper>
<ProductWrapper product="on-premise-recording">
1.  Open the project you wish to implement the authentication workflow to.
</ProductWrapper>
<ProductWrapper product="iot">
1.  Open the project you created in the [<Vg k="GET_STARTED"/>](../get-started/get-started-sdk).
</ProductWrapper>
2.  Log in to your [Railway](https://railway.app/) account.

## Implement the authentication workflow

In the <Vg k="GET_STARTED"/> project you implemented, the <Vpl k="CLIENT" /> uses an authentication token obtained manually from <Vg k="CONSOLE" /> to join a channel. In a production environment, your <Vpl k="CLIENT" /> retrieves this token from a token server. This section shows you how to:

1.  [Create and run a token server](#create-and-run-a-token-server)

<ProductWrapper notAllowed="on-premise-recording">
2.  [Retrieve and use tokens from a token server](#authentication-using-the-sdk)
</ProductWrapper>

### Create and run a token server

<CreateRunTokenServer/>

<ProductWrapper notAllowed="iot">

<ProjectImplementUIKit />

</ProductWrapper>

<ProductWrapper notAllowed="on-premise-recording">
### Authentication using the SDK

To retrieve tokens from the token server and use them to authenticate your <Vpl k="CLIENT" /> with <Vg k="AGORA_BACKEND" /> using  <Vpd k="SDK" />:

<ProjectImplement />

## Test your implementation

To ensure that you have implemented <Vg k="COMPANY" /> token authentication workflow in your <Vpl k="CLIENT" />:

1.  [Generate a token](../reference/manage-agora-account#generate-a-temporary-token) in <Vg k="CONSOLE" />.

    Users communicate securely using channels in the same project. The *App ID* you use to generate this token must be the same one you supplied to Railway.

2. In your browser, navigate to the <Link target="_blank" to="{{Global.DEMO_BASIC_VIDEO_CALL_URL}}"><Vg k="COMPANY" /> web demo</Link> and update _App ID_, _Channel_, and _Token_ with the values for your temporary token, then click **Join**.

<ProjectTest />

Your <Vpl k="PLATFORM" /> <Vpl k="CLIENT" /> magically connects to the same channel you used in web demo. You don’t need to hardcode a token in your app; each channel is secured with a specific token, and each token is refreshed automatically. That’s pretty cool!

</ProductWrapper>
## Reference

This section contains information that completes the information in this page, or points you to documentation that explains other aspects to this product.

<TokenServerSourceStructure />


<Reference />
