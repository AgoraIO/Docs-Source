<PlatformWrapper platform="flutter">


### Implement the user interface

In a real-word application, you report your local spatial position to a server in your environment and retrieve positions of remote users in the channel from your server. In this simple example, you use a single button to set the spatial position of a remote user. 

To add the button to the UI, in `/lib/main.dart`, add the following code to the `build` method after `ListView(...children: [`:

```dart
ElevatedButton(
    child: const Text("Update remote user position"),
    onPressed: () => {updateRemoteUserPosition()},
),
```

### Implement spatial audio

To implement these features in your <Vpl k="CLIENT" />, take the following steps:

1. **Declare the variables you need**

    You create an instance of `ILocalSpatialAudioEngine` to configure spatial audio and set self and remote user positions. In `/app/java/com.example.<projectname>/MainActivity`, add the following declarations to the `MainActivity` class:

    ```dart
    late LocalSpatialAudioEngine localSpatial;
    ```

1. **Instantiate and configure the spatial audio engine**

    To create an instance of `ILocalSpatialAudioEngine` at startup take the following steps:

    1. When a user launches the <Vpl k="CLIENT" />, you create an instance of `ILocalSpatialAudioEngine`, configure it and update the user's self position. To do this, add the following method to the `MainActivity` class:

        ```dart
        void configureSpatialAudioEngine() async {
            // Enable spatial audio
            await agoraEngine.enableSpatialAudio(true);

            // Get the spatial audio engine
            localSpatial = agoraEngine.getLocalSpatialAudioEngine();

            // Initialize the spatial audio engine
            localSpatial.initialize();

            // Set the audio reception range, in meters, of the local user
            localSpatial.setAudioRecvRange(50);

            // Set the length of unit distance in meters
            localSpatial.setDistanceUnit(1);

            // Define the position of the local user
            var pos = [0.0, 0.0,0.0];
            var axisForward = [1.0, 0.0,0.0];
            var axisRight = [0.0, 1.0,0.0];
            var axisUp = [0.0, 0.0,1.0];

            // Set the position of the local user
            localSpatial.updateSelfPosition(
                position: pos,
                axisForward: axisForward,
                axisRight: axisRight,
                axisUp: axisUp
            );
        }
        ```

    1. To execute this method at startup, add the following line to `setupVideoSDKEngine();` after `await agoraEngine.enableVideo();`:

        ```dart
        configureSpatialAudioEngine();
        ```

1. **Set the spatial position of a remote user**

    To update the spatial position of a remote user, define the `RemoteVoicePositionInfo` and call `updateRemotePosition`. 

        ```dart
        void updateRemoteUserPosition() {

            // Define the remote user spatial position
            RemoteVoicePositionInfo positionInfo = RemoteVoicePositionInfo(
            position: [15.0, 0.0, 0.0],
            forward: [15.0, 0.0, 0.0],
            );

            // Update the spatial position of a remote user
            localSpatial.updateRemotePosition(
                uid: _remoteUid ?? 0, posInfo: positionInfo);

            showMessage("Remote user spatial position updated.");
        }
        ```

Spatial audio is currently experimental. Contact sales-us@agora.io to activate this function. If you need further support, please contact [<Vg k="COMPANY" /> technical support](mailto:support@agora.io).

</PlatformWrapper>
