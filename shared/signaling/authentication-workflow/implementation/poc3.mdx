import RTMToken from '@docs/assets/code/signaling/authentication-workflow/retrieve-rtm-token.mdx'
import Login from '@docs/assets/code/signaling/authentication-workflow/login.mdx'
import RTCToken from '@docs/assets/code/signaling/authentication-workflow/retrieve-rtc-token.mdx'
import JoinStreamChannel from '@docs/assets/code/signaling/authentication-workflow/join-stream-channel.mdx'
import ExpireEvent from '@docs/assets/code/signaling/authentication-workflow/handle-expire-event.mdx'
import RenewToken from '@docs/assets/code/signaling/authentication-workflow/renew-token.mdx'

In <Vg k="MESS" />, each authentication token you create is specific for a user ID in your <Vpl k="CLIENT" />. You create a token for each user who logs in to <Vg k="MESS" />. When you initiate the <Vg k="MESS_ENGINE" />, ensure that the UID is the same one you used to create the token.

In order to make HTTPS calls to a token server and interpret the JSON return parameters, the axios HTTP client is integrated into the reference .

To retrieve tokens from the token server and use them to authenticate your <Vpl k="CLIENT" /> with <Vg k="MESS" /> using  <Vpd k="SDK" />:

1.  **Retrieve an RTM token from the server**

    Use a GET request to retrieve an RTM authentication token for initializing the <Vg k="MESS" /> engine.

    <RTMToken/>

1.  **Use the token to login into the <Vg k="MESS_ENGINE" />**

    Call `fetchToken` to get a fresh RTM token. Use the token in the `RTMConfig` to initiate the <Vg k="MESS_ENGINE" />.

    <Login/>

1. **Retrieve an RTC token**

    To join a stream channel you retrieve an RTC token from the token server by specifying the `uid` and `channelName`.

    <RTCToken/>

1.  **Use the RTC token to join a stream channel**

    Create a stream channel using the channel name and call `join` with the RTC token.
    
    <JoinStreamChannel/>

1.  **Handle the event triggered by <Vg k="AGORA_BACKEND" /> when the token is about to expire**

    A token expires after the `tokenExpiryTime` specified in the call to the token server. If the expiry time is not specified the default timeout is 24 hours. The  `TokenPrivilegeWillExpire` event receives a callback when the current token is about to expire so that a fresh token may be retrieved and used.

    <ExpireEvent/>

1. **Renew the token**

    You persist the existing session by retrieving a fresh token and calling `renewToken`.

    <RenewToken/>

