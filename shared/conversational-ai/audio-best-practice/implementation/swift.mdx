import CodeBlock from '@theme/CodeBlock';

1. **Integrate the subtitle processing module**

    Copy the [`ConversationalAIAPI`](https://github.com/AgoraIO-Community/Conversational-AI-Demo/tree/main/iOS/Scenes/ConvoAI/ConvoAI/ConvoAI/Classes/ConversationalAIAPI) folder to your project and import the module before calling the module API. Refer to [Toolkit Structure](#toolkit-structure) to understand the role of each file.

1. **Create a subtitle processing toolkit instance**

    Create configuration objects for the <Vg k="VSDK"/> and Chat SDK instances, and then initialize the toolkit instance.

    <CodeBlock language="swift" showLineNumbers>
    {`// Create configuration objects for the Video SDK and Chat SDK instances
    let config = ConversationalAIAPIConfig(
        rtcEngine: rtcEngine, 
        rtmEngine: rtmEngine,
        enableLog: true
    )
    /// Create component instance
    convoAIAPI = ConversationalAIAPIImpl(config: config)`}
    </CodeBlock>


1. **Set optimal audio settings**

    Before joining the <Vg k="VSDK"/> channel, call the `loadAudioSettings()` method to apply the optimal audio parameters.

    The component monitors audio route changes internally. If the audio route changes, it automatically calls this method again to reset the optimal parameters.

    <CodeBlock language="kotlin" showLineNumbers>
    {`convoAIAPI.loadAudioSettings()
    rtcEngine.joinChannel(rtcToken: token, channelName: channelName, uid: uid, isIndependent: independent)`}
    </CodeBlock>


1. **Agent joins the channel**

    To create a conversational agent interface, send a `POST` request with the following parameters:

    | Parameter                         | Required | Description                                    |
    | --------------------------------- | -------- | ---------------------------------------------- |
    | `advanced_features.enable_rtm`    | Yes      | Enables the Chat service. |
    | `parameters.data_channel`         | Yes      | Sets the data transmission channel to `"rtm"`. |
    | `parameters.enable_metrics`       | Optional | Enables collection of agent performance data.  |
    | `parameters.enable_error_message` | Optional | Enables reporting of agent error events.       |

    After a successful request, the agent joins the specified Video SDK channel and the user can begin interacting with it.

1. **Release resources**

    At the end of each call, use the `destroy` method to clean up the cache.

    <CodeBlock language="swift" showLineNumbers>
    {`convoAIAPI.destroy()`}
    </CodeBlock>
