import Implementation from './implementation/index.mdx'
import Reference from './reference/index.mdx'

In real-time interactive scenarios such as live broadcasts, conferences, and large-class lectures, adjusting video resolution dynamically improves the user experience across different terminals and network conditions.

Common use cases include:

- **Live streaming**: Push high resolution, and fall back to low resolution under poor network conditions.

- **Video conferencing**: Use high resolution for the main speaker and low resolution for thumbnails.

- **Multi-terminal adaptation**: Deliver high resolution to high-performance devices and low resolution to low-performance devices to optimize bandwidth.

- **Multi-screen adaptation**: Stream different resolutions for large, medium, and small screens.

This guide shows you how to use the <Vpd k="SDK" /> to implement multi-resolution video streaming.

## Understand the tech

To support multi-channel scenarios, the <Vpd k="SDK" /> introduces Adaptive Bitrate Video Streaming (ABR) starting with v4.6.0. ABR enables you to send up to four simultaneous streams of different resolutions from the same video source: one source stream and up to three extended streams. Subscribers can choose different stream levels based on rendering window size or business logic, balancing image quality, performance, bandwidth, and network conditions. If bandwidth or device performance is limited, the sender automatically disables multi-streaming.

Compared to dual-stream video, ABR offers more stream layers and smoother switching. If you already use dual-stream video, see [ABR vs. Dual-stream video](#abr-vs-dual-stream-video) to choose the right solution for your needs.

<Admonition type="info" title="Additional information about ABR">

- To reduce uplink encoding and network usage, Agora limits each client to a maximum of four streams, including both large and small streams. If you need up to eight streams, [contact technical support](mailto:support@agora.io).

- ABR supports publishing video streams at specific tiers based on the subscriber’s settings. This feature is disabled by default. [Contact technical support](mailto:support@agora.io) to enable.

- Currently, ABR is available only for video publishing and subscription on the RTC Native platform. It is not supported on the Web platform. [Contact technical support](mailto:support@agora.io) if you need it.

- Cloud recording supports only large or small streams when ABR is enabled.
</Admonition>

## Prerequisites

Ensure that you have implemented the [SDK quickstart](../get-started/get-started-sdk) in your project.

## Publish multi-resolution video streams

<Implementation />

## Reference

This section contains content that completes the information on this page, or points you to documentation that explains other aspects to this product.

### ABR vs. Dual-stream video

ABR (`setSimulcastConfig`) and dual-stream video (`setDualStreamMode`) are mutually exclusive. The API you set later overrides the earlier one. Choose the solution that fits your business needs and disable the other.

Compared with dual-stream video, ABR offers the following improvements:

<PlatformWrapper notAllowed="ios">
- **More subscribed streams**: ABR expands the number of subscribable streams from 2 to 8. On top of the original large (`VideoStreamType.VIDEO_STREAM_HIGH`) and small (`VideoStreamType.VIDEO_STREAM_LOW`) streams, ABR adds six extended streams. These are defined as `VIDEO_STREAM_LAYER_1` to `VIDEO_STREAM_LAYER_6`, corresponding to `SimulcastConfig.StreamLayerIndex.STREAM_LAYER_1` to `SimulcastConfig.StreamLayerIndex.STREAM_LAYER_6`.
</PlatformWrapper>

<PlatformWrapper platform="ios">
- **More subscribed streams**: ABR expands the number of subscribable streams from 2 to 8. On top of the original large (`VideoStreamType.high`) and small (`VideoStreamType.low`) streams, ABR adds six extended streams. These are defined as `VIDEO_STREAM_LAYER_1` to `VIDEO_STREAM_LAYER_6`, corresponding to `AgoraStreamLayerIndex.layer1` to `AgoraStreamLayerIndex.layer6`.
</PlatformWrapper>

- **Smoother switching experience**: Instead of the two-level switching between large and small streams, ABR supports multi-level resolution switching. This provides a smoother experience and more flexibility for different business scenarios.

To better balance ABR performance and network consumption, <Vg k="COMPANY" /> has implemented the following strategies:

- When the sender device is performance-limited, upstream extended streams are automatically disabled, and subscribers adapt to the remaining streams.

- When the uplink bandwidth is limited, extended streams are disabled first. Then, the previous dual-stream rate control strategy is applied to ensure smooth publishing and subscription.

In terms of functionality, the differences between ABR and dual-stream video are summarized in the following table. <Vg k="COMPANY" /> will continue to close the feature gap in future releases.


| Feature | ABR | Dual-stream video |
|---------|-----|-------------------|
| Supports multi-channel scenarios | ✔ | ✔ |
| Small stream automatically adapts video attributes | ✘ | ✔ |
| Publisher sends video streams based on subscriber’s chosen layer | ✔ <br/>Contact technical support to enable | ✔ |
| When the sender is performance-limited, video streams other than the source stream can be disabled | ✔ | ✘ |
| When the downlink network is limited, the upstream small stream can be enabled automatically | ✘ | ✔ |

<Reference />