<PlatformWrapper platform="android">

    ```kotlin
    // Listen for the event that a token is about to expire
    override val iRtcEngineEventHandler: IRtcEngineEventHandler
        get() = object : IRtcEngineEventHandler() {
            // Listen for the event that the token is about to expire
            override fun onTokenPrivilegeWillExpire(token: String) {
                sendMessage("Token is about to expire")
                // Get a new token
                fetchToken(channelName, object : TokenCallback {
                    override fun onTokenReceived(rtcToken: String?) {
                        // Use the token to renew
                        agoraEngine!!.renewToken(rtcToken)
                        sendMessage("Token renewed")
                    }

                    override fun onError(errorMessage: String) {
                        // Handle the error
                        sendMessage("Error: $errorMessage")
                    }
                })
                super.onTokenPrivilegeWillExpire(token)
            }
        }
    ```

    - <Link target="_blank" to="{{global.API_REF_ANDROID_ROOT}}/class_irtcengine.html#api_irtcengine_renewtoken">renewToken</Link>
    - <Link target="_blank" to="{{global.API_REF_ANDROID_ROOT}}/class_irtcengineeventhandler.html#callback_irtcengineeventhandler_ontokenprivilegewillexpire">onTokenPrivilegeWillExpire</Link>

</PlatformWrapper>

<PlatformWrapper platform="macos, ios">

    ```swift
    func rtcEngine(
        _ engine: AgoraRtcEngineKit, tokenPrivilegeWillExpire token: String
    ) {
        Task {
            if let token = try? await fetchToken(
                from: DocsAppConfig.shared.tokenUrl,
                channel: DocsAppConfig.shared.channel,
                role: .broadcaster
            ) { self.agoraEngine.renewToken(token) }
        }
    }
    ```
</PlatformWrapper>

<PlatformWrapper platform="unity">

    ```csharp
    internal class AuthenticationWorkflowEventHandler : UserEventHandler
    {
        private AuthenticationWorkflowManager authenticationWorkflowManager;

        internal AuthenticationWorkflowEventHandler(AuthenticationWorkflowManager refAuthenticationWorkflow) : base(refAuthenticationWorkflow)
        {
            authenticationWorkflowManager =
            refAuthenticationWorkflow;
        }

        public override async void OnTokenPrivilegeWillExpire(RtcConnection connection, string token)
        {
            Debug.Log("Token Expired");
            // Retrieve a fresh token from the token server.
            await authenticationWorkflowManager.FetchToken();
            authenticationWorkflowManager.RenewToken();
        }

        public override async void OnClientRoleChanged(RtcConnection connection, CLIENT_ROLE_TYPE oldRole, CLIENT_ROLE_TYPE newRole, ClientRoleOptions newRoleOptions)
        {
            // Retrieve a fresh token from the token server for the new role.
            Debug.Log("Role is set to " + newRole.ToString());
            await authenticationWorkflowManager.FetchToken();
            authenticationWorkflowManager.RenewToken();
        }
    }
    ```

-   <Link target="_blank" to="{{global.API_REF_UNITY_ROOT}}/class_irtcengineeventhandler.html#callback_irtcengineeventhandler_onproxyconnected">OnTokenPrivilegeWillExpire</Link>
-   <Link target="_blank" to="{{global.API_REF_UNITY_ROOT}}/class_irtcengineeventhandler.html#callback_irtcengineeventhandler_onclientrolechanged">OnClientRoleChanged</Link>

</PlatformWrapper>
<PlatformWrapper placeholder="react-js">
    ```typescript
    const useTokenWillExpire = () => {
        const agoraEngine = useRTCClient();
        useClientEvent(agoraEngine, "token-privilege-will-expire", () => {
            if (config.serverUrl !== "") {
                fetchRTCToken(config.channelName)
                .then((token) => {
                    console.log("RTC token fetched from server: ", token);
                    if (token) return agoraEngine.renewToken(token);
                })
                .catch((error) => {
                    console.error(error);
                });
            } else {
                console.log("Please make sure you specified the token server URL in the configuration file");
            }
        });
    };
    ```
    - <Link to="{{Global.API_REF_RNJS_ROOT}}/functions/useRTCClient.html">useRTCClient</Link>
    - <Link to="{{Global.API_REF_RNJS_ROOT}}/functions/useClientEvent.html">useClientEvent</Link>
    - <Link target="_blank" to="{{global.API_REF_WEB_ROOT}}/interfaces/iagorartcclient.html#renewtoken">renewToken</Link>
</PlatformWrapper>