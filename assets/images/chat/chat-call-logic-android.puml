@startuml

!include agora_skin.iuml

actor "User" as USR

box "Your app"
participant "Agora \nChat SDK" as APP
end box

box "Agora"
participant "Chat \nServer" as API
end box

group Initialize
USR -> APP: Open App
APP -> APP: Initialize a ChatClient instance: \n ChatClient.getInstance().init(context, options)
APP -> APP: Add message event callbacks: \nChatClient.getInstance().chatManager().addMessageListener(...)
APP -> APP: Add connection event callbacks: \nChatClient.getInstance().addConnectionListener(...)
end

group Log in
USR -> APP: Join a chat
APP -> APP: Retrieve authentication token for the user
APP -> API: Login to the chat server:\n ChatClient.getInstance().loginWithAgoraToken(...)
API -> APP: onConnected() callback
end

group Send 
USR -> APP: Send a message
APP -> APP: Create a ChatMessage
APP -> API: Send the ChatMessage: \nChatClient.getInstance().chatManager().sendMessage(message)
end

group Receive messages
APP <- API: onMessageReceived(...) callback
APP -> APP: Display message
end

group Close
USR -> APP: Leave the chat
APP -> API: Log out: \n  ChatClient.getInstance().logout(...)
end

@enduml

