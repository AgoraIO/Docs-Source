import * as data from '@site/data/variables';
import CommonParameter from '@docs/shared/chat-sdk/restful-api/shared/common-parameters.mdx';
import Authorization from '@docs/shared/chat-sdk/restful-api/shared/authorization.mdx';

A chat group allow list refers to a list of chat room members that can send group messages after the group owner or admins have muted all the group members using the [mute-all](./agora_chat_restful_group_mute?platform=RESTful#mute-all) method. Agora Chat provides a complete set of allow list management methods, including adding users to the allow list and removing them from it, as well as retrieving the members on the allow list.

This page shows how to manage a chat group allow list using the Agora Chat RESTful APIs. Before calling the following methods, ensure that you understand the call frequency limit described in <Link to="../reference/limitations?platform={{platform.PATH}}#call-limit-of-server-sides">Limitations</Link>.

<a name="param"></a>

## Common parameters

<CommonParameter />

## Authorization

<Authorization />

## Retrieving the group allow list

This method retrieves the list of all the members on the chat group allow list. 

For each App Key, the call frequency limit of this method is 100 per second.

### HTTP request

```shell
GET https://{host}/{org_name}/{app_name}/chatgroups/{group_id}/white/users
```
#### Path parameter

| Parameter | Type | Description | Required |
| --- | --- | --- | --- |
| `group_id` | String | The chat group ID. | Yes |

For other parameters and detailed descriptions, see [Common parameters](#param).

#### Request header

| Parameter | Type | Description | Required |
| :------------ | :----- | :----------------------------------------------------------- | :------- |
| `Content-Type` | String | The parameter type. Set it as `application/json`. | Yes |
| `Authorization` | String | The authentication token of the user or admin, in the format of `Bearer ${token}`, where `Bearer` is a fixed character, followed by an English space, and then the obtained token value. | Yes |

### HTTP response

#### Response body

If the returned HTTP status code is 200, the request succeeds, and the `data` field in the response body contains the user IDs on the group allow list. For other parameters and detailed descriptions, see [Common parameters](#param).

If the returned HTTP status code is not 200, the request fails. You can refer to [Status code](./agora_chat_status_code?platform=RESTful) for possible causes.

### Example

#### Request example

```shell
curl -X GET -H 'Accept: application/json' -H 'Authorization: Bearer {Your app token}' 'http://XXXX/XXXX/XXXX/chatgroups/{The group ID}/white/users'
```

#### Response example

```json
{
    "action": "get",
    "application": "5cf28979-XXXX-XXXX-b969-60141fb9c75d",
    "uri": "http://XXXX/XXXX/XXXX/chatgroups/1208XXXX5169153/white/users",
    "entities": [],
    "data": [
        "username1",
        "username1",
        "username3",
        "username4",
        "username5"
    ],
    "timestamp": 1594724947117,
    "duration": 3,
    "organization": "XXXX",
    "applicationName": "XXXX",
    "count": 5
}
```

## Adding a member to the group allow list

This method adds the specified user to the chat group allow list. Members in the group allow list can still send group messages after the group owner or admin has muted all the group members using the [mute-all](./agora_chat_restful_group_mute?platform=RESTful#mute-all) method.

For each App Key, the call frequency limit of this method is 100 per second.

### HTTP request

```http
POST https://{host}/{org_name}/{app_name}/chatgroups/{group_id}/white/users/{username}
```

#### Path parameter

| Parameter | Type | Description | Required |
| --- | --- | --- | --- |
| `group_id` | String | The chat group ID. | Yes |
| `username` | String | The user ID that you want to add to the group allow list. | Yes |

For other parameters and detailed descriptions, see [Common parameters](#param).

#### Request header

| Parameter | Type | Description | Required |
| :------------ | :----- | :----------------------------------------------------------- | :------- |
| `Content-Type` | String | The parameter type. Set it as `application/json`. | Yes |
| `Authorization` | String | The authentication token of the user or admin, in the format of `Bearer ${token}`, where `Bearer` is a fixed character, followed by an English space, and then the obtained token value. | Yes |

### HTTP response

#### Response body

If the returned HTTP status code is 200, the request succeeds, and the `data` field in the response body contains the following fields:

| Parameter | Type | Description |
| --- | --- | --- |
| `result` | Boolean | Whether the chat group member is successfully added to the group allow list. <ul><li>`true`: Yes.</li><li>`false`: No.</li></ul> |
| `reason` | String | The reason for failing to add the member to the allow list. |
| `groupid` | String | The chat group ID. |
| `action` | String | The operation of the method call. |
| `user` | String | The user ID added to the allow list. |

For other parameters and detailed descriptions, see [Common parameters](#param).

If the returned HTTP status code is not 200, the request fails. You can refer to [Status code](./agora_chat_status_code?platform=RESTful) for possible causes.

### Example

#### Request example

```shell
curl -X POST -H 'Accept: application/json' -H 'Authorization: Bearer {Your app token}' 'http://XXXX/XXXX/XXXX/chatgroups/{The group ID}/white/users/{username}'
```

#### Response example

```json
    "action": "post",
    "application": "5cf28979-XXXX-XXXX-b969-60141fb9c75d",
    "uri": "http://XXXX/XXXX/XXXX/chatgroups/120824965169153/white/users/username1",
    "entities": [],
    "data": {
        "result": true,
        "action": "add_user_whitelist",
        "user": "username1",
        "groupid": "1208XXXX5169153"
    },
    "timestamp": 1594724293063,
    "duration": 4,
    "organization": "XXXX",
    "applicationName": "XXXX"
}
```

## Adding multiple members to the group allow list

This method adds multiple chat group members to the group allow list. You can add a maximum of 60 group members to the allow list per method call.

For each App Key, the call frequency limit of this method is 100 per second.

### HTTP request

```http
POST https://{host}/{org_name}/{app_name}/chatgroups/{group_id}/white/users
```

| Parameter | Type | Description | Required |
| --- | --- | --- | --- |
| `group_id` | String | The chat group ID. | Yes |

For other parameters and detailed descriptions, see [Common parameters](#param).

#### Request header

| Parameter | Type | Description | Required |
| :------------ | :----- | :----------------------------------------------------------- | :------- |
| `Content-Type` | String | The parameter type. Set it as `application/json`. | Yes |
| `Authorization` | String | The authentication token of the user or admin, in the format of `Bearer ${token}`, where `Bearer` is a fixed character, followed by an English space, and then the obtained token value. | Yes |

#### Request body

| Parameter | Type | Description |
| --- | --- | --- |
| `usernames` | Array | The user IDs that you want to add to the group allow list. |

### HTTP response

If the returned HTTP status code is 200, the request succeeds, and the `data` field in the response body contains the following fields:

| Parameter | Type | Description |
| --- | --- | --- |
| `result` | Boolean | Whether the chat group member is successfully added to the group allow list. <ul><li>`true`: Yes.</li><li>`false`: No.</li></ul> |
| `reason` | String | The reason for failing to add the member to the allow list. |
| `groupid` | String | The chat group ID. |
| `action` | String | The operation of the method call. |
| `user` | String | The user ID added to the allow list. |

For other parameters and detailed descriptions, see [Common parameters](#param).

If the returned HTTP status code is not 200, the request fails. You can refer to [Status code](./agora_chat_status_code?platform=RESTful) for possible causes.

### Example

#### Request example

```shell
curl -X POST -H 'Content-Type: application/json' -H 'Accept: application/json' -H 'Authorization: Bearer {Your app token}' -d '{"usernames" : ["user1"]}' 'http://XXXX/XXXX/XXXX/chatgroups/{The group ID}/white/users'
```

#### Response example

```json
{
    "action": "post",
    "application": "5cf28979-XXXX-XXXX-b969-60141fb9c75d",
    "uri": "http://XXXX/XXXX/XXXX/chatgroups/1208XXXX5169153/white/users",
    "entities": [],
    "data": [
        {
            "result": true,
            "action": "add_user_whitelist",
            "user": "username1",
            "groupid": "1208XXXX5169153"
        },
        {
            "result": true,
            "action": "add_user_whitelist",
            "user": "username2",
            "groupid": "1208XXXX5169153"
        }
    ],
    "timestamp": 1594724634191,
    "duration": 2,
    "organization": "XXXX",
    "applicationName": "XXXX"
}
```

## Removing members from the group allow list

This method removes the specified chat group member(s) from the group allow list. You can remove a maximum of 60 group members from the allow list per method call.

For each App Key, the call frequency limit of this method is 100 per second.

### HTTP request

```http
DELETE https://{host}/{org_name}/{app_name}/chatgroups/{group_id}/white/users/{username}
```

#### Path parameter

| Parameter | Type | Description | Required |
| --- | --- | --- | --- |
| `group_id` | String | The chat group ID. | Yes |
| `username` | String | The user ID(s) that you want to remove from the allow list. For multiple user IDs, use the English comma "," to separate each user ID.| Yes |

For other parameters and detailed descriptions, see [Common parameters](#param).

#### Request header

| Parameter | Type | Description | Required |
| :------------ | :----- | :----------------------------------------------------------- | :------- |
| `Content-Type` | String | The parameter type. Set it as `application/json`. | Yes |
| `Authorization` | String | The authentication token of the user or admin, in the format of `Bearer ${token}`, where `Bearer` is a fixed character, followed by an English space, and then the obtained token value. | Yes |

### HTTP response

If the returned HTTP status code is 200, the request succeeds, and the `data` field in the response body contains the following fields:

| Parameter | Type | Description |
| --- | --- | --- |
| `result` | Boolean | Whether the chat group member is successfully removed from the group allow list. <ul><li>`true`: Yes.</li><li>`false`: No.</li></ul> |
| `reason` | String | The reason for failing to remove the member from the allow list. |
| `groupid` | String | The chat group ID. |
| `action` | String | The operation of the method call. |
| `user` | String | The user ID removed from the allow list. |

For other parameters and detailed descriptions, see [Common parameters](#param).

If the returned HTTP status code is not 200, the request fails. You can refer to [Status code](./agora_chat_status_code?platform=RESTful) for possible causes.

### Example

#### Request example

```shell
curl -X DELETE -H 'Accept: application/json' -H 'Authorization: Bearer {Your app token}' 'http://XXXX/XXXX/XXXX/chatgroups/1208XXXX5169153/white/users/{username}'
```

#### Response example

```json
{
    "action": "delete",
    "application": "5cf28979-XXXX-XXXX-b969-60141fb9c75d",
    "uri": "http://XXXX/XXXX/XXXX/chatgroups/1208XXXX5169153/white/users/username1,username2",
    "entities": [],
    "data": [
        {
            "result": true,
            "action": "remove_user_whitelist",
            "user": "username1",
            "groupid": "1208XXXX5169153"
        },
        {
            "result": true,
            "action": "remove_user_whitelist",
            "user": "username2",
            "groupid": "1208XXXX5169153"
        }
    ],
    "timestamp": 1594725137704,
    "duration": 1,
    "organization": "XXXX",
    "applicationName": "XXXX"
}
```