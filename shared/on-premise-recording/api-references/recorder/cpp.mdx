## IAgoraMediaRtcRecorder

This class manages media in a channel.

| API | Description |
|-----|-------------|
| [`initialize`](#initialize) | Initializes the recorder instance. |
| [`joinChannel`](#joinchannel) | Joins an Agora RTC channel. |
| [`leaveChannel`](#leavechannel) | Leaves the Agora RTC channel. |
| [`enableEncryption`](#enableencryption) | Enables or disables built-in encryption. |
| [`subscribeAllAudio`](#subscribeallaudio) | Subscribes to and records audio from all remote users in the channel. |
| [`subscribeAllVideo`](#subscribeallvideo) | Subscribes to video from all remote users in the channel. |
| [`unsubscribeAllAudio`](#unsubscribeallaudio) | Stops subscribing to audio from all remote users in the channel. |
| [`unsubscribeAllVideo`](#unsubscribeallvideo) | Stops subscribing to video from all remote users in the channel. |
| [`subscribeAudio`](#subscribeaudio) | Subscribes to and records audio from a specified remote user. |
| [`unsubscribeAudio`](#unsubscribeaudio) | Stops subscribing to audio from a specified remote user. |
| [`subscribeVideo`](#subscribevideo) | Subscribes to video from a specified remote user. |
| [`unsubscribeVideo`](#unsubscribevideo) | Stops subscribing to video from a specified remote user. |
| [`setAudioVolumeIndicationParameters`](#setaudiovolumeindicationparameters) | Sets the interval for the [`onAudioVolumeIndication`](#onaudiovolumeindication) callback. |
| [`setVideoMixingLayout`](#setvideomixinglayout) | Sets the layout for mixed video streams. |
| [`setRecorderConfig`](#setrecorderconfig) | Configures the recorder instance. |
| [`enableAndUpdateVideoWatermarks`](#enableandupdatevideowatermarks) | Adds a watermark to the video stream. |
| [`disableVideoWatermarks`](#disablevideowatermarks) | Disables video watermarks. |
| [`startRecording`](#startrecording) | Starts recording. |
| [`stopRecording`](#stoprecording) | Stops recording. |
| [`startSingleRecordingByUid`](#startsinglerecordingbyuid) | Starts recording for a specified user ID. |
| [`stopSingleRecordingByUid`](#stopsinglerecordingbyuid) | Stops recording for a specified user ID. |
| [`setRecorderConfigByUid`](#setrecorderconfigbyuid) | Sets recording configurations for a specific user. |
| [`enableAndUpdateVideoWatermarksByUid`](#enableandupdatevideowatermarksbyuid) | Adds a watermark to the video stream of a specific user. |
| [`disableVideoWatermarksByUid`](#disablevideowatermarksbyuid) | Disables the watermark for a specific user's video stream. |
| [`registerRecorderEventHandle`](#registerrecordereventhandle) | Registers a recorder event handler. |
| [`unregisterRecorderEventHandle`](#unregisterrecordereventhandle) | Unregisters the recorder event handler. |
| [`setGlobalLocalAccessPoint`](#setgloballocalaccesspoint) | Sets the global local access point address in local AP mode. |
| [`renewToken`](#renewtoken) | Renews the token. |

### `initialize`

Initializes the recorder instance.

```cpp
virtual int initialize(base::IAgoraService* agora_service, bool enable_mix = true) = 0;
```

#### Parameters

| Parameter       | Type                                | Description                                                                                       |
|-----------------|-------------------------------------|---------------------------------------------------------------------------------------------------|
| `agora_service` | `base::IAgoraService*`              | Agora service object; ensure it has been initialized. See [`IAgoraService`](#iagoraservice).   |
| `enable_mix`    | `bool`                             | Whether to enable mixed mode during recording:                                                    |
|                 |                                     | - `true` (default): Enable mixed streaming recording.                                              |
|                 |                                     | - `false`: Enable single-stream recording.                                                          |

#### Returns

- `0`: The method call was successful.  
- Less than 0: The method call failed.

### `joinChannel`

Joins an Agora RTC channel.

```cpp
virtual int joinChannel(const char* token, const char* channelId, const char* userId) = 0;
```

#### Parameters

| Parameter     | Type                | Description                                                                                      |
|---------------|---------------------|--------------------------------------------------------------------------------------------------|
| `token`       | `const char*`       | Authentication token or App ID.                |
| `channelId`   | `const char*`       | Name of the channel. Must be a string with a maximum of 64 bytes. Supported characters include: <br/> - All lowercase letters: a-z.<br/>- All uppercase letters: A-Z.<br/> - All digits: 0-9. <br/> - Spaces. <br/> - Punctuation and symbols, including: `"!"`, `"#"`, `"$"`, `"%"`, `"&"`, `"("`, `")"`, `"+"`, `"-"`, `":"`, `";"`, `"<"`, `"="`, `"."`, `">"`, `"?"`, `"@"`, `"["`, `"]"`, `"^"`, `"_"`, `"{"`, `"}"`, `"|"`, `"~"`, `","`. |
| `userId`      | `const char*`       | User ID of the local user. If not specified or set to `null`, the SDK will automatically assign a user ID. |

#### Returns

- `0`: The method call was successful.  
- Less than 0: The method call failed.


### `leaveChannel`

Leaves the Agora RTC channel.

```cpp
virtual int leaveChannel() = 0;
```

#### Returns

- `0`: The method call was successful.  
- Less than 0: The method call failed.


### `enableEncryption`

Enables or disables built-in encryption.

It's recommended to call this method to enable encryption before joining a channel, especially in high-security scenarios.

All users in the same channel must use the same encryption mode and key. When all users leave the channel, the encryption key is automatically cleared.

```cpp
virtual int enableEncryption(bool enabled, const EncryptionConfig& config) = 0;
```

#### Parameters

| Parameter     | Type                                | Description                                                                                         |
|---------------|-------------------------------------|-----------------------------------------------------------------------------------------------------|
| `enabled`     | `bool`                              | Whether to enable built-in encryption:                                                             |
|               |                                     | - `true`: Enable encryption.                                                                         |
|               |                                     | - `false` (default): Disable encryption.                                                             |
| `config`      | `const EncryptionConfig&`           | Encryption configuration. See [`EncryptionConfig`](#encryptionconfig).                          |

#### Returns

- `0`: The method call was successful.  
- Less than 0: The method call failed.


### `subscribeAllAudio`

Subscribes to and records audio from all remote users in the channel.

This method will automatically subscribe to the audio streams of all current and future remote users joining the channel.

```cpp
virtual int subscribeAllAudio() = 0;
```

#### Returns

- `0`: The method call was successful.  
- Less than 0: The method call failed.

### `subscribeAllVideo`

Subscribes to all remote users’ video streams in the channel.

This method automatically subscribes to all current and future remote users' video streams.

```cpp
virtual int subscribeAllVideo(const agora::rtc::VideoSubscriptionOptions& subscriptionOptions) = 0;
```

#### Parameters

| Parameter                 | Type                                              | Description                                                                                     |
|---------------------------|---------------------------------------------------|-------------------------------------------------------------------------------------------------|
| `subscriptionOptions`     | `const agora::rtc::VideoSubscriptionOptions&`   | Video subscription options. See [`VideoSubscriptionOptions`](#videosubscriptionoptions).     |

#### Returns

- `0`: The method call was successful.  
- Less than 0: The method call failed.

### `unsubscribeAllAudio`

Stops subscribing to audio streams from all remote users.

Unless explicitly calling [`subscribeAudio`](#subscribeaudio) or [`subscribeAllAudio`](#subscribeallaudio), this method automatically stops subscribing to audio streams of users joining afterward.

```cpp
virtual int unsubscribeAllAudio() = 0;
```

#### Returns

- `0`: The method call was successful.  
- Less than 0: The method call failed.

### `unsubscribeAllVideo`

Stops subscribing to video streams from all remote users in the channel.

After calling this, the SDK will stop subscribing to all remote video streams unless you explicitly call [`subscribeVideo`](#subscribevideo) or [`subscribeAllVideo`](#subscribeallvideo).

```cpp
virtual int unsubscribeAllVideo() = 0;
```

#### Returns

- `0`: The method call was successful.  
- Less than 0: The method call failed.

### `subscribeAudio`

Subscribes to and records audio from a specific remote user.

```cpp
virtual int subscribeAudio(user_id_t userId) = 0;
```

#### Parameters

| Parameter | Type              | Description                                                                                     |
|-----------|-------------------|-------------------------------------------------------------------------------------------------|
| `userId`  | `user_id_t`       | User ID of the remote user whose audio you want to subscribe to.                              |

#### Returns

- `0`: The method call was successful.  
- Less than 0: The method call failed.  
  - `-2` (`ERR_INVALID_ARGUMENT`): The user does not exist or `userId` is invalid.

### `unsubscribeAudio`

Stops subscribing to a specific remote user’s audio stream.

```cpp
virtual int unsubscribeAudio(user_id_t userId) = 0;
```

#### Parameters

| Parameter | Type              | Description                                                                                                |
|-----------|-------------------|------------------------------------------------------------------------------------------------------------|
| `userId`  | `user_id_t`       | User ID of the remote user whose audio subscription you want to stop.                                  |

#### Returns

- `0`: The method call was successful.  
- Less than 0: The method call failed.  
  - `-2` (`ERR_INVALID_ARGUMENT`): The user does not exist or `userId` is invalid.

### `subscribeVideo`

Subscribes to a remote user’s video stream.

```cpp
virtual int subscribeVideo(user_id_t userId, const VideoSubscriptionOptions& subscriptionOptions) = 0;
```

#### Parameters

| Parameter                | Type                                              | Description                                                                                     |
|--------------------------|---------------------------------------------------|-------------------------------------------------------------------------------------------------|
| `userId`                 | `user_id_t`                                       | User ID of the remote user whose video stream you want to subscribe to.                        |
| `subscriptionOptions`    | `const VideoSubscriptionOptions&`                 | Video subscription options. See [`VideoSubscriptionOptions`](#videosubscriptionoptions).     |

#### Returns

- `0`: The method call was successful.  
- Less than 0: The method call failed.  
  - `-2` (`ERR_INVALID_ARGUMENT`): The user does not exist or `userId` is invalid.

### `unsubscribeVideo`

Stops subscribing to a remote user’s video stream.

```cpp
virtual int unsubscribeVideo(user_id_t userId) = 0;
```

#### Parameters

| Parameter | Type              | Description                                                                               |
|-----------|-------------------|-------------------------------------------------------------------------------------------|
| `userId`  | `user_id_t`       | User ID of the remote user whose video stream subscription you want to stop.          |

#### Returns

- `0`: The method call was successful.  
- Less than 0: The method call failed.  
  - `-2` (`ERR_INVALID_ARGUMENT`): The user does not exist or `userId` is invalid.

### `setAudioVolumeIndicationParameters`

Sets the interval for the `onAudioVolumeIndication` callback.

```cpp
virtual int setAudioVolumeIndicationParameters(int intervalInMS) = 0;
```

#### Parameters

| Parameter         | Type   | Description                                                                                      |
|-------------------|--------|--------------------------------------------------------------------------------------------------|
| `intervalInMS`    | `int`  | Time interval between volume indication callbacks in milliseconds (default is 500).           |
|                   |        | - Less than or equal to 10: disables volume indication callbacks.                               |
|                   |        | - Greater than 10: sets the interval (milliseconds) between callbacks.                        |

#### Returns

- `0`: The method call was successful.  
- Less than 0: The method call failed.

### `setVideoMixingLayout`

Sets the layout for mixed video streams.

```cpp
virtual int setVideoMixingLayout(const VideoMixingLayout& layout) = 0;
```

#### Parameters

| Parameter | Type                                | Description                                                                                     |
|-----------|-------------------------------------|-------------------------------------------------------------------------------------------------|
| `layout`  | `const VideoMixingLayout&`         | Layout configuration for the mixed video stream. See [`VideoMixingLayout`](#videomixinglayout). |

#### Returns

- `0`: The method call was successful.  
- Less than 0: The method call failed.

### `setRecorderConfig`

Configures the recorder instance.

```cpp
virtual int setRecorderConfig(const media::MediaRecorderConfiguration& config) = 0;
```

#### Parameters

| Parameter | Type                                                            | Description                                                                                     |
|-----------|-----------------------------------------------------------------|-------------------------------------------------------------------------------------------------|
| `config`  | `const media::MediaRecorderConfiguration&`                     | Recorder configuration. See [`MediaRecorderConfiguration`](#mediarecorderconfiguration).     |

#### Returns

- `0`: The method call was successful.  
- Less than 0: The method call failed.

### `enableAndUpdateVideoWatermarks`

Adds watermarks to the video stream.

```cpp
virtual int enableAndUpdateVideoWatermarks(WatermarkConfig* watermark_configs, int num) = 0;
```

#### Parameters

| Parameter             | Type                               | Description                                                                                     |
|-----------------------|------------------------------------|-------------------------------------------------------------------------------------------------|
| `watermark_configs`   | `WatermarkConfig*`                 | Array of watermark configurations. See [`WatermarkConfig`](#watermarkconfig).               |
| `num`               | `int`                              | Number of watermark configurations.                                                             |

#### Returns

- `0`: The method call was successful.  
- Less than 0: The method call failed.

### `disableVideoWatermarks`

Disables video watermarks.

```cpp
virtual int disableVideoWatermarks() = 0;
```

#### Returns

- `0`: The method call was successful.  
- Less than 0: The method call failed.

### `startRecording`

Starts recording.

```cpp
virtual int startRecording() = 0;
```

#### Returns

- `0`: The method call was successful.  
- Less than 0: The method call failed.

### `stopRecording`

Stops the current recording.

<Admonition type="info" info="info">
The original snippet cuts off here. Assuming similar structure for `stopRecording()`.
</Admonition>

```cpp
virtual int stopRecording() = 0;
```

#### Returns

- `0`: The method call was successful.  
- Less than 0: The method call failed.


### `startSingleRecordingByUid`

Starts recording for the specified user.

```cpp
virtual int startSingleRecordingByUid(user_id_t userId) = 0;
```

#### Parameters

| Parameter | Type        | Description                         |
| --------- | ----------- | ----------------------------------- |
| `userId`  | `user_id_t` | The user ID to start recording for. |

#### Returns

* `0`: The method call was successful.
* `< 0`: The method call failed.


### `stopSingleRecordingByUid`

Stops recording for the specified user.

```cpp
virtual int stopSingleRecordingByUid(user_id_t userId) = 0;
```

#### Parameters

| Parameter | Type        | Description                        |
| --------- | ----------- | ---------------------------------- |
| `userId`  | `user_id_t` | The user ID to stop recording for. |

#### Returns

* `0`: The method call was successful.
* `< 0`: The method call failed.


### `setRecorderConfigByUid`

Sets the recording configuration for the specified user.

```cpp
virtual int setRecorderConfigByUid(const media::MediaRecorderConfiguration& config, user_id_t userId) = 0;
```

#### Parameters

| Parameter | Type                                       | Description                                                                                                    |
| --------- | ------------------------------------------ | -------------------------------------------------------------------------------------------------------------- |
| `config`  | `const media::MediaRecorderConfiguration&` | Configuration of the recorder instance. See [`MediaRecorderConfiguration`](#mediarecorderconfiguration). |
| `userId`  | `user_id_t`                                | The user ID to apply the configuration to.                                                                     |

#### Returns

* `0`: The method call was successful.
* `< 0`: The method call failed.


### `enableAndUpdateVideoWatermarksByUid`

Adds or updates video watermarks for the specified user's stream.

```cpp
virtual int enableAndUpdateVideoWatermarksByUid(WatermarkConfig* watermark_configs, int num, user_id_t userId) = 0;
```

#### Parameters

| Parameter           | Type               | Description                                                                            |
| ------------------- | ------------------ | -------------------------------------------------------------------------------------- |
| `watermark_configs` | `WatermarkConfig*` | An array of watermark configurations. See [`WatermarkConfig`](#watermarkconfig). |
| `num`               | `int`              | Number of watermark configurations.                                                    |
| `userId`            | `user_id_t`        | The user ID of the video stream to add watermarks to.                                  |

#### Returns

* `0`: The method call was successful.
* `< 0`: The method call failed.

### `disableVideoWatermarksByUid`

Disables watermarks for the specified user's video stream.

```cpp
virtual int disableVideoWatermarksByUid(user_id_t userId) = 0;
```

#### Parameters

| Parameter | Type        | Description                                                 |
| --------- | ----------- | ----------------------------------------------------------- |
| `userId`  | `user_id_t` | The user ID whose video stream watermarks will be disabled. |

#### Returns

* `0`: The method call was successful.
* `< 0`: The method call failed.

### `registerRecorderEventHandle`

Registers an event handler for the recorder.

```cpp
virtual int registerRecorderEventHandle(IAgoraMediaRtcRecorderEventHandler* handler) = 0;
```

#### Parameters

| Parameter | Type                                  | Description                                                                                                 |
| --------- | ------------------------------------- | ----------------------------------------------------------------------------------------------------------- |
| `handler` | `IAgoraMediaRtcRecorderEventHandler*` | The event handler instance. See [`IAgoraMediaRtcRecorderEventHandler`](#iagoramediartcrecordereventhandler). |

#### Returns

* `0`: The method call was successful.
* `< 0`: The method call failed.

### `unregisterRecorderEventHandle`

Unregisters the recorder event handler.

```cpp
virtual int unregisterRecorderEventHandle(IAgoraMediaRtcRecorderEventHandler* handler) = 0;
```

#### Parameters

| Parameter | Type                                  | Description                                                                                                      |
| --------- | ------------------------------------- | ---------------------------------------------------------------------------------------------------------------- |
| `handler` | `IAgoraMediaRtcRecorderEventHandler*` | The event handler to unregister. See [`IAgoraMediaRtcRecorderEventHandler`](#iagoramediartcrecordereventhandler). |

#### Returns

* `0`: The method call was successful.
* `< 0`: The method call failed.

### `setGlobalLocalAccessPoint`

Sets the global local access point in Local AP mode.

<Admonition type="info" info="info">
Call this method before joining a channel. It applies to all recorder instances in the same process and only needs to be called once.
</Admonition>

```cpp
virtual int setGlobalLocalAccessPoint(const LocalAccessPointConfiguration& config) = 0;
```

#### Parameters

| Parameter | Type                                   | Description                                                                                                               |
| --------- | -------------------------------------- | ------------------------------------------------------------------------------------------------------------------------- |
| `config`  | `const LocalAccessPointConfiguration&` | The configuration of the local access point. See [`LocalAccessPointConfiguration`](#localaccesspointconfiguration). |

#### Returns

* `0`: The method call was successful.
* `< 0`: The method call failed.

### `renewToken`

Renews the token.

Tokens expire after a period of time. You must regenerate a new token on your server and call this method in **any** of the following cases, or the SDK will disconnect from the channel:

* The `onError` callback reports error code `ERR_TOKEN_EXPIRED (109)`.
* The `onTokenPrivilegeWillExpire` callback is triggered.
* The `onTokenPrivilegeDidExpire` callback is triggered.

```cpp
virtual int renewToken(const char* token) = 0;
```

#### Parameters

| Parameter | Type          | Description               |
| --------- | ------------- | ------------------------- |
| `token`   | `const char*` | Pointer to the new token. |

#### Returns

* `0`: The method call was successful.
* `< 0`: The method call failed.

