<PlatformWrapper platform="ios">

To optimize the user experience when dealing with a large number of push notifications, instant messaging IM provides fine-grained options for push notification methods and do not disturb mode at the app and conversation levels.

** Push notification method **

| Push notification method parameters      | Description    | App   | Single and group chat sessions   |
| :------- | :----- | :----- | :----- |
|  ` All `  | Receive push notifications for all offline messages. | ✓ | ✓ |
|  ` MentionOnly `  | Only receive push notifications for messages that mention you. < br />This parameter is recommended for group chats. If you want to mention one or more users, pass "em_at_list": [ "user1", "user2" ... ] to the ` ext ` field when creating a message ; if you want to mention everyone, pass "em_at_list": "all" to this field. | ✓ | ✓ |
|  ` NONE `    | Do not receive push notifications for offline messages. | ✓ | ✓ |

The push notification method setting at the session level takes precedence over the setting at the app level. For sessions where the push notification method is not set, the app setting is used by default.

For example, suppose the push method for the app is set to ` MentionOnly ` , and the push method for a given conversation is set to ` All ` . You will receive all push notifications from that conversation, but for all other conversations, you will only receive push notifications for messages that mention you.

** Do Not Disturb Mode **

After you have completed SDK initialization and successfully logged into the app, you can enable offline push for the app and various types of sessions, and turn off push by setting the Do Not Disturb mode.

You can specify the DND time period and DND duration at the app level, and IM will not send offline push notifications during these two time periods. If both the DND time period and DND duration are set, the DND mode will take effect for the sum of these two time periods.

The following table describes the Do Not Disturb time parameters:

| Quiet time parameters      |   Description    | App   | Single and group chat sessions   |
| :--------| :----- | :------------ | :------------ |
| `silentModeStartTime & silentModeEndTime` | The time period for triggering offline push notifications every day, using the 24-hour system, accurate to the minute, in the format of H:MH:M, for example, 8:30-10:0, the range of hours and minutes in the start time and end time is [0,23] and [0,59] respectively. The setting of the Do Not Disturb time period is as follows: <ul><li>After the start time and end time are set, the Do Not Disturb mode is triggered every day. For example, if the time period is set to `8:0`-`10:0`, the Do Not Disturb mode is effective from 8:00 to 10:00 every day. If you set the start time to 8:0 and the end time to 12:0 at 11:00, the Do Not Disturb mode is effective from 11:00 to 12:00 on the same day, and from 8:00 to 12:00 every day thereafter. </li><li> If the start time and end time are the same, the Do Not Disturb mode is effective all day. However, if it is set to `0:0-0:0`, the Do Not Disturb mode is turned off. </li><li>If the end time is earlier than the start time, the Do Not Disturb mode takes effect from the start time of each day to the end time of the next day. For example, if the start time is `10:0` and the end time is `8:0`, the Do Not Disturb mode takes effect from 10:00 on the same day to 8:00 on the next day. </li><li>Currently, the Do Not Disturb mode is only supported in a specified time period each day. Multiple Do Not Disturb time periods are not supported. The new setting will overwrite the previous setting. </li><li>If both this parameter and `silentModeDuration` are set, the Do Not Disturb mode takes effect in both time periods on the same day. For example, if `silentModeDuration` is set to 8:0-10:0 at 8:00 am and `silentModeDuration` is set to 240 minutes (4 hours), the app will be in Do Not Disturb mode from 8:00-12:00 on the same day and from 8:00-10:0 every day thereafter. </li></ul> | ✓ | ✗ |
|  ` silentModeDuration `  | Do not disturb duration, in minutes. The value range of the do not disturb duration is [ 0,10080 ] , ` 0 ` means the parameter is invalid, ` 10080 ` means the do not disturb mode lasts for 7 days. < br /> Unlike the setting of the do not disturb time period, which takes effect every day, this parameter is valid once. It takes effect immediately after setting. For example, if you set the app-level ` silentModeDuration ` to 240 minutes (4 hours) at 8:00 am, the app will be in do not disturb mode from 8:00 to 12:00 on the same day. < br /> - If both this parameter and ` silentModeStartTime & silentModeEndTime ` are set, the DND mode will be effective during both time periods on the same day. For example, if the app-level ` silentModeStartTime & silentModeEndTime ` is set to 8:00-10:00 at 8:00 am, and the DND duration is set to 240 minutes (4 hours), the app will be in DND mode from 8:00-12:00 now and from 8:00-10:00 every day thereafter.     | ✓      | ✓ |

If you need to push messages to specific users during the do not disturb period or the effective time, you need to set [ Force push ] ( ./7_push_extension#Force push ) .

** Relationship between push notification method and do not disturb time setting **

For the app and all sessions in the app, the Do Not Disturb mode setting takes precedence over the push notification method setting. For example, suppose you specify a Do Not Disturb time period at the app level and set the push notification method for the specified session to ` All` . The app enters Do Not Disturb mode during the specified time period, and you will not receive any push notifications.

Alternatively, suppose a session is assigned a quiet time period, and the app does not have any quiet settings and its push notification method is set to ` All` . During the specified quiet time period, you will not receive any push notifications from this session, while push notifications from all other sessions remain unchanged.

## Set up push notifications for the app

You can call ` setSilentModeForAll ` to set app-level push notifications, and set the push notification method and DND mode by specifying the ` AgoraChatSilentModeParam ` field, as shown in the following code example:

```Objective-C
// Set the push notification method to `MentionOnly`.
AgoraChatSilentModeParam *param = [[AgoraChatSilentModeParam alloc]initWithParamType:AgoraChatSilentModeParamTypeRemindType];
    param.remindType = AgoraChatPushRemindTypeMentionOnly;
// Set up offline push notifications for the app.
[[AgoraChatClient sharedClient].pushManager setSilentModeForAll:param completion:^(AgoraChatSilentModeResult *aResult, AgoraChatError *aError) {
            if (aError) {
                NSLog(@"setSilentModeForAll error---%@",aError.errorDescription);
            }
        }];
// Set the offline push do not disturb timer to 15 minutes.
AgoraChatSilentModeParam *param = [[AgoraChatSilentModeParam alloc]initWithParamType:AgoraChatSilentModeParamTypeDuration];
    param.silentModeDuration = 15;
//Set the do not disturb time period for offline push to 8:30 to 15:00.
AgoraChatSilentModeParam *param = [[AgoraChatSilentModeParam alloc]initWithParamType:AgoraChatSilentModeParamTypeInterval];
    param.silentModeStartTime = [[AgoraChatSilentModeTime alloc]initWithHours:8 minutes:30];
    param.silentModeEndTime = [[AgoraChatSilentModeTime alloc]initWithHours:15 minutes:0];
```
## Get the push notification settings of the app
You can call getSilentModeForAllWithCompletion to get the app-level push notification settings, as shown in the following code example:
```Objective-C
[[AgoraChatClient sharedClient].pushManager getSilentModeForAllWithCompletion:^(AgoraChatSilentModeResult *aResult, AgoraChatError *aError) {
            if (!aError) {
                // Get the push notification method settings of the app.
                AgoraChatPushRemindType remindType = aResult.remindType;
                // Get the Unix timestamp of the app's offline push Do Not Disturb expiration.
                NSTimeInterval ex = aResult.expireTimestamp;
                // Get the start time of the app's offline push do not disturb time period.
                AgoraChatSilentModeTime *startTime = aResult.silentModeStartTime;
                // Get the end time of the offline push do not disturb time period of the app.
                AgoraChatSilentModeTime *endTime = aResult.silentModeEndTime;
            }else{
                NSLog(@"getSilentModeForAll error---%@",aError.errorDescription);
            }
        }];
```

## Set push notifications for a single session

You can call the ` setSilentModeForConversation` method to set push notifications for a specified conversation, and set the push notification method and the do not disturb mode by specifying the `SilentModeParam` field, as shown in the following code example :

```Objective-C
// Set the push notification method to `MentionOnly`.
AgoraChatSilentModeParam *param = [[AgoraChatSilentModeParam alloc]initWithParamType:AgoraChatSilentModeParamTypeRemindType];
    param.remindType = AgoraChatPushRemindTypeMentionOnly;

// Set the offline push do not disturb timer to 15 minutes.
AgoraChatSilentModeParam *param = [[AgoraChatSilentModeParam alloc]initWithParamType:AgoraChatSilentModeParamTypeDuration];
    param.silentModeDuration = 15;
// Set the offline push do not disturb mode for the session. Currently, it does not support setting the do not disturb time period for the session.
AgoraChatConversationType conversationType = AgoraChatConversationTypeGroupChat;
[[AgoraChatClient sharedClient].pushManager setSilentModeForConversation:@"conversationId" conversationType:conversationType params:param completion:^(AgoraChatSilentModeResult *aResult, AgoraChatError *aError) {
        if (aError) {
                NSLog(@"setSilentModeForConversation error---%@",aError.errorDescription);
         }
     }];
```
## Get push notification settings for a single session
You can call getSilentModeForConversation to get the push notification settings for a specific conversation, as shown in the following code example:
```Objective-C
[[AgoraChatClient sharedClient].pushManager getSilentModeForConversation:@"conversationId" conversationType:AgoraChatConversationTypeChat completion:^(AgoraChatSilentModeResult * _Nullable aResult, AgoraChatError * _Nullable aError) {
    }];
```

## Get push notification settings for multiple sessions

1. You can get push notification settings for up to 20 sessions in each call.

2. If the session uses app settings or its push notification settings have expired, the returned dictionary does not contain this session.

You can call getSilentModeForConversations to get the push notification setting for multiple conversations, as shown in the following code example :

```Objective-C
AgoraChatConversation* conv1 = [AgoraChatClient.sharedClient.chatManager getConversationWithConvId:@"conversationId1"];
NSArray *conversations = @[conv1];
    [[AgoraChatClient sharedClient].pushManager getSilentModeForConversations:conversations completion:^(NSDictionary<NSString*,AgoraChatSilentModeResult*>*aResult, AgoraChatError *aError) {
            if (aError) {
                NSLog(@"getSilentModeForConversations error---%@",aError.errorDescription);
            }
        }];
```
## Clear push notification settings for a single session
You can call the `clearRemindTypeForConversation` method to clear the push notification type settings for a specified conversation. After clearing, this conversation will use the app's settings by default.
The following code example shows how to clear the push notification mode settings for a session:
```Objective-C
    [[AgoraChatClient sharedClient].pushManager clearRemindTypeForConversation:@"" conversationType:conversationType completion:^(AgoraChatSilentModeResult *aResult, AgoraChatError *aError) {
            if (aError) {
                NSLog(@"clearRemindTypeForConversation error---%@",aError.errorDescription);
            }
    }];
```

</PlatformWrapper>