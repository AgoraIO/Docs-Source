---
title: 'Voice AI client quickstart'
sidebar_position: 4
type: docs
platform_selector: false
description: >
  Build a React web client to interact with Conversational AI agents.
---

This guide shows you how to build a React web client that connects to <Vpd k="NAME" /> agents. Your client captures and publishes local audio, subscribes to the agent’s audio stream, and manages the RTC connection. The backend manages agent lifecycle and credential generation.

<details>
<summary>Client application workflow</summary>

![](/images/conversational-ai/convo-ai-backend.svg)
</details>

## Prerequisites

<Admonition type="info" title="Important">
This guide assumes you have a backend server already running from the [Agent quickstart](quickstart). The client connects to this server to manage agent lifecycle. If you haven't built the backend yet, do that first.
</Admonition>

Before you begin, make sure you have:

- **App ID**:  Identifies your Agora project.
- **Backend server running**: Complete the [Agent quickstart](quickstart) first. Your client communicates with this server to start and stop agents.
- **Node.js 16+**: For running the development server with Vite

## Understand the tech

The backend manages the agent lifecycle and returns the credentials you need. Your client only needs to join the channel and handle local audio. Implement this workflow in your client:

1. **User initiates conversation**: Clicks "Start Conversation" button
2. **Backend creates agent**: Client calls backend `/agents/start` endpoint with channel and user details
3. **Backend returns connection details**: Agora channel name, RTC token, and agent information
4. **Client joins channel**: Uses Agora RTC SDK to join the channel with the token
5. **Real-time communication**: Client publishes local audio and receives agent audio
6. **Cleanup**: When conversation ends, client stops publishing and calls backend `/agents/:agentId/stop`

#### Data flow

Before implementing the client code, understand what your backend endpoint expects and returns.

* Client sends to `/agents/start` endpoint:

    ```json
    {
      "channelName": "support-room-123",
      "agentName": "SupportBot",
      "userUid": "1002"
    }
    ```

* Backend returns to client:

    ```json
    {
      "success": true,
      "agentId": "1NT29X10YHxxxxxWJOXLYHNYB",
      "channelName": "support-room-123",
      "token": "007eAAA...",
      "clientUid": "1002",
      "agentUid": "1001",
      "status": "RUNNING",
      "createTime": 1737111452
    }
    ```

    **Key parameters returned**:

    - `agentId`: The agent identifier. Use this ID to stop the agent when you are done.
    - `channelName`: Client uses this to join the same channel where the agent is waiting.
    - `token`: Client uses this to authenticate when joining the channel. Always, generate the token on the server-side, never expose your App Certificate to clients.
    - `clientUid`: The client's unique identifier in the channel; matches the `userUid` sent in the request.
    - `agentUid`: The agent's unique identifier in the channel. Client uses this to identify the agent's audio stream.

## Implementation

Follow these steps to create a basic voice AI client.

### Create a React project

Set up a new React project with Vite for fast development:

```bash
npm create vite@latest agora-ai-client -- --template react
cd agora-ai-client
npm install
mkdir -p src/components
touch src/components/AgoraAIClient.jsx
touch .env.local
```

Your project structure should look like this:

```
agora-ai-client/
├── src/
│   ├── App.jsx
│   ├── components/
│   │   └── AgoraAIClient.jsx
│   ├── main.jsx
│   └── index.css
├── .env.local
├── package.json
└── vite.config.js
```

### Install dependencies

Install the Agora RTC SDK:

```bash
npm install agora-rtc-react agora-rtc-sdk-ng
```

What these packages do:
- **agora-rtc-react**: React hooks for Agora Video SDK integration
- **agora-rtc-sdk-ng**: Agora's core Video/Audio SDK with WebRTC support

### Configure environment variables

Create a `.env.local` file in your project root:

```bash
# Agora Configuration
VITE_AGORA_APP_ID=your_app_id_here

# Backend Server
VITE_BACKEND_URL=http://localhost:3000
```

- `VITE_AGORA_APP_ID`: Your Agora project's App ID. The client uses this to authenticate with Agora's RTC service.
- `VITE_BACKEND_URL`: URL where your backend server is running. The client calls this server to start and stop agents.

<Admonition type="caution">
In production, use environment-specific values. For example, use different backend URLs for development and production environments. Never commit `.env.local` to version control.
</Admonition>

### Build the Agora client provider

Create a wrapper component that initializes Agora's RTC client and provides it to your application:

```jsx
import AgoraRTC, {
  AgoraRTCProvider,
  LocalUser,
  RemoteUser,
  useIsConnected,
  useJoin,
  useLocalMicrophoneTrack,
  usePublish,
  useRemoteUsers,
} from "agora-rtc-react";
import { useState, useMemo } from "react";

export const AgoraAIClient = () => {
  const client = useMemo(
    () =>
      AgoraRTC.createClient({
        mode: "rtc",
        codec: "vp8",
      }),
    [],
  );

  return (
    <AgoraRTCProvider client={client}>
      <ConversationUI />
    </AgoraRTCProvider>
  );
};
```

### Handle agent startup

Add a `startAgent` function that calls your backend to start an agent.

1. Client sends channel name, agent name, and user UID to backend
2. Backend creates the agent and returns RTC token + channel details
3. Client stores these details and sets `calling = true` to trigger Agora connection
4. `useJoin` hook detects the change and joins the channel with the provided token

```jsx
const startAgent = async () => {
  if (calling) return;

  try {
    setError("");
    setIsLoading(true);

    const response = await fetch(`${backendUrl}/agents/start`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        channelName: `channel-${Date.now()}`,
        agentName: "VoiceAgent",
        userUid: "1002",
      }),
    });

    if (!response.ok) {
      const errorData = await response.json();
      throw new Error(errorData.error || "Failed to start agent");
    }

    const data = await response.json();

    if (data.success) {
      setChannel(data.channelName);
      setToken(data.token);
      setUid(parseInt(data.clientUid));
      setAgentUid(parseInt(data.agentUid));
      setAgentId(data.agentId);
      setCalling(true);
    }
  } catch (err) {
    console.error("Failed to start agent:", err);
    setError(err.message);
  } finally {
    setIsLoading(false);
  }
};
```

### Handle agent shutdown

Add the function to stop the agent when conversation ends:

```jsx
const stopAgent = async () => {
    try {
      if (agentId) {
        await fetch(`${backendUrl}/agents/${agentId}/stop`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
        });
      }
    } catch (err) {
      console.error("Failed to stop agent:", err);
    }

    setCalling(false);
    setChannel("");
    setToken("");
    setUid(0);
    setAgentUid(0);
    setAgentId("");

    if (localMicrophoneTrack) {
      localMicrophoneTrack.stop();
      localMicrophoneTrack.close();
    }
  };
```

### Render the UI

Build a simple UI that shows:

- Connection status when not connected (shows App ID and start button)
- Agent connection status when connected (channel, UIDs, agent status)
- Local and remote audio streams using `<LocalUser>` and `<RemoteUser>` components
- Microphone toggle and end conversation buttons

Refer to the complete client code for implementation details.

### Complete client implementation

The following implementation combines the previous steps into a single component file. Create a new file `src/components/AgoraAIClient.jsx` with the following code:

```jsx
import AgoraRTC, {
  AgoraRTCProvider,
  LocalUser,
  RemoteUser,
  useIsConnected,
  useJoin,
  useLocalMicrophoneTrack,
  usePublish,
  useRemoteUsers,
} from "agora-rtc-react";
import { useState, useMemo } from "react";

export const AgoraAIClient = () => {
  const client = useMemo(
    () =>
      AgoraRTC.createClient({
        mode: "rtc",
        codec: "vp8",
      }),
    [],
  );

  return (
    <AgoraRTCProvider client={client}>
      <ConversationUI />
    </AgoraRTCProvider>
  );
};

const ConversationUI = () => {
  const [appId] = useState(import.meta.env.VITE_AGORA_APP_ID || "");
  const [backendUrl] = useState(
    import.meta.env.VITE_BACKEND_URL || "http://localhost:3000",
  );

  // Connection state
  const [calling, setCalling] = useState(false);
  const [channel, setChannel] = useState("");
  const [token, setToken] = useState("");
  const [uid, setUid] = useState(0);
  const [agentUid, setAgentUid] = useState(0);
  const [agentId, setAgentId] = useState("");

  // UI state
  const [micOn, setMic] = useState(true);
  const [isLoading, setIsLoading] = useState(false);
  const [error, setError] = useState("");

  // Agora hooks
  const isConnected = useIsConnected();
  const { localMicrophoneTrack } = useLocalMicrophoneTrack(micOn);

  useJoin({ appid: appId, channel, token: token || null, uid }, calling);
  usePublish([localMicrophoneTrack]);

  const remoteUsers = useRemoteUsers();

  const startAgent = async () => {
    if (calling) return;

    try {
      setError("");
      setIsLoading(true);

      const response = await fetch(`${backendUrl}/agents/start`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          channelName: `channel-${Date.now()}`,
          agentName: "VoiceAgent",
          userUid: "1002",
        }),
      });

      if (!response.ok) {
        const errorData = await response.json();
        throw new Error(errorData.error || "Failed to start agent");
      }

      const data = await response.json();

      if (data.success) {
        setChannel(data.channelName);
        setToken(data.token);
        setUid(parseInt(data.clientUid));
        setAgentUid(parseInt(data.agentUid));
        setAgentId(data.agentId);
        setCalling(true);
      }
    } catch (err) {
      console.error("Failed to start agent:", err);
      setError(err.message);
    } finally {
      setIsLoading(false);
    }
  };

  const stopAgent = async () => {
    try {
      if (agentId) {
        await fetch(`${backendUrl}/agents/${agentId}/stop`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
        });
      }
    } catch (err) {
      console.error("Failed to stop agent:", err);
    }

    setCalling(false);
    setChannel("");
    setToken("");
    setUid(0);
    setAgentUid(0);
    setAgentId("");

    if (localMicrophoneTrack) {
      localMicrophoneTrack.stop();
      localMicrophoneTrack.close();
    }
  };

  return (
    <div
      style={{
        padding: "20px",
        fontFamily: "Arial, sans-serif",
        maxWidth: "800px",
        margin: "0 auto",
      }}
    >
      <h1>Agora Conversational AI</h1>

      {error && (
        <div
          style={{
            padding: "15px",
            backgroundColor: "#ffebee",
            borderRadius: "4px",
            marginBottom: "20px",
            color: "#c62828",
          }}
        >
          Error: {error}
        </div>
      )}

      {isConnected ? (
        <div style={{ marginTop: "20px" }}>
          <div
            style={{
              padding: "15px",
              backgroundColor: "#444444",
              borderRadius: "4px",
              marginBottom: "20px",
            }}
          >
            <h3>Connected to Agent</h3>
            <p>
              <strong>Channel:</strong> {channel}
            </p>
            <p>
              <strong>Your UID:</strong> {uid}
            </p>
            <p>
              <strong>Agent UID:</strong> {agentUid}
            </p>
            <p>
              <strong>Status:</strong>{" "}
              {remoteUsers.length > 0
                ? "Agent connected"
                : "Waiting for agent..."}
            </p>
          </div>

          <div style={{ marginBottom: "20px" }}>

            {/* Local user */}
              <LocalUser
                audioTrack={localMicrophoneTrack}
                playAudio={false}
                micOn={micOn}/>

            {/* Remote agent */}
            {remoteUsers.map((user) => (
              <div key={user.uid} style={{ marginBottom: "10px" }}>
                <RemoteUser user={user}/>
              </div>
            ))}

            {remoteUsers.length === 0 && (
              <div
                style={{
                  padding: "10px",
                  backgroundColor: "#fff3cd",
                  borderRadius: "4px",
                  color: "#856404",
                }}
              >
                ⏳ Waiting for agent to connect...
              </div>
            )}
          </div>

          <div>
            <button
              onClick={() => setMic((prev) => !prev)}
              style={{
                marginRight: "10px",
                padding: "10px 20px",
                cursor: "pointer",
              }}
            >
              {micOn ? "Disable Mic" : "Enable Mic"}
            </button>
            <button
              onClick={stopAgent}
              style={{
                padding: "10px 20px",
                backgroundColor: "#cc0000",
                color: "white",
                border: "none",
                borderRadius: "4px",
                cursor: "pointer",
              }}
            >
              End Conversation
            </button>
          </div>
        </div>
      ) : (
        <div style={{ marginTop: "20px" }}>
          <div style={{ marginBottom: "20px" }}>
            <p>
              <strong>App ID:</strong> {appId || "Not set in .env.local"}
            </p>
          </div>

          <button
            onClick={startAgent}
            disabled={!appId || isLoading}
            style={{
              padding: "12px 24px",
              fontSize: "16px",
              backgroundColor: isLoading || !appId ? "#cccccc" : "#0066cc",
              color: "white",
              border: "none",
              borderRadius: "4px",
              cursor: isLoading || !appId ? "not-allowed" : "pointer",
            }}
          >
            {isLoading ? "Starting..." : "Start Conversation"}
          </button>
        </div>
      )}
    </div>
  );
};

export default AgoraAIClient;
```

To add the component to your app, update your `App.jsx` to use the client component:

```jsx
import AgoraAIClient from "./components/AgoraAIClient";
import "./App.css";

function App() {
  return <AgoraAIClient />;
}

export default App;
```

## Test the complete flow

1. **Start backend server** (from [Agent quickstart](quickstart)):


1. **Configure environment variables**

    Update the app ID and the backend sever URL in `.env.local`


1. **Start client** (in a separate terminal):
   ```bash
   npm run dev
   ```

   Open your browser to `http://localhost:5173` (or the URL Vite provides). You should see:

    - Your App ID (from `.env.local`)
    - A "Start Conversation" button
    - Error messages if anything is misconfigured

1. **Test the conversation**:
   - Click "Start Conversation"
   - Grant microphone permissions when prompted
   - Speak to the agent
   - Click "End Conversation" to stop

## Reference

### Troubleshooting

#### Agent not connecting

If you see "Waiting for agent..." but the agent never connects:

1. **Backend not running**: Ensure backend server is running on `VITE_BACKEND_URL`.
2. **Backend error**: Check backend console for API errors.
3. **Channel mismatch**: Verify client joins same channel as backend created.
4. **Token expired**: Tokens expire after 1 hour. Reconnect to get fresh token.

#### Connection errors

If you see connection errors in the console:

1. **Check CORS**: Backend must allow requests from client origin. 
2. **Check credentials**: Ensure `VITE_AGORA_APP_ID` and `VITE_BACKEND_URL` are correct.
3. **Check browser console**: Use error messages to identify specific issues.

### API reference

Key hooks from `agora-rtc-react`:

- [`useJoin`](https://api-ref.agora.io/en/video-sdk/reactjs/2.x/functions/useJoin.html): Joins the RTC channel with specified credentials
- [`useLocalMicrophoneTrack`](https://api-ref.agora.io/en/video-sdk/reactjs/2.x/functions/useLocalMicrophoneTrack.html): Manages local microphone audio track
- [`usePublish`](https://api-ref.agora.io/en/video-sdk/reactjs/2.x/functions/usePublish.html): Publishes local tracks to the channel
- [`useRemoteUsers`](https://api-ref.agora.io/en/video-sdk/reactjs/2.x/functions/useRemoteUsers.html): Returns list of remote users in the channel
- [`useIsConnected`](https://api-ref.agora.io/en/video-sdk/reactjs/2.x/functions/useIsConnected.html): Returns true when connected to RTC channel

For complete API reference, see the [agora-rtc-react documentation](https://api-ref.agora.io/en/video-sdk/reactjs/2.x/modules.html).
