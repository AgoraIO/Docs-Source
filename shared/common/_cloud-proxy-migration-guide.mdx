import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

Agora had updated IP whitelist configuration to enhance security and simplify management. This guide helps you update your cloud proxy settings to avoid service interruptions. Following are the key changes:

* **Reduced IP ranges**: Narrower network segments improve security
* **Single IP addressing**: Cloud machines now use single-point IPs
* **Updated subnet masks**: Physical machines now use /28 instead of /26
* **New access point IP list**: Introduced in SDK 3.4.0 for improved high availability


<Admonition type="info" title="Implementation notes">
* All IP addresses and network ranges have been technically verified.
* Update your firewall rules according to the specified timeline.
* Continue using your current configuration if you must configure before the new delivery dates.
* Test your configuration thoroughly using the [validation steps](../reference/cloud-proxy-allowed-ips#validation-and-testing).
</Admonition>

## Summary of changes

| Configuration element    | Current implementation               | New implementation               | technical impact                                                  |
| ------------------------ | ------------------------------------ | -------------------------------- | ----------------------------------------------------------------- |
| Access point networks    | Network segments with various ranges | Single IP per access point       | More precise security boundaries; requires firewall rule updates  |
| Cloud machine networks   | IP ranges with /26 subnet masks      | Single-point IPs                 | Improved security isolation; requires firewall rule updates       |
| Physical machine subnets | /26 subnet masks                     | /28 subnet masks                 | Narrower IP ranges (1/4 the size); requires firewall rule updates |
| SDK 3.5.0.3+ geofencing | Limited functionality                | Narrower AP address list support | Enhanced regional access control                                  |

## Whitelist migration

The following tables provide the essential information needed to migrate your Cloud Proxy configurations to the new network architecture. Each table outlines:

- **Current configuration**: Your existing setup that needs to be updated
- **New Configuration**: The specific IP addresses, ports, and network segments to implement
- **Effective Date/Delivery date**: When you need to complete each migration step
- **Required action**: The specific changes needed for each component

Use these tables to identify the configurations applicable to your regions and SDK versions. Pla

### UDP cloud proxy changes

#### North America

| Component | Current configuration | New Configuration | Effective Date | Required action |
|-----------|----------------------|-------------------|---------------|----------------|
| Cloud Proxy Network Segments | Current segments: Non-HCI segments with /26 masks no dedicated Los Angeles or D.C. segments | `128.14.195.192/28` (Washington)<br/>`128.14.245.16/28` (Seattle)<br/>`128.14.72.80/28` (Los Angeles)<br/>`128.14.200.208/28` (D.C.) | Washington: 5th Nov<br/>Seattle: 5th Nov<br/>Los Angeles: 10th Dec<br/>D.C.: 10th Dec | Update firewall rules for each region by specified date |
| Cloud Proxy Ports | UDP: `4590-4600`, `8001-8010` | UDP: `4590-4600`, `8001-8010` | Same as above | No change required |
| Access Point IPs (SDK 3.2.0-3.4.0) | Current IPs:<br/>`69.28.51.142`<br/>`107.155.14.132`<br/>`128.1.77.34`<br/>`128.1.78.146`<br/>`128.1.87.146`<br/>`54.178.26.110`<br/>`140.210.77.68`<br/>`125.88.159.163` (offline) | `69.28.51.142`<br/>`107.155.14.132`<br/>`128.1.77.34`<br/>`128.1.78.146`<br/>`128.1.87.146`<br/>`54.178.26.110`<br/>`140.210.77.68`,`47.107.39.93` (replacing `125.88.159.163`)<br/>`112.126.96.46` (replacing `125.88.159.163`)<br/>`139.159.110.148` (replacing `125.88.159.163`) | Immediate | Update to include new replacement IPs and remove offline IP |
| Access Point IPs (SDK 3.4.0+) | Not previously configured | `106.14.12.130`<br/>`118.190.148.38`<br/>`184.72.16.87`<br/>`35.168.106.53`<br/>`35.156.231.150`<br/>`15.237.134.178`<br/>`54.178.26.110`<br/>`52.221.23.86`<br/>`13.230.60.35`<br/>`15.206.47.129`<br/>`13.127.149.196`<br/>`13.209.247.137`<br/>`13.124.182.235`<br/>`23.98.43.152`<br/>`107.155.14.132`<br/>`69.28.51.142` | Immediate | Add these IPs if using SDK 3.4.0+ |
| Access Port | UDP: `8443` | UDP: `8443` | Immediate | No change required |

#### Europe

| Component | Current configuration | New Configuration | Effective Date | Required action |
|-----------|----------------------|-------------------|---------------|----------------|
| Cloud Proxy Network Segments | Current segments: Non-HCI segments with /26 masks London and Frankfurt not specifically segmented | `104.166.160.208/28` (London)<br/>`23.236.110.32/28` (Frankfurt)<br/>`104.166.142.134`<br/>`104.166.161.4` | London: 10th Dec<br/>Frankfurt: 10th Dec | Update firewall rules by specified date |
| Cloud Proxy Ports | UDP: `4590-4600`, `8001-8010` | UDP: `4590-4600`, `8001-8010` | Same as above | No change required |
| Access Point IPs | Using global AP configuration | Using global AP configuration | Immediate | Reference North America configuration |
| Access Port | UDP: `8443` | UDP: `8443` | Immediate | No change required |

#### India

| Component | Current configuration | New Configuration | Effective Date | Required action |
|-----------|----------------------|-------------------|---------------|----------------|
| Cloud Proxy Network Segments | Current segments: Non-HCI segments with /26 masks Mumbai, Chennai and Bangalore not specifically segmented | `129.227.217.128/28` (Mumbai)<br/>`129.227.108.208/28` (Chennai)<br/>`128.1.105.112/28` (Bangalore) | Mumbai: 10th Dec<br/>Chennai: 10th Dec<br/>Bangalore: 10th Dec | Update firewall rules by specified date |
| Cloud Proxy Ports | UDP: `4590-4600`, `8001-8010` | UDP: `4590-4600`, `8001-8010` | Same as above | No change required |
| Access Point IPs | Using global AP configuration | Using global AP configuration | Immediate | Reference North America configuration |
| Access Port | UDP: `8443` | UDP: `8443` | Immediate | No change required |

#### Japan

| Component | Current configuration | New Configuration | Effective Date | Required action |
|-----------|----------------------|-------------------|---------------|----------------|
| Cloud Proxy Network Segments | Current segments: Non-HCI segments with /26 masks Tokyo not specifically segmented | `129.227.113.112/28` (Tokyo1)<br/>`129.227.55.96/28` (Tokyo2)<br/>`122.10.153.74`<br/>`129.227.234.123` | Tokyo1: 10th Dec<br/>Tokyo2: 30th Jan 2022 | Update firewall rules by specified date |
| Cloud Proxy Ports | UDP: `4590-4600`, `8001-8010` | UDP: `4590-4600`, `8001-8010` | Same as above | No change required |
| Access Point IPs | Using global AP configuration | Using global AP configuration | Immediate | Reference North America configuration |
| Access Port | UDP: `8443` | UDP: `8443` | Immediate | No change required |

#### Southeast Asia

| Component | Current configuration | New Configuration | Effective Date | Required action |
|-----------|----------------------|-------------------|---------------|----------------|
| Cloud Proxy Network Segments | Current segments: Non-HCI segments with /26 masks Singapore and Hong Kong not specifically segmented | `128.1.186.240/28` (Singapore1)<br/>`129.227.73.32/28` (Singapore2)<br/>`103.193.127.208/28` (Hong Kong) | Singapore1: 10th Dec<br/>Singapore2: 30th Jan 2022<br/>Hong Kong: 10th Dec | Update firewall rules by specified date |
| Cloud Proxy Ports | UDP: `4590-4600`, `8001-8010` | UDP: `4590-4600`, `8001-8010` | Same as above | No change required |
| Access Point IPs | Using global AP configuration | Using global AP configuration | Immediate | Reference North America configuration |
| Access Port | UDP: `8443` | UDP: `8443` | Immediate | No change required |

#### China

| Component | Current configuration | New Configuration | Effective Date | Required action |
|-----------|----------------------|-------------------|---------------|----------------|
| Cloud Proxy Network Segments | Current segments: CTEL, CUCC, CMCC segments with /26 masks | `14.29.38.144/28`<br/>`27.45.161.144/28`<br/>`183.232.200.144/28`<br/>`115.238.206.0/28`<br/>`106.3.209.0/28`<br/>`112.13.216.0/28`<br/>`219.153.111.128/28`<br/>`221.178.42.0/28`<br/>`113.207.12.0/28` | All ready | Update to new subnet masks (/28) |
| Cloud Proxy Ports | UDP: `4590-4600`, `8001-8010` | UDP: `4590-4600`, `8001-8010` | Immediate | No change required |
| Access Point IPs | China-specific AP configuration | China-specific AP configuration:<br/>`106.14.12.130`<br/>`118.190.148.38` | Immediate | Update China-specific AP IPs |
| Access Port | UDP: `8443` | UDP: `8443` | Immediate | No change required |

### TCP (TLS) cloud proxy changes

| Region | Current configuration | New Configuration | Effective Date | Required action |
|--------|----------------------|-------------------|---------------|----------------|
| North America | Current TCP segments: TCP segments with /26 masks | Same network segments as UDP Port: TCP `443`<br/>Access Point IPs: `101.132.108.165`, `123.56.235.221`, `52.54.85.111`, `184.72.18.217`, `52.28.239.238`, `3.9.120.239`, `13.250.89.184`, `18.176.162.64`, `168.138.214.216`, `20.193.241.143`, `3.109.116.108`, `3.36.161.253`, `15.164.88.208`, `164.52.43.58`, `54.205.123.178`, `50.18.20.222` | Same regional dates as UDP | Update TCP firewall rules for all specified IPs |
| Other Regions | Current TCP segments: TCP segments with /26 masks | Same network segments as respective UDP list: Port: TCP `443` | Same regional dates as UDP | Update TCP firewall rules for respective regions |

### Web RTC 

#### Web SDK `3.6.4+`and `4.8.0+`

| Region | Current configuration | New configuration (Media & signal proxy subnets) | Delivery date | Required action |
|--------|----------------------|----------------------------------------------|--------------|----------------|
| North America | Current Web RTC configuration:<br/>Media Proxy: Multiple segments<br/>Signal Proxy: Not specifically segmented | Media: Same network segments as UDP<br/>Signal: `47.252.17.251`, `170.106.135.177`<br/>Ports: UDP `443`, TCP `443` | Same as UDP delivery dates | Update both Media and Signal proxy configurations |
| Europe | Current Web RTC configuration:<br/>Media Proxy: Multiple segments<br/>Signal Proxy: Not specifically segmented | Media: Same as UDP plus additional IPs:<br/>`148.153.25.149`<br/>`148.153.25.148`<br/>`148.153.25.147`<br/>`148.153.25.146`<br/>`148.153.25.184`<br/>`148.153.93.18`<br/>`148.153.93.19`<br/>`148.153.93.24`<br/>`148.153.93.25`<br/>`148.153.93.27`<br/>Signal: `47.254.149.145`, `162.62.220.8`<br/>Ports: UDP `443`, TCP `443` | Same as UDP delivery dates | Update both Media and Signal proxy configurations |
| India | Current Web RTC configuration:<br/>Media Proxy: Multiple segments<br/>Signal Proxy: Not specifically segmented | Media: Same as UDP<br/>Signal: `147.139.34.215`, `129.226.26.104`<br/>Ports: UDP `443`, TCP `443` | Same as UDP delivery dates | Update both Media and Signal proxy configurations |
| Japan | Current Web RTC configuration:<br/>Media Proxy: Multiple segments<br/>Signal Proxy: Not specifically segmented | Media: UDP segments plus additional IPs:<br/>`164.52.24.41`<br/>`164.52.6.29`<br/>`164.52.24.44`<br/>`164.52.24.43`<br/>`103.101.125.21`<br/>`103.101.125.26`<br/>`103.101.125.20`<br/>`103.101.125.22`<br/>`122.10.153.90`<br/>Signal: `47.245.7.250`, `43.128.248.97`<br/>Ports: UDP `443`, TCP `443` | Same as UDP delivery dates | Update both Media and Signal proxy configurations |
| Southeast Asia | Current Web RTC configuration:<br/>Media Proxy: Multiple segments<br/>Signal Proxy: Not specifically segmented | Media: Same as UDP<br/>Signal: `161.117.177.218`, `104.250.52.195`<br/>Ports: UDP `443`, TCP `443` | Same as UDP delivery dates | Update both Media and Signal proxy configurations |
| China | Current Web RTC Configuration:<br/>Media Proxy: Multiple segments<br/>Signal Proxy: Not specifically segmented | Media: Same as UDP<br/>Signal: `139.196.42.124`, `123.56.57.206`<br/>Ports: UDP `443`, TCP `443` | All ready | Update both Media and Signal proxy configurations |

#### Web SDK `3.4.0`-`3.6.3` and `4.3.0`-`4.7.3`

| Region | Current configuration | New Configuration | Delivery date | Required action |
|--------|----------------------|-------------------|--------------|----------------|
| North America | Current Web RTC configuration:<br/>Access Point IPs: Various<br/>Media/Signal Proxy: Not specifically segmented | Access Point IP: `47.74.211.17`, `52.52.84.170`<br/>Media Cloud Proxy Subnets: Same as UDP list<br/>Signal Cloud Proxy Subnets: `47.252.17.251`, `170.106.135.177` | Same as UDP delivery dates | Update Access Point IPs and both proxy configurations |
| Europe | Current Web RTC configuration:<br/>Access Point IPs: Various<br/>Media/Signal Proxy: Not specifically segmented | Access Point IP: `47.74.211.17`, `52.52.84.170`<br/>Media Cloud Proxy Subnets: Same as newer Web SDK<br/>Signal Cloud Proxy Subnets:`47.254.149.145`, `162.62.220.8` | Same as UDP delivery dates | Update Access Point IPs and both proxy configurations |
| Other Regions | Current Web RTC configuration:<br/>Access Point IPs: Various<br/>Media/Signal Proxy: Not specifically segmented | Region-specific Access Point IPs and Media/Signal Proxy Subnets (refer to detailed entries for each region) | Same as UDP delivery dates | Update Access Point IPs and both proxy configurations for each region |

### Web Signaling geofencing 

| Region | Current Domain & IPs | New Domain & IPs | Port | Required action |
|--------|---------------------|-----------------|------|----------------|
| Asia | Current Geo-fencing:<br/>Domain: Not specifically configured<br/>IPs: Global AP configuration | Domain: `proxy-ap-web-asia.agora.io`<br/>IPs: `47.74.211.17`, `52.221.23.86` | UDP: `443`<br/>TCP: `443` | Configure new domain and IPs |
| Europe | Current Geo-fencing:<br/>Domain: Not specifically configured<br/>IPs: Global AP configuration | Domain: `proxy-ap-web-europe.agora.io`<br/>IPs: `128.1.78.146`, `35.178.208.187` | UDP: `443`<br/>TCP: `443` | Configure new domain and IPs |
| HKMC | Current Geo-fencing:<br/>Domain: Not specifically configured<br/>IPs: Global AP configuration | Domain: `proxy-ap-web-hkmc.agora.io`<br/>IPs: `23.98.43.152`, `47.244.4.122` | Not specified | Configure new domain and IPs |
| India | Current Geo-fencing:<br/>Domain: Not specifically configured<br/>IPs: Global AP configuration | Domain: `proxy-ap-web-india.agora.io`<br/>IPs: `129.227.98.170`, `129.154.38.143` | UDP: `443`<br/>TCP: `443` | Configure new domain and IPs |
| Japan | Current Geo-fencing:<br/>Domain: Not specifically configured<br/>IPs: Global AP configuration | Domain: `proxy-ap-web-japan.agora.io`<br/>IPs: `52.68.71.190`, `168.138.222.84` | UDP: `443`<br/>TCP: `443` | Configure new domain and IPs |
| Korea | Current Geo-fencing:<br/>Domain: Not specifically configured<br/>IPs: Global AP configuration | Domain: `proxy-ap-web-korea.agora.io`<br/>IPs: `164.52.43.59`, `13.124.182.235` | Not specified | Configure new domain and IPs |
| Mainland China | Current Geo-fencing:<br/>Domain: Not specifically configured<br/>IPs: China-specific AP configuration | Domain: `proxy-ap-web.agoraio.cn`<br/>IPs: `52.80.192.229`, `47.96.234.219` | UDP: `443`<br/>TCP: `443` | Configure new domain and IPs |
| North America | Current Geo-fencing:<br/>Domain: Not specifically configured<br/>IPs: Global AP configuration | Domain: `proxy-ap-web-america.agora.io`, `proxy-ap-web-us.agora.io`<br/>IPs: `35.169.70.181`, `107.155.14.132` | UDP: `443`<br/>TCP: `443` | Configure new domain and IPs |
| Southeast Asia | Current Geo-fencing:<br/>Domain: Not specifically configured<br/>IPs: Global AP configuration | Domain: N/A<br/>IPs: N/A | UDP: `443`<br/>TCP: `443` | No specific configuration needed |
| Abroad | Current Geo-fencing:<br/>Domain: Not specifically configured<br/>IPs: Global AP configuration | Domain: N/A<br/>IPs: `47.74.211.17`, `52.221.23.86` | Not specified | Configure new IPs |

### Mode 3/4/5 subnet IP migration

| Region | Current configuration | New Configuration | Status/Delivery | Required action |
|--------|----------------------|-------------------|----------------|----------------|
| All Regions | Current Mode 3/4/5 configuration: Region-specific subnet with /26 masks multiple delivered IPs per region | Mode 3/4 and Mode 5 configurations are detailed in the release notes with region-specific subnet ranges (/28 mask) and specific delivered IPs for each region and carrier | Same regional delivery dates as main UDP table | Update Mode 3/4/5 configurations according to detailed specifications |

## Implementation and validation 
Follow this three-phase approach to successfully migrate your Cloud Proxy configuration without service disruption.

### Pre-migration testing
Before making any changes, establish a baseline and verify your current environment using these steps.

1. **Identify SDK version**
   
   Use your SDK's version identification API to determine your current version.

2. **Validate current configuration**
   - Test connectivity using your existing configuration
   - Record baseline performance metrics (latency, packet loss, jitter)
   - Document current firewall rules for rollback purposes

### Implement migration 
Once you've completed testing, follow these steps to implement the new Cloud Proxy configuration.

1. **Use a phased approach**
   - Begin with non-production environments
   - Update firewall rules based on your region and SDK version 
   - Adhere to the region-specific timelines in the configuration tables

2. **Update configurations by SDK version**
   - **SDK 3.2.0-3.4.0**: Implement UDP Cloud Proxy whitelist with `/28` subnet masks
   - **SDK 3.4.0+**: Implement new Access Point IP list and network segments
   - **Web SDK**: Configure both Media and Signal proxy settings based on your specific version

### Post-migration validation
After implementing the changes, verify your new configuration and monitor performance.

1. **Test connectivity**
   
   Configure your client to use UDP Cloud Proxy mode and enable network quality testing.

2. **Monitor performance**
   - Compare latency, packet loss, and jitter against baseline measurements
   - Watch for any connection failures or degraded service quality
   - Test connections from all targeted geographic regions

3. **Prepare fallback strategy**
   - Maintain complete documentation of original configuration
   - Create rollback procedures for quickly reverting changes if needed
   - Keep support contact information readily available

### Get support

For implementation assistance, contact [support@agora.io](mailto:support@agora.io) with your specific SDK version and region requirements.
