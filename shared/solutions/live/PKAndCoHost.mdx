## PK Battle Business Scenario

Many Customers have _<u>PK Battles</u>_ feature in their live streaming product.  it is a fun add-on to the Host(Creator)'s livestreams. On _<u>PK Battle</u>_, One Host compete with the other Host for the support of the viewers.  This is ultimate test over whose community is the strongest. 

_<u>PK Battle</u>_ is a battle between two live streams:

PK is when 2 hosts are hosting individual livestreams and then a request must be sent to each other.
This is a timed activity where you are able to go multiple rounds.
The goal is to see hose community is stronger.
ONLY TWO creators can engage in PK Battles.
The Chat is divided, and the Host can mute the other Host, so the host can focus on communicating with theirs own audiences.


As our internal integration practice, for the PK Scenario, we have below different integration solutions.

| Solution | Description | Pricing | Advantage | Disadvantage |
| :------- | :---------- | :------ | :-------- | :----------- |
| Media Relay Based Solution | Media Relay solution provide Cross-Channel Hosting In feature in the RTC SDK, it can relay the live streaming from one RTC channel to one or several RTC Channels. so this feature would be useful in PK Scenario. | In addition, We will charge Media Relay Fee. | <ul><li>Media Relay feature is available since Native SDK 3.x, this feature is more stable, and it is verified by many customers in different business scenario.</li><li>"Cross Channel Host-in" feature enhance the security</li></ul> | <ul><li>it cannot adapt to different network situation</li><li>it may cause more FHD video usage since incorrect integration</li></ul> |
| Multiple Channel Based Solution | Multiple Channel solution is easy to understand. it means each host has their own RTC channel. by default, each audience can watch their own RTC Room's Host live Streaming, and If the host is enabled PK scenario, the audience join the other Host's RTC Channel as well, and subscribe the other Host's live streaming. | It may cause more audio live streaming usage | <ul><li>No need to enable "Cross Channel Host-in" feature.</li><li>It is easy to understand and integrate</li></ul> | <ul><li>it may cause more audio usage</li><li>t is not easy to do investigation and troubleshooting</li><li>it is not verified by many customers.</li></ul> |
| Cloud Transcoder (云端合图) Based Solution | Cloud Transcoder can subscribe the Hosts' live streaming in the PK Scenario, and do UI layout and video/audio transcoding as well. Cloud Transcoder can generate different video profile streaming as expected. it means the audience in the RTC room can subscribe different video profile and bitrates according to their network situation. | In addition, we will charge Cloud Transcoder Fee. | <ul><li>It reduce the bandwidth consumption</li><li>it can generate different video resolution, it can adapt different network situation</li></ul> | <ul><li>It may be not easy to add addition UI element in the layout of Cloud Transcoder service.</li><li>it is not verified by many customers.</li></ul> |



## Media Relay Based Solution

`Cross-Channel media stream relay` feature, also called as  `Cross Channel Hosting In` feature,  is available in Native SDK, Linux SDK, and Web SDK as well. Below diagram illustrates two typical Media Relay Use Scenarios.

![Media Relay Based Solution](/images/solutions/live/media_relay_solution_diagram.png)


| Business scenario | Scenario Description |
| :---------------- | :------------------- |
| Left one is relaying one live streaming to One destination RTC channel. | **Media Relay Server A** Pull the UID 01's live streaming from Channel A, and then push the live streaming to Channel B(assume UID as '01' in Channel B). UID 02 in Channel B, subscribes UID '01''s live streaming. |
| Right one is relaying one live streaming to multiple Destination RTC Channels. | **Media Relay Server A** Pull the UID 01's live streaming from Channel A, and then push the live streaming to Channel B, Channel C, and Channel D(assume UID as '01' in Channel B,C,D). UID 02 in Channel B, UID 03 in Channel C, UID 04 in Channel D subscribe the UID '01''s live streaming respectively |


The APIs of **[Cross-Channel media stream relay](https://docs.agora.io/en/interactive-live-streaming/core-functionality/cross-channel-media-relay?platform=android)** feature are available in Native SDK 4.x, Linux SDK 4.x, and Web SDK 4.x as well. _please note that in the Linux SDK, we don't support it officially_. 


**[Channel Media Stream Relay APIs](https://api-ref.agora.io/en/video-sdk/android/4.x/API/rtc_api_overview.html#rtc_api_overview__media_stream_relay_across_channels)**
+ startOrUpdateChannelMediaRelay
+ startOrUpdateChannelMediaRelayEx
+ stopChannelMediaRelay
+ stopChannelMediaRelayEx
+ pauseAllChannelMediaRelay
+ pauseAllChannelMediaRelayEx
+ resumeAllChannelMediaRelay
+ resumeAllChannelMediaRelayEx
+ onChannelMediaRelayStateChanged


## Multiple Channel Based Solution

Multiple Channels Based solution refers to each Host has its own independent RTC Channel, and each Host and audience need to join the other Hosts' Channels according to actual business rules to complete the corresponding business.

In practice, there are different use scenarios for `Multiple Channels Based solution`. Here we describe Multi-Channel Switching solution in tiktok-like app.



## Cloud Transcoder (云端合图) Based Solution

Cloud Transcoder, also known as "[Cloud Transcoding](https://docs-preprod.agora.io/en/live-streaming-premium-legacy/cloud_transcoder?platform=iOS)",  [Cloud Transcoder](https://docs-preprod.agora.io/en/live-streaming-premium-legacy/cloud_transcoder?platform=iOS) is Cloud based transcoding service for audio and video live streaming scenarios. It can pull specific audio and video streams (one or multiple) from the server side, and process them with audio mixing, video layout composition, Codec transcoding, and other treatments before publishing them to the RTC channel for subscription by the Audience side. It is generally used to solve the following problems:

+ Problem 1: Some audiences' devices have poor performance and cannot process multiple high-definition audio and video streams simultaneously on the end (such as encoding, decoding, rendering, etc.). It is necessary to merge the streams in the cloud and then push them back to the channel to reduce the performance consumption on the end.
+ Problem 2: Some audiences downstream networks are poor, and when subscribing to multiple anchor/Host video streams or a single anchor/Host high-definition video stream, there may be stuttering and other phenomena that affect the audience experience. By merging the streams in the cloud or converting them to lower bitrates before delivering them, the bitrate can be reduced, thus improving the viewer experience.

>*please note Cloud Transcoder is still beta product.*
