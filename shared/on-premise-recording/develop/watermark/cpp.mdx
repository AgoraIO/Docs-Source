<PlatformWrapper platform="linux-cpp">

To add or update a watermark in composite recording mode, call `enableAndUpdateVideoWatermarks` and pass an array of watermark configuration objects. Each object defines one watermark, including its type, content, position, and appearance. To remove all watermarks, call `disableVideoWatermarks`.

<Admonition type="info" info="info">
To use watermarks in individual recording mode, call `enableAndUpdateVideoWatermarksByUid` and `disableVideoWatermarksByUid` instead.
</Admonition>

### Add a text watermark

To add a text watermark:

1. Call `enableAndUpdateVideoWatermarks` and pass the `watermark_configs` array.
2. Set the watermark type to `LITERA`:

   ```cpp
   watermarks[i].type = agora::rtc::LITERA;
   ```

3. Configure the text, font path, and font size:

   ```cpp
   watermarks[i].literaSource.wmLitera = "Agora watermark example";
   watermarks[i].literaSource.fontFilePath = "path/to/font.ttf"; // Optional
   watermarks[i].literaSource.fontSize = 24;
   ```

### Add a timestamp watermark

To add a timestamp watermark:

1. Call `enableAndUpdateVideoWatermarks` and pass the `watermark_configs` array.
2. Set the watermark type to `TIMESTAMPS`:

   ```cpp
   watermarks[i].type = agora::rtc::TIMESTAMPS;
   ```

3. Configure the font path and size:

   ```cpp
   watermarks[i].timestampSource.fontFilePath = "path/to/font.ttf"; // Optional
   watermarks[i].timestampSource.fontSize = 20;
   ```

### Add an image watermark

To add an image watermark:

1. Call `enableAndUpdateVideoWatermarks` and pass the `watermark_configs` array.
2. Set the watermark type to `PICTURE`:

   ```cpp
   watermarks[i].type = agora::rtc::PICTURE;
   ```

3. Set the image path:

   ```cpp
   watermarks[i].imageUrl = "path/to/watermark.png";
   ```

### Set the watermark position

You can set watermark positions using either absolute pixels or relative ratios. You can also define separate positions for portrait and landscape orientations.

#### Fixed position (pixels)

- Portrait mode

    ```cpp
    // Use fixed-pixel positioning
    watermarks[i].options.mode = agora::rtc::FIT_MODE_COVER_POSITION;
    watermarks[i].options.zOrder = 1;

    watermarks[i].options.positionInPortraitMode.x = 50;
    watermarks[i].options.positionInPortraitMode.y = 50;
    watermarks[i].options.positionInPortraitMode.width = 200;
    watermarks[i].options.positionInPortraitMode.height = 100;
    ```

- Landscape mode

    ```cpp
    // Use fixed-pixel positioning
    watermarks[i].options.mode = agora::rtc::FIT_MODE_COVER_POSITION;
    watermarks[i].options.zOrder = 1;

    watermarks[i].options.positionInLandscapeMode.x = 50;
    watermarks[i].options.positionInLandscapeMode.y = 50;
    watermarks[i].options.positionInLandscapeMode.width = 200;
    watermarks[i].options.positionInLandscapeMode.height = 100;
    ```

#### Relative position (ratio)

```cpp
// Use ratio-based positioning
watermarks[i].options.mode = agora::rtc::FIT_MODE_USE_IMAGE_RATIO;
watermarks[i].options.zOrder = 1;

watermarks[i].options.watermarkRatio.xRatio = 0.5;
watermarks[i].options.watermarkRatio.yRatio = 0.5;
watermarks[i].options.watermarkRatio.widthRatio = 0.6;
```

### Complete sample

<details>
<summary>Full example for adding watermarks</summary>

```cpp
if (!recorderConfig.waterMark.empty()) {
  std::vector<WatermarkConfig> watermarks(recorderConfig.waterMark.size());

  for (size_t i = 0; i < watermarks.size(); ++i) {
    const WatermarkInfo& info = recorderConfig.waterMark[i];
    watermarks[i].index = static_cast<int>(i + 1);
    watermarks[i].type = convertToWatermarkSourceType(info.type);

    if (watermarks[i].type == agora::rtc::LITERA) {
      watermarks[i].literaSource.wmLitera = info.litera;
      watermarks[i].literaSource.fontFilePath = info.fontFilePath;
      watermarks[i].literaSource.fontSize = info.fontSize;

    } else if (watermarks[i].type == agora::rtc::TIMESTAMPS) {
      watermarks[i].timestampSource.fontFilePath = info.fontFilePath;
      watermarks[i].timestampSource.fontSize = info.fontSize;

    } else if (watermarks[i].type == agora::rtc::PICTURE) {
      watermarks[i].imageUrl = info.imgUrl;
    }

    watermarks[i].options.mode = agora::rtc::FIT_MODE_COVER_POSITION;
    watermarks[i].options.zOrder = info.zOrder;

    watermarks[i].options.positionInPortraitMode = {
      info.x, info.y, info.width, info.height
    };

    watermarks[i].options.positionInLandscapeMode = {
      info.x, info.y, info.width, info.height
    };
  }

  recorder->enableAndUpdateVideoWatermarks(watermarks.data(), watermarks.size());
}
```
</details>

## Reference

This section contains content that completes the information on this page, or points you to documentation that explains other aspects to this product.

### API references

- [`WatermarkLitera`](/on-premise-recording/reference/api-reference#watermarklitera)
- [`enableAndUpdateVideoWatermarks`](/on-premise-recording/reference/api-reference#enableandupdatevideowatermarks)
- [`WatermarkTimestamp`](/on-premise-recording/reference/api-reference#watermarktimestamp)
- [`WatermarkOptions`](/on-premise-recording/reference/api-reference#watermarkoptions)
- [`Rectangle`](/on-premise-recording/reference/api-reference#rectangle)
- [`WatermarkRatio`](/on-premise-recording/reference/api-reference#watermarkratio)

</PlatformWrapper>
