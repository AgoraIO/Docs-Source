import * as data from '@site/data/variables';
import Authorization from '@docs/shared/chat-sdk/restful-api/shared/authorization.mdx';

<PlatformWrapper platform="web">
Push notifications are not available for Web.
</PlatformWrapper>

<PlatformWrapper notAllowed="web">

This page shows how to call Chat RESTful APIs to set the display name, display style, push notification mode, and do-not-disturb (DND) mode.

Before calling the following methods, ensure that you meet the following:
- You understand the call frequency limit of the Chat RESTful APIs as described in <Link to="../reference/limitations#call-limit-of-server-sides">Limitations</Link>.

- You have activated the advanced features for push in <Link to="{{Global.AGORA_CONSOLE_URL}}"><Vg k="CONSOLE" /></Link>. Advanced features allow you to set the push notification mode, do-not-disturb mode, and custom push template.

<div class="alert note">You must contact <a href="mailto:support@agora.io">support@agora.io</a> to disable the advanced features for push as this operation will delete all the relevant configurations.</div>

## Common parameters

The following table lists common request and response parameters of the Chat RESTful APIs:

### Request parameters <a name="request"></a>

| Parameter | Type | Description | Required |
| :--------- | :----- | :----- | :----- |
| `host` | String | The domain name assigned by the Chat service to access RESTful APIs. For how to get the domain name, see [Get the information of your project](/agora-chat/get-started/enable#get-the-information-of-the-agora-chat-project). | Yes |
| `org_name` | String | The unique identifier assigned to each company (organization) by the Chat service. For how to get the org name, see [Get the information of the Chat project](/agora-chat/get-started/enable#get-the-information-of-the-agora-chat-project). | Yes |
| `app_name` | String | The unique identifier assigned to each app by the Chat service. For how to get the app name, see [Get the information of the Chat project](/agora-chat/get-started/enable#get-the-information-of-the-agora-chat-project). | Yes |
| `username` | String | The unique login account of the user.  | Yes |

### Response parameters <a name="response"></a>

|  Parameter  |  Type  |  Description  |
| :-------- | :--------- | :--------- |
| `action` | String | The request method.   |
| `organization` | String | The unique identifier assigned to each company (organization) by the Chat service. This is the same as `org_name`.    |
| `application` | String | A unique internal ID assigned to each app by the Chat service. You can safely ignore this parameter.     |
| `applicationName`  | String | The unique identifier assigned to each app by the Chat service. This is the same as `app_name`.       |
| `timestamp`  | Number |  The Unix timestamp (ms) of the HTTP response.    |
| `duration`  | Number | The duration (ms) from when the HTTP request is sent to the time the response is received.    |
| `path`  | String | The request path, which is part of the request URL. You can safely ignore this parameter.    |
| `uri`  | String | The request URI.   |
| `entities`  | JSON | The response entities.  |
| `data`  | JSON | The response details.  |

## Authorization

<Authorization />

## Bind or unbind push information

To push messages, you need to bind push information to the device, including the device ID, push certificate, and device token.

- Device ID: The unique identifier assigned by the SDK to each device.
- Device token: The push token is provided by a third-party push service to identify the app on each device. For example, for the Firebase Cloud Messaging (FCM) push, the device token refers to the registration token that the FCM SDK generates for the client app instance during the first launch of the app. With this token, the third-party push service determines which device the message is sent to, and then sends the message. Upon receiving the message, the device forwards it to the app.
- Push certificate: The push certificate provided by a third-party push service. Each app has one push certificate.

You can obtain the device token and push certificate name from the third-party push server and upload them to the Chat server which pushes messages to users based on the device token.

You can call this API to bind the push information to the device or unbind them from the device.

### HTTP request

```html
PUT https://{host}/{org_name}/{app_name}/users/{username}/push/binding
```

#### Path parameter

For the descriptions of path parameters, see [Common Parameters](#param).

#### Request header

| Parameter | Type | Description | Required |
|:---------------| :------ | :------- |:------------------|
| `Content-Type` | String | The content type. Set it to `application/json`.  | Yes |
| `Authorization` | String | The authentication token of the app administrator, in the format of `Bearer ${YourAppToken}`, where `Bearer` is a fixed character, followed by an English space, and then the obtained token value. | Yes |

### Request body

| Parameter | Type | Description | Required |
|:---------------| :------ | :------- |:------------------|
| `device_id`     | String | The identifier of a mobile device assigned by the SDK. With the device ID, the Chat server identifies the mobile device before binding or unbinding push information.   | Yes      |
| `notifier_name` | String | The push certificate name: <ul><li>The certificate name you pass in must be the same as the value of `Certificate Name` for FCM or APNs in the **Add Push Certificate** dialog box on the [Agora Console](https://console.agora.io/). Otherwise, the push fails. </li><li>If `notifier_name` is empty, all push information is unbound from the mobile device.</li></ul> | Yes    |
| `device_token`  | String | The device token. If an incorrect device token is passed in, the push fails and the Chat server unbinds the device token from the device. If `device_token` is empty, the Chat server unbinds the current certificate name from the current device.  | Yes       |

### HTTP response

#### Response body

If the returned HTTP status code is `200`, the request succeeds, and the response body contains the following fields:

| Parameter | Type | Description |
| :---- | :----- | :------------------- |
| `entities`  | JSONArray  | The list of push information bound to the current device. For the device that is not bound to any push information, an empty list is returned to the binding request that is sent.|

The `device_id`, `device_token`, and `notifier_name` in the `entities` JSON array in the response have the same meanings as those in the request body of the HTTP request. For details, see parameters in the request body.

For other fields and descriptions, see [Common parameters](#param).

### Example

#### Request example

**Bind push information to a device**

```shell
curl --location --request PUT 'https://XXXX/XXXX/XXXX/users/XXXX/push/binding' \
-H 'Content-Type: application/json' \
-H 'Authorization: Bearer <YourAppToken>' \
-d '{
    "device_id": "8ce08cad-XXXX-XXXX-86c8-695a0d247cda",
    "device_token": "XXXX",
    "notifier_name": "104410638"
}'
```

**Unbind push information from the device**

```shell
curl --location --request PUT 'https://XXXX/XXXX/XXXX/users/XXXX/push/binding' \
-H 'Content-Type: application/json' \
-H 'Authorization: Bearer <YourAppToken>' \
-d '{
    "device_id": "8ce08cad-XXXX-XXXX-86c8-695a0d247cda",
    "device_token": "",
    "notifier_name": "104410638"
}'
```

#### Response example

**Response to a binding request**

```json
{
  "timestamp": 1688030642443,
  "entities": [
    {
      "device_id": "8ce08cad-9369-XXXX-86c8-695a0d247cda",
      "device_token": "BAEAAAAAB.jkuDmf8hRUPDgOel-zX9exVlcjS1akCWQIUA3XXXX_XXXXHMeFR11PV1of1sVNKPmKdKhMB22YuO8-Z_Ksoqxo8Y",
      "notifier_name": "104410638"
    }
  ],
  "action": "put",
  "duration": 28
}
```

**Response to an unbinding request**

```json
{
  "timestamp": 1688030767345,
  "entities": [],
  "action": "put",
  "duration": 24
}
```

## Retrieve the push information bound to devices of a user

Retrieves the push information bound to all devices of the current user.

### HTTP request

```html
GET https://{host}/{org_name}/{app_name}/users/{username}/push/binding
```

#### Path parameter

For the descriptions of path parameters, see [Common Parameters](#param).

#### Request header

| Parameter | Type | Description | Required |
|:---------------| :------ | :------- |:------------------|
| `Authorization` | String | The authentication token of the app administrator, in the format of `Bearer ${YourAppToken}`, where `Bearer` is a fixed character, followed by an English space, and then the obtained token value. | Yes      |

### HTTP response

#### Response body

If the returned HTTP status code is `200`, the request succeeds, and the response body contains the following parameters:

| Parameter | Type | Description |
| :----- | :--- | :----------- |
| `entities` | JSONArray | The list of push information bound to all devices of the current user. If the current user has no device bound to any push information, an empty list is returned. |

The `device_id`, `device_token`, and `notifier_name` in the `entities` JSON array in the response have the same meanings as those in the request body of the HTTP request. For details, see parameters in the request body.

For the other parameters and descriptions, see [Common parameters](#param).

### Example

#### Request example

```shell
curl --location --request GET 'https://XXXX/XXXX/XXXX/users/XXXX/push/binding' \
-H 'Authorization: Bearer <YourAppToken>'
```

#### Response example

```json
{
  "timestamp": 1688031327535,
  "entities": [
    {
      "device_id": "8ce08cad-9369-4bdd-XXXX-695a0d247cda",
      "device_token": "BAEAAAAAB.jkuDmf8hRUPDgOel-zX9exVlcjS1akCWQIUA3XXXX_XXXXHMeFR11PV1of1sVNKPmKdKhMB22YuO8-Z_Ksoqxo8Y",
      "notifier_name": "104410638"
    }
    {
      "device_id": "8ce08cad-9369-4bdd-XXXX-695a0d247cda",
      "device_token": "BAEAAAAAB.jkuDmf8hRUPDgOel-zX9exVlcjS1akCWQIUA3XXXX_XXXXHMeFR11PV1of1sVNKPmKdKhMB22YuO8-Z_Ksoqxo8Y",
      "notifier_name": "104410638"
    }
  ],
  "action": "get",
  "duration": 6
}
```

## Set the display style in push notifications

Sets the display style of push notifications.

For each App Key, the total call frequency limit of this method and the method to set the display name is 100 per second.

### HTTP request

```html
PUT https://{host}/{org_name}/{app_name}/users/{username}
```

#### Path parameter

For the descriptions of path parameters, see [Common Parameters](#request).

#### Request header

| Parameter | Type | Description | Required |
| :----- | :----- | :------- | -------- |
| `Content-Type	` | String | Content type. Please fill in `application/json`.| Yes |
| `Authorization` | String | The authentication token of the user or administrator, in the format of `Bearer ${YourAppToken}`, where `Bearer` is a fixed character, followed by an English space, and then the obtained token value. | Yes |

#### Request body

| Parameter | Type | Description | Required |
| :----- | :----- | :------- | -------- |
| `notification_display_style` | Int | The display style of push notifications:<li>(Default) `0`: The push title is "You have a new message", and the push content is "Click to check".</li><li>`1`: The push title is "You have a new message", and the push content contains the nickname of the sender and the content of the offline message.</li>  | Yes  |

### HTTP response

#### Response body

If the returned HTTP status code is `200`, the request succeeds, and the response body contains the following fields:

|  Parameter  |  Type  |  Description  |
| :-------- | :------- | :------- |
| `entities` | JSON Array | How users' offline push notifications are displayed and related information.. |
|  `uuid` | String | A unique internal identifier generated by the Chat service for the user in this request. |
| `type`  | String | The type of the chat. "user" indicates a One-to-one chat. |
| `created`  | Number | The Unix timestamp (ms) when the user account is registered.  |
| `modified`  | Number | The Unix timestamp (ms) when the user information is last modified.  |
| `username`  | String | The ID of the user. |
| `activated`  | Bool | Whether the user account is active:<li>`true`: The user account is active.</li><li>`false`: The user account is deactivated. To unban a deactivated user account, refer to [Unbanning a user](user-system-registration#unbanning-a-user).</li> |
| `notification_no_disturbing`  | Bool | Whether to set to do not disturb mode:<li>`true`: yes</li><li>`false`: no</li> |
| `notification_no_disturbing_start`  | int | The start time of the do not disturb period. |
| `notification_no_disturbing_end`  | int | The end time of the do not disturb period. |
| `notification_display_style`  |  Int  | The display style of push notifications. This parameter is returned only if you specify it when sending the request. |
| `nickname`  | String | The nickname displayed in push notifications. |
| `notifier_name` | String  | The name of the push certificate. |

For other fields and detailed descriptions, see [Common parameters](#response).

If the returned HTTP status code is not `200`, the request fails. You can refer to [Status codes](#status-codes) for possible reasons.

### Example

#### Request example

```bash
curl -X PUT -H "Authorization: Bearer <YourAppToken>" -i https://XXXX/XXXX/XXXX/users/a -d '{"notification_display_style": "1"}'
```

#### Response example

```json
{
  "action": "put",
  "application": "17d59e50-XXXX-XXXX-XXXX-0dc80c0f5e99",
  "path": "/users",
  "uri": "https://XXXX/XXXX/XXXX/users",
  "entities": [
    {
      "uuid": "3b8c9890-XXXX-XXXX-XXXX-f50bf55cafad",
      "type": "user",
      "created": 1530276298905,
      "modified": 1534407146060,
      "username": "user1",
      "activated": true,
      "notification_no_disturbing": false,
      "notification_no_disturbing_start": 1,
      "notification_no_disturbing_end": 3,
      "notification_display_style": 1,
      "nickname": "testuser",
      "notifier_name": "2882303761517426801"
    }
  ],
  "timestamp": 1534407146058,
  "duration": 3,
  "organization": "1112171214115068",
  "applicationName": "testapp"
}
```


## Set up push notifications

Sets the push notification and DND modes at both the app and conversation levels.

For each App Key, the call frequency limit of this method is 100 per second.

### HTTP request

```html
PUT https://{host}/{org}/{app}/users/{username}/notification/{chattype}/{key}
```

#### Path parameter

| Parameter | Type | Description | Required |
| :----- | :----- | :------- | -------- |
| `chattype` | String | The type of the chat:<li>`user`: One-to-one chats.</li><li>`chatgroup`: Group chats.</li>  | Yes |
| `key` | String | The identifier of the chat:<li>If `type` is set to `user`, `key` indicates the user ID of the peer user.</li><li>If `type` is set to `chatgroup`, `key` indicates the ID of the chat group.</li> | Yes |

<Admonition type="info" title="Hint">
To set up push notifications at the app level, you can set <code>type</code> to <code>user</code> and <code>key</code> to the user ID of the current user.
</Admonition>
For the descriptions of other path parameters, see [Common Parameters](#request).

#### Request header

| Parameter | Type | Description | Required |
| :----- | :----- | :------- | -------- |
| `Content-Type` | String | The content type. Set it as `application/json`.   | Yes  |
| `Authorization` | String | The authentication token of the user or administrator, in the format of `Bearer ${YourAppToken}`, where `Bearer` is a fixed character, followed by an English space, and then the obtained token value. | Yes |

#### Request body


| Parameter | Type | Description | Required |
| :----- | :----- | :------- | -------- |
| `type` | String | The push notification mode:<ul><li>`DEFAULT`: A specific conversation uses the setting at the app level. This parameter is valid only for one-to-one and group chat conversations, but not for the app level.</li> <li>`ALL`: Receives push notifications for all offline messages.</li><li>`AT`: Only receives push notifications for mentioned messages.</li><li>`NONE`: Do not receive push notifications for offline messages.</li> </ul> <Admonition type="alert" title="Note"> If this parameter is set for both the app and the specified session, the session adopts its own settings, and other sessions adopt the app's settings.</Admonition> | No |
| `ignoreInterval` | String | The interval during which the DND mode is scheduled everyday. The value is in the format of `{HH:MM-HH:MM}`, for example, 08:30-10:00, where HH ranges from `00` to `23` in hour and MM from `00` to `59` in minute. <ul><li>This parameter works only when `chattype` is set to `user` and `key` to the current user ID in the request header, meaning that the DND interval is valid only for the entire app rather than specific one-to-one or group chat conversations.</li><li>The DND mode is enabled everyday in the specified interval. For example, if you set this parameter to 08:00-10:00, the app stays in DND mode during 8:00-10:00; if you set the same period at 9:00, the DND mode works during 9:00-10:00 on the current day and 8:00-10:00 in later days.</li><li>If the start time is set to the same time spot as the end time, like 00:00-00:00, the app enters the permanent DND mode.</li><li>If the start time is later than the end time, the app remains in DND mode from the start time on the current day until the end time next day. For example, if you set 10:00-08:00, the DND mode lasts from 10:00 until 08:00 the next day. </li><li> Currently, only one DND interval is allowed, with the new setting overwriting the old.</li><li>If this parameter is not specified, pass in an empty string.</li><li> If both `ignoreInterval` and `ignoreDuration` are set, the DND mode works in both periods. For example, at 8:00, you set `ignoreInterval` to 8:00-10:00 and `ignoreDuration` to 14400000 (4 hours) for the app, the app stays in DND mode during 8:00-12:00 on the current day and 8:00-10:00 in the later days.</li></ul>  | No |
| `ignoreDuration` | Number   | The DND duration in milliseconds. The value range is [0,604800000], where `0` indicates that this parameter is invalid and `604800000` indicates that the DND mode lasts for 7 days. <ul><li>This parameter works for both the app and one-to-one and group chat conversations in it. </li><li> Unlike `ignoreInterval` set as a daily period, this parameter specifies that the DND mode works only for the given duration starting from the current time. For example, if this parameter is set to 14400000 (4 hours) for the app at 8:00, the DND mode lasts only during 8:00-12:00 on the current day.</li><li> If both `ignoreInterval` and `ignoreDuration` are set, the DND mode remains in both periods. For example, at 8:00, you set `ignoreInterval` to 8:00-10:00 and `ignoreDuration` to 14400000 (4 hours) for the app, the app stays in DND mode during 8:00-12:00 on the current day and 8:00-10:00 in the later days.</li></ul> | No  |

<Admonition type="info" title="Hint">
For both the app and all the conversations in the app, the DNS mode setting (`ignoreInterval` or `ignoreDuration`) takes precedence over the setting of the push notification mode (`type`). For example, assume that `ignoreInterval` or `ignoreDuration` is specified at the app level and `type` is set to `ALL` for a specific conversation. The app enters the DND mode during the designated period and you do not receive any push notifications during the period.
</Admonition>

### HTTP response

#### Response body

If the returned HTTP status code is `200`, the request succeeds, and the response body contains the following fields:

|  Parameter  |  Type  |  Description  |
| :-------- | :------- | :------- |
| `data`  | JSON | Offline push settings.|
| `data.type`  | String | The push notification mode. |
| `data.ignoreInterval`  | String | The DND time frame.  |
| `data.ignoreDuration`  | Long | The DND duration. |

For other fields and detailed descriptions, see [Common parameters](#response).

If the returned HTTP status code is not `200`, the request fails. You can refer to [Status codes](#status-codes) for possible reasons.

### Example

#### Request example

```bash
curl -L -X PUT 'http://XXXX/XXXX/XXXX/users/{username}/notification/user/{key}' \
-H 'Authorization: Bearer <YourAppToken>' \
-H 'Content-Type: application/json' \
--data-raw '{
    "type":"NONE",
    "ignoreInterval":"21:30-08:00",
    "ignoreDuration":86400000
}'
```

#### Response example

```json
{
    "path": "/users",
    "uri": "https://XXXX/XXXX/XXXX/users/notification/user/hxtest",
    "timestamp": 1647503749918,
    "organization": "XXX",
    "application": "17fe201b-XXXX-XXXX-83df-1ed1ebd7b227",
    "action": "put",
    "data": {
        "type": "NONE",
        "ignoreDuration": 1647590149924,
        "ignoreInterval": "21:30-08:00"
    },
    "duration": 20,
    "applicationName": "XXXX"
}
```


## Retrieve the settings of push notifications

Retrieves the push notification and DND modes at both the app and conversation levels.

For each App Key, the call frequency limit of this method is 100 per second.

### HTTP request

```html
GET https://{host}/{org_name}/{app_name}/users/{username}/notification/{chattype}/{key}
```

#### Path parameter

| Parameter | Type | Description | Required |
| :----- | :----- | :------- | -------- |
| `chattype` | String | The type of the chat:<li>`user`: One-to-one chats.</li><li>`chatgroup`: Group chats.</li>  | Yes |
| `key` | String | <li>The user ID of the peer user when chatting alone;</li><li>The group ID when chatting in a group.</li> | Yes |

For the descriptions of other path parameters, see [Common Parameters](#request).

#### Request header

| Parameter | Type | Description | Required |
| :----- | :----- | :------- | -------- |
| `Authorization` | String | The authentication token of the user or administrator, in the format of `Bearer ${YourAppToken}`, where `Bearer` is a fixed character, followed by an English space, and then the obtained token value. | Yes |

### HTTP response

#### Response body

If the returned HTTP status code is `200`, the request succeeds, and the response body contains the following fields:

|  Parameter  |  Type  |  Description  |
| :-------- | :------- | :------- |
| `data`  | JSON | Offline push settings.|
| `data.type`  | String | The push notification mode. |
| `data.ignoreInterval`  | String | The DND time frame.  |
| `data.ignoreDuration`  | Long | The DND duration. |

For other fields and detailed descriptions, see [Common parameters](#response).

If the returned HTTP status code is not `200`, the request fails. You can refer to [Status codes](#status-codes) for possible reasons.

### Example

#### Request example

```bash
curl -L -X GET 'https://XXXX/XXXX/XXXX/users/{username}/notification/chatgroup/{key}' \
-H 'Authorization: Bearer <YourAppToken>'
```

#### Response example

```json
{
  "path": "/users",
  "uri": "https://XXXX/XXXX/XXXX/users/notification/chatgroup/12312312321",
  "timestamp": 1647503749918,
  "organization": "hx",
  "application": "17fe201b-XXXX-XXXX-XXXX-1ed1ebd7b227",
  "action": "get",
  "data": {
    "type": "NONE",
    "ignoreDuration": 1647590149924,
    "ignoreInterval": "21:30-08:00"
  },
  "duration": 20,
  "applicationName": "hxdemo"
}
```


## Set the preferred language of push notifications

Sets the preferred language of push notifications.

For each App Key, the call frequency limit of this method is 100 per second.

### HTTP request

```html
PUT https://{host}/{org_name}/{app_name}/users/{username}/notification/language
```

#### Path parameter

For the descriptions of path parameters, see [Common Parameters](#request).

#### Request header

| Parameter | Type | Description | Required |
| :----- | :----- | :------- | -------- |
| `Content-Type` | String | The content type. Set it as `application/json`.   | Yes |
| `Authorization` | String | The authentication token of the user or administrator, in the format of `Bearer ${YourAppToken}`, where `Bearer` is a fixed character, followed by an English space, and then the obtained token value. | Yes |

#### Request body

| Parameter | Type | Description | Required |
| :----- | :----- | :------- | -------- |
| `translationLanguage` | String | The code for the language that the user prefers to see push notifications in. If set to an empty string, the server pushes the notifications of the original language directly.  | Yes |

### HTTP response

#### Response body

If the returned HTTP status code is `200`, the request succeeds, and the response body contains the following fields:

|  Parameter  |  Type  |  Description  |
| :-------- | :------- | :------- |
| `data`  | String | The user's preferred language for receiving push notifications. |
| `language`  | String | The code for the language that the user prefers to see push notifications in. |

For other fields and detailed descriptions, see [Common parameters](#response).

If the returned HTTP status code is not `200`, the request fails. You can refer to [Status codes](#status-codes) for possible reasons.

### Example

#### Request example

```bash
curl -L -X PUT 'https://XXXX/XXXX/XXXX/users/{username}/notification/language' \
-H 'Authorization: Bearer <YourAppToken>' \
-H 'Content-Type: application/json' \
--data-raw '{
    "translationLanguage":"EU"
}'
```

#### Response example

```json
{
  "path": "/users",
  "uri": "https://XXXX/XXXX/XXXX/users/notification/language",
  "timestamp": 1648089630244,
  "organization": "hx",
  "application": "17fe201b-XXXX-XXXX-XXXX-1ed1ebd7b227",
  "action": "put",
  "data": {
    "language": "EU"
  },
  "duration": 66,
  "applicationName": "hxdemo"
}
```


## Retrieve the preferred language of push notifications

Retrieves the preferred language of push notifications.

For each App Key, the call frequency limit of this method is 100 per second.

### HTTP request

```html
GET https://{host}/{org}/{app}/users/{username}/notification/language
```

#### Path parameter

For the descriptions of path parameters, see [Common Parameters](#request).

#### Request header

| Parameter | Type | Description | Required |
| :----- | :----- | :------- | -------- |
| `Content-Type` | String | The content type. Set it as `application/json`.   | Yes |
| `Authorization` | String | The authentication token of the user or administrator, in the format of `Bearer ${YourAppToken}`, where `Bearer` is a fixed character, followed by an English space, and then the obtained token value. | Yes |

### HTTP response

#### Response body

If the returned HTTP status code is `200`, the request succeeds, and the response body contains the following fields:

|  Parameter  |  Type  |  Description  |
| :-------- | :------- | :------- |
| `data`  | JSON | The user's preferred language for receiving push notifications. |
| `data.language`  | JSON | The code for the language that the user prefers to see push notifications in. |

For other fields and detailed descriptions, see [Common parameters](#response).

If the returned HTTP status code is not `200`, the request fails. You can refer to [Status codes](#status-codes) for possible reasons.

### Example

#### Request example

```bash
curl -L -X GET 'https://XXXX/XXXX/XXXX/users/{username}/notification/language' \
-H 'Authorization: Bearer <YourAppToken>'
```

#### Response example

```json
{
    "path": "/users",
    "uri": "https://XXXX/XXXX/XXXX/users/notification/language",
    "timestamp": 1648089630244,
    "organization": "XXXX",
    "application": "17fe201b-XXXX-XXXX-83df-1ed1ebd7b227",
    "action": "put",
    "data": {
        "language": "EU"
    },
    "duration": 66,
    "applicationName": "XXXX"
}
```

## Use push templates

You can utilize push templates to customize push titles and content. To configure both the default push template and custom push templates, you can make API calls to the following REST endpoint. Additionally, you have the option to set push templates using <Link to="{{Global.AGORA_CONSOLE_URL}}"><Vg k="CONSOLE" /></Link>.

Using push templates offers several advantages:

Customize and modify the default push content provided by the Chat SDK.

1. Allow recipients to choose which template to use.
1. Determine template usage by priority.
1. Priority of push notification bar content settings:

The push title and content displayed in the notification bar can be set with the following priorities, from lowest to highest:

1. Utilize the default push title and content when sending messages: Set the notification display style (`notification_display_style`). The default push title is "You have a new message," and the push content is "Please click to view."
1. Use the default template when sending messages: If a default template named `default` exists, there's no need to specify it when sending messages.
1. Customize the push title and push content using extension fields when sending a message, such as `em_push_title` and `em_push_content`.
1. Allow the receiver to set a push template.
1. Specify the template name via the message extension field when sending a message.


## Create a push template

Create offline push message templates, including default template default and custom templates. When using the default template, it will automatically be applied to push messages, eliminating the need to specify the template name when creating messages.

For each App Key, the call frequency limit of this method is 100 per second.

### HTTP request

```html
POST https://{host}/{org}/{app}/notification/template
```

#### Path parameter

For the descriptions of path parameters, see [Common Parameters](#request).

#### Request header

| Parameter | Type | Description | Required |
| :----- | :----- | :------- | -------- |
| `Content-Type` | String | The content type. Set it as `application/json`.   | Yes |
| `Authorization` | String | The authentication token of the user or administrator, in the format of `Bearer ${YourAppToken}`, where `Bearer` is a fixed character, followed by an English space, and then the obtained token value. | Yes |

#### Request body

| Parameter | Type | Description | Required |
| :----- | :----- | :------- | -------- |
| `name` | String | The name of the push template to add. The template name can contain up to 64 characters, and the following character sets are supported: <li>26 lowercase English letters az;</li><li>26 uppercase English letters AZ;</li><li>10 numbers 0-9.</li> | Yes |
| `title_pattern` | String | Customize the push title, for example: Title {0}.	 | Yes |
| `content_pattern` | String | Custom push content, for example: content {0}, {1}.	 | Yes |

The `title_pattern` and `content_pattern` are set as follows:

- Fixed content: For example, set the title as "Hello" and the content as "You have a new message."
- Built-in parameter filling:
    - `{$dynamicFrom}`: Fills in friend notes, group nicknames (only for group messages), and push nicknames in order of priority.
    - `{$fromNickname}`: Push nickname.
    - `{$msg}`: Message content.
- Custom parameter filling: Use template input array index placeholders in the format `{0}`, `{1}`, `{2}`, ..., `{n}`.

For the push title and content, the first two setting methods do not require passing this parameter when creating the message; the server automatically obtains it. However, the third setting method requires passing it through the extended field `ext.em_push_template` in the JSON structure.

```json
{
    "ext": {
        "em_push_template": {
            "title_args": [
                "Agora Chat SDK"
            ],
            "content_args": [
                "Welcome to use im-push",
                "Keep it up"
            ]
        }
    }
}

# title: {0} = "Agora Chat SDK"
# content: {0} = "Welcome to use im-push", {1} = "Keep it up"
```
### HTTP response

#### Response body

If the returned HTTP status code is `200`, the request succeeds, and the response body contains the following fields:

|  Parameter  |  Type  |  Description  |
| :-------- | :------- | :------- |
| `data`  | JSON	 | Push template related information. |
| `data.name`  | String | The name of the push template. |
| `data.createAt`  | Number | The Unix timestamp (ms) when the template is created. |
| `data.updateAt`  | Number | The Unix timestamp (ms) when the template is last modified. |
| `data.title_pattern`  | String | The custom title of the push template. |
| `content_pattern`  | String | The custom content of the push template. |

For other fields and detailed descriptions, see [Common parameters](#response).

If the returned HTTP status code is not `200`, the request fails. You can refer to [Status codes](#status-codes) for possible reasons.

### Example

#### Request example

```bash
curl -X POST 'https://XXXX/XXXX/XXXX/notification/template' \
-H 'Authorization: Bearer <YourAppToken>' \
-H 'Content-Type: application/json' \
--data-raw '{
    "name": "test7",
    "title_pattern": "Hello,{0}",
    "content_pattern": "Test,{0}"
}'
```

#### Response example

```json
{
    "uri": "https://XXXX/XXXX/XXXX/notification/template",
    "timestamp": 1646989584108,
    "organization": "XXXX",
    "application": "17fe201b-XXXX-XXXX-83df-1ed1ebd7b227",
    "action": "post",
    "data": {
        "name": "test7",
        "createAt": 1646989584124,
        "updateAt": 1646989584124,
        "title_pattern": "Hello,{0}",
        "content_pattern": "Test,{0}"
    },
    "duration": 26,
    "applicationName": "XXXX"
}
```

## Retrieve a push template

Retrieves the specified template for push notifications.

For each App Key, the call frequency limit of this method is 100 per second.

### HTTP request

```html
GET https://{host}/{org}/{app}/notification/template/{name}
```

#### Path parameter

| Parameter | Type | Description | Required |
| :----- | :----- | :------- | -------- |
| `name` | String | The name of the push template.  | Yes |

For the descriptions of other path parameters, see [Common Parameters](#request).

#### Request header

| Parameter | Type | Description | Required |
| :----- | :----- | :------- | -------- |
| `Content-Type` | String | Content type. Please fill in `application/json`. | Yes |
| `Authorization` | String | The authentication token of the user or administrator, in the format of `Bearer ${YourAppToken}`, where `Bearer` is a fixed character, followed by an English space, and then the obtained token value. | Yes |

### HTTP response

#### Response body

If the returned HTTP status code is `200`, the request succeeds, and the response body contains the following fields:

|  Parameter  |  Type  |  Description  |
| :-------- | :------- | :------- |
| `data`  | JSON | Push template related information. |
| `data.name`  | String | The name of the push template. |
| `data.createAt`  | Number | The Unix timestamp (ms) when the template is created. |
| `data.updateAt`  | Number | The Unix timestamp (ms) when the template is last modified. |
| `data.title_pattern`  | String | The custom title of the push template. |
| `data.content_pattern`  | String | The custom content of the push template. |

For other fields and detailed descriptions, see [Common parameters](#response).

If the returned HTTP status code is not `200`, the request fails. You can refer to [Status codes](#status-codes) for possible reasons.

### Example

#### Request example

```bash
curl -X GET 'https://XXXX/XXXX/XXXX/notification/template/{name}' \
-H 'Authorization: Bearer <YourAppToken>'
```

#### Response example

```json
{
    "uri": "https://XXXX/XXXX/XXXX/notification/template/test7",
    "timestamp": 1646989686393,
    "organization": "XXXX",
    "application": "17fe201b-XXXX-XXXX-83df-1ed1ebd7b227",
    "action": "get",
    "data": {
        "name": "test7",
        "createAt": 1646989584124,
        "updateAt": 1646989584124,
        "title_pattern": "Hello,{0}",
        "content_pattern": "Test,{0}"
    },
    "duration": 11,
    "applicationName": "XXXX"
}
```


## Receiver configuration template name

The receiver can call this API to set the push template.

### HTTP request

```html
PUT https://{host}/{org_name}/{app_name}/users/{username}/notification/template
```

#### Request header

| Parameter | Type | Description | Required |
| :----- | :----- | :------- | -------- |
| `Content-Type` | String | Content type. Please fill in `application/json`. | Yes |
| `Authorization` | String | The authentication token of the user or administrator, in the format of `Bearer ${YourAppToken}`, where `Bearer` is a fixed character, followed by an English space, and then the obtained token value. | Yes |

#### Request body

| Parameter | Type | Description | Required |
| :----- | :----- | :------- | -------- |
| `templateName` | String | Template name | Yes |


### HTTP response

If the returned HTTP status code is `200`, the request succeeds, and the response body contains the following fields:

|  Parameter  |  Type  |  Description |
| :-------- | :------- | :------- |
| `data`  | JSON | Data details in the response. `templateName`: It represents the name of the template after successful setting. |

For other fields and detailed descriptions, see [Common parameters](#response).

### Example

#### Request example

```bash
curl -X PUT '{host}/{org}/{app}/users/{username}/notification/template' \
  -H 'Content-Type: application/json' \
  -H 'Authorization: Bearer <YourUserToken>' \
  -d '{
  	"templateName": "hxtest"
  }
```

#### Response example

```json
{
    "path": "/users",
    "uri": "http://XXX/XXX/XXX/users/XXX/notification/template",
    "timestamp": 1705470003984,
    "organization": "XXX",
    "application": "cc7380d5-099c-4d11-a93e-51d6d590b475",
    "action": "put",
    "data": {
        "templateName": "hxtest"
    },
    "duration": 43,
    "applicationName": "XXX"
}
```

## Configure template name when sending messages

When sending a message, you can use the message extension parameter `ext.em_push_template.name` to specify the push template name.

If you use the default template, it will be automatically applied when pushing messages, and there is no need to pass in the template name when creating messages.

The JSON structure of this extended parameter should follow this format:

```json
{
    "ext":{
        "em_push_template":{
            "name":"hxtest"
        }
    }
}
```

The following is an example of using a custom push template when sending single chat text messages:

#### Request example

```bash
curl -L -X POST 'https://XXXX/XXXX/XXXX/messages/users' \
-H 'Content-Type: application/json' \
-H 'Authorization: Bearer <YourAppToken>' \
-d '{
    "from": "user1",
    "to": [
        "user2"
    ],
    "type": "txt",
    "body": {
        "msg": "testmessages"
    },
    "ext": {
        "em_push_template": {
            "name": "hxtest"
        }
    }
}'
```

#### Response example

```json
{
  "path": "/messages/users",
  "uri": "https://XXXX/XXXX/XXXX/messages/users",
  "timestamp": 1657254052191,
  "organization": "XXXX",
  "application": "e82bcc5f-XXXX-XXXX-a7c1-92de917ea2b0",
  "action": "post",
  "data": {
    "user2": "1029457500870543736"
  },
  "duration": 0,
  "applicationName": "XXXX"
}
```

For more details, see [Send a message](../restful-api/message-management#send-a-message).

## Delete a push template

Deletes the specified template for push notifications.

For each App Key, the call frequency limit of this method is 100 per second.

### HTTP request

```html
DELETE https://{host}/{org}/{app}/notification/template/{name}
```

#### Path parameter

| Parameter | Type | Description | Required |
| :----- | :----- | :------- | -------- |
| `name` | String | The name of the push template.  | Yes |

For the descriptions of other path parameters, see [Common Parameters](#request).

#### Request header

| Parameter | Type | Description | Required |
| :----- | :----- | :------- | -------- |
| `Content-Type` | String | Content type. Please fill in `application/json`. | Yes |
| `Authorization` | String | The authentication token of the user or administrator, in the format of `Bearer ${YourAppToken}`, where `Bearer` is a fixed character, followed by an English space, and then the obtained token value. | Yes |

### HTTP response

#### Response body

If the returned HTTP status code is `200`, the request succeeds, and the response body contains the following fields:

|  Parameter  |  Type  |  Description  |
| :-------- | :------- | :------- |
| `data`  | JSON | Push template related information. |
| `data.name`  | String | The name of the push template. |
| `data.createAt`  | Number | The Unix timestamp (ms) when the template is created. |
| `data.updateAt`  | Number | The Unix timestamp (ms) when the template is last modified. |
| `data.title_pattern`  | String | The custom title of the push template. |
| `data.content_pattern`  | String | The custom content of the push template. |

For other fields and detailed descriptions, see [Common parameters](#response).

If the returned HTTP status code is not `200`, the request fails. You can refer to [Status codes](#status-codes) for possible reasons.

### Example

#### Request example

```bash
curl -X DELETE 'https://XXXX/XXXX/XXXX/notification/template' \
-H 'Authorization: Bearer <YourAppToken>'
```

#### Response example

```json
{
    "uri": "https://XXXX/XXXX/XXXX/notification/template",
    "timestamp": 1646989686393,
    "organization": "XXXX",
    "application": "17fe201b-XXXX-XXXX-83df-1ed1ebd7b227",
    "action": "delete",
    "data": {
        "name": "test7",
        "createAt": 1646989584124,
        "updateAt": 1646989584124,
        "title_pattern": "Hello,{0}",
        "content_pattern": "Test,{0}"
    },
    "duration": 11,
    "applicationName": "XXXX"
}
```


## Status codes

For details, see [HTTP Status Codes](/agora-chat/reference/http-status-codes).

</PlatformWrapper>