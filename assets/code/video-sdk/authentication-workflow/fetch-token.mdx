<PlatformWrapper platform={["ios","macos"]}>
    ```swift
    func fetchToken(
        from tokenUrl: String, channel: String,
        role: AgoraClientRole, userId: UInt = 0
    ) async throws -> String? {
        guard !tokenUrl.isEmpty else { return nil }

        guard let tokenServerURL = URL(
            string: "\(tokenUrl)/rtc/\(channel)/\(role.rawValue)/uid/\(userId)/"
        ) else { return nil }

        let (data, _) = try await URLSession.shared.data(from: tokenServerURL)
        let tokenResponse = try JSONDecoder().decode(TokenResponse.self, from: data)

        return tokenResponse.rtcToken
    }
    ```
</PlatformWrapper>

<PlatformWrapper platform="unity">
    ```csharp
    public async Task FetchToken()
    {
        if(userRole == "Host")
        {
            role = 1;
        }
        else if (userRole == "Audience")
        {
            role = 2;
        }

        string url = string.Format("{0}/rtc/{1}/{2}/uid/{3}/?expiry={4}", configData.tokenUrl, configData.channelName, role ,configData.uid, configData.tokenExpiryTime);

        UnityWebRequest request = UnityWebRequest.Get(url);
        
        var operation = request.SendWebRequest();

        while (!operation.isDone)
        {
            await Task.Yield();
        }

        if (request.isNetworkError || request.isHttpError)
        {
            Debug.Log(request.error);
            return;
        }

        TokenStruct tokenInfo = JsonUtility.FromJson<TokenStruct>(request.downloadHandler.text);
        Debug.Log("Retrieved token : " + tokenInfo.rtcToken);
        _token = tokenInfo.rtcToken;
        _channelName = configData.channelName;
    }
    ```
</PlatformWrapper>
<PlatformWrapper platform="web">
```javascript
    // Get the config
    const config = agoraManager.config;

    // Fetches the RTC token for stream channels
    async function fetchToken(uid, channelName) {
        if (config.serverUrl !== "") {
        try {
            const res = await fetch(
            config.proxyUrl +
                config.serverUrl +
                "/rtc/" +
                channelName +
                "/" +
                role +
                "/uid/" +
                uid +
                "/?expiry=" +
                config.tokenExpiryTime,
            {
                headers: {
                "X-Requested-With": "XMLHttpRequest",
                },
            }
            );
            const data = await res.text();
            const json = await JSON.parse(data);
            console.log("Video SDK token fetched from server: ", json.rtcToken);
            return json.rtcToken;
        } catch (err) {
            console.log(err);
        }
        } else {
        return config.token;
        }
    }
```
</PlatformWrapper>
