
import RestAPILayout from '@site/src/components/rest-api/RestAPILayout';
import LeftColumn from '@site/src/components/rest-api/LeftColumn';
import RightColumn, { Section } from '@site/src/components/rest-api/RightColumn';
import ParameterList, { Parameter } from '@site/src/components/rest-api/ParameterList';
import PathParameter from '@site/src/components/rest-api/PathParameter';
import { Tabs, TabItem } from '@site/src/components/rest-api/Tabs';

This page explains the structure of the Channel Management RESTful API and how to call it correctly.
<RestAPILayout>

## Prerequisites

Before calling the API, ensure you have the following:

- An Agora App ID
- Customer ID
- Customer Key

## Request

###  Request URL

A sample request URL is as follows:

  <LeftColumn
    title={frontMatter.title}
    method="POST"
    endpoint="https://api.agora.io/dev/v1/kicking-rule"
  >

  <PathParameter name="https" type="string">
    The communication protocol. Agora uses HTTPS.
  </PathParameter>
  <PathParameter name="api.agora.io" type="string">
    The domain name of the Agora server.
  </PathParameter>
  <PathParameter name="dev/v1/kicking-rule" type="string">
    The resource path, which includes the API version and the resource name.
  </PathParameter>
  The example above is for reference only. Refer to the specific API documentation, select the appropriate HTTP method (`GET`, `POST`, `PUT`, `PATCH`, `DELETE`), and configure the request URL accordingly. Note that the request URL is case-sensitive.

### Request

A request consists of two parts: The request header and the request body.

The following example shows how to create a privilege banning rule by sending a `POST` request containing the app ID, channel name, user ID, user IP, ban duration, and the privilege list to the specified API address.

**Request header**

The request header contains the following information needed to process the request:

<ParameterList title="HEADER" required={true}>
  <Parameter name="Accept" type="strung" required={true}>
    Tells the server what types of responses the client can handle, such as `application/json`.
  </Parameter>
  <Parameter name="Authorization" type="string" required={true}>
    Agora's RESTful API requires HTTP authentication. Include the `Authorization` field in the request header. See [RESTful Authentication](../channel-management-api/restful-authentication) for details.  
  </Parameter>
  <Parameter name="Content-Type" type="string" required={true}>
    Specifies the type of the request body, such as `application/json`.
  </Parameter>
</ParameterList>

**Request body (Optional)**

The request body contains the information to be sent to the server. For example, to create a new rule to ban user privileges, include the relevant information, such as the app ID, channel name, user ID, user IP, ban duration, and the banned privileges. The request body is case-sensitive.

### Response

After you send the request, the Agora server sends a response that includes a response status code and a response body. The channel management RESTful API does not have a response header.

If the returned status code is `200`, the request was successful. The response body contains the result of the request.

  <ParameterList title="OK">
    <Parameter 
      name="status" 
      type="string" 
      possibleValues="success, failed"
    >
      Indicates whether the request was successful.
    </Parameter>
    <Parameter name="id" type="integer">
      The unique identifier of the kicking rule that was just created.
    </Parameter>
  </ParameterList>

If the returned status code is not `200`, the request failed. The response body includes the `detail` and `reason` for failure. Refer to [Response Status Codes](response-status-code) to understand the possible reasons for failure.

## Reference

This section contains content that completes the information on this page, or points you to documentation that explains other aspects to this product.

### Error handling

If you encounter a problem, use developer tools to view the request and response, and troubleshoot based on the response status code. If the problem persists, contact [technical support](mailto:support@agora.io).


</LeftColumn>

<RightColumn>

<Section title="Authorization">
The endpoint requires [RESTful authentication](/video-calling/channel-management-api/restful-authentication).
</Section>

<Section title="Request example">
  <Tabs groupId="code-examples">
    <TabItem value="curl" label="curl" default>
    ```bash
    curl --request POST \\
      --url http://api.sd-rtn.com/dev/v1/kicking-rule \\
      --header 'Accept: application/json' \\
      --header 'Authorization: ' \\
      --header 'Content-Type: application/json' \\
      --data '{
      "appid": "4855xxxxxxxxxxxxxxxxxxxxxxxxeae2",
      "cname": "channel1",
      "uid": 589517928,
      "ip": "",
      "time": 60,
      "privileges": [
        "join_channel"
      ]
    }'
    ```
  </TabItem>
  <TabItem value="python" label="Python" default>
  ```python
  import http.client
  import json
  conn = http.client.HTTPConnection("api.sd-rtn.com")\n
  payload = {
      "appid": "4855xxxxxxxxxxxxxxxxxxxxxxxxeae2",
      "cname": "channel1",
      "uid": 589517928,
      "ip": "",
      "time": 60,
      "privileges": [
          "join_channel"
      ]
  }\n
  headers = {
      'Authorization': "",
      'Content-Type': "application/json",
      'Accept': "application/json"
  }\n
  conn.request("POST", "/dev/v1/kicking-rule", json.dumps(payload), headers)\n
  res = conn.getresponse()
  data = res.read()\n
  print(data.decode("utf-8"))
  ```
  </TabItem>
  <TabItem value="node" label="Node.js" default>

  ```js
  const http = require('http');
  const options = {
    method: 'POST',
    hostname: 'api.sd-rtn.com',
    port: null,
    path: '/dev/v1/kicking-rule',
    headers: {
      Authorization: '',
      'Content-Type': 'application/json',
      Accept: 'application/json'
    }
  };\n
  const req = http.request(options, function (res) {
    const chunks = [];
    res.on('data', function (chunk) {
      chunks.push(chunk);
    });\n
    res.on('end', function () {
      const body = Buffer.concat(chunks);
      console.log(body.toString());
    });
  });\n
  req.write(JSON.stringify({
    appid: '4855xxxxxxxxxxxxxxxxxxxxxxxxeae2',
    cname: 'channel1',
    uid: 589517928,
    ip: '',
    time: 60,
    privileges: ['join_channel']
  }));
  req.end();
  ```
  </TabItem>
</Tabs>

</Section>
<Section title="Response example">

```json
{
  "status": "success",
  "id": 1953
}
```

</Section>
</RightColumn>

</RestAPILayout>
