---
title: RTCConnection Class
---

<span className="index-group-rtcconnection" style={{display: 'none'}}>RTCConnection</span>
<span className="index-desc-rtcconnection">`RtcConnection` class, used to manage the connection between the SDK and the RTC channel. After the connection is complete, you can send and receive media streams in the RTC channel through the `LocalUser` object. Connecting to a channel is an asynchronous operation, and you can use the [`IRtcConnectionObserver`](./irtcconnectionobserver) object to listen for connection status changes and events. The `RtcConnection` object also monitors whether remote users join or leave the channel.</span>

<h2 className="anchor index-group-item-rtcconnection index-api-connect" id="connect">connect</h2>

```python
def connect(self, token: str, chan_id: str, user_id: str) -> int
```

<span className="index-desc-connect">Connects to an RTC channel.</span>

When the method is successful, the connection status changes from `1` to `2`.

Depending on whether the connection is successful, the connection status changes to `3` or `5`. The SDK triggers the [`on_connected`](./irtcconnectionobserver#onconnected) or [`on_disconnected`](./irtcconnectionobserver#ondisconnected) callback to notify you of the connection status change.

#### Parameters

export const TableHeaderve9qoc54a4 = [
  {
    label: 'Parameter'
  },
  {
    label: 'Description'
  }
];

<Table header={TableHeaderve9qoc54a4}>
  <Tr>
    <Td>`token`</Td>
    <Td>RTC token. See [Token Authentication](https://doc.shengwang.cn/doc/rtc/windows/basic-features/token-authentication).</Td>
  </Tr>
  <Tr>
    <Td>`chan_id`</Td>
    <Td>
    Channel name. Must be a string and no more than 64 bytes. The supported character types include:
    - All lowercase letters: a to z
    - All uppercase letters: A to Z
    - All Arabic numerals: 0 to 9
    - Space
    - Punctuation and other special symbols: `!`, `#`, `$`, `%`, `&`, `(`, `)`, `+`, `-`, `:`, `;`, `<`, `=`, `.`, `>`, `?`, `@`, `[`, `]`, `^`, `_`, `{`, `}`, `|`, `~`, `,`
    </Td>
  </Tr>
  <Tr>
    <Td>`user_id`</Td>
    <Td>
    Local user ID. No more than 64 bytes. If you do not set the user ID or set it to `None`, the SDK automatically returns a user ID in the `on_connected` callback. You must record and manage this ID yourself. Depending on the user ID type you selected in the [`initialize`](./agoraservice#initialize) method, the supported character set is different:
    - The supported character set for integer user IDs includes:
      - 10 digits: 0-9
    - The supported character set for string user IDs includes:
      - 26 lowercase English letters: a-z
      - 26 uppercase English letters: A-Z
      - 10 digits: 0-9
      - Space
      - `!`, `#`, `$`, `%`, `&`, `(`, `)`, `+`, `-`, `:`, `;`, `<`, `=`, `.`, `>`, `?`, `@`, `[`, `]`, `^`, `_`, `{`, `}`, `|`, `~`, `,`
    </Td>
  </Tr>
</Table>

#### Returns

- `0`: Success.
- < `0`: Failure.
  - `-2`: The parameters are invalid.
  - `-8`: The current connection status is not `1`.

<h2 className="anchor index-group-item-rtcconnection index-api-disconnect" id="disconnect">disconnect</h2>

```python
def disconnect(self) -> int
```

<span className="index-desc-disconnect">Disconnects from the RTC channel. When the SDK disconnects from the channel, the connection status changes to `1`. You can also learn about the disconnection through the [`on_disconnected`](./irtcconnectionobserver#ondisconnected) callback.</span>

#### Returns

- `0`: Success.
- < `0`: Failure.

<h2 className="anchor index-group-item-rtcconnection index-api-renewtoken" id="renewtoken">renew_token</h2>

```python
def renew_token(self, token: str) -> int
```

<span className="index-desc-renewtoken">Renews the token. The token expires after a certain period of time. When you receive the [`on_token_privilege_will_expire`](./irtcconnectionobserver#ontokenprivilegewillexpire) callback, you must generate a new Token from your server and use this method to update the token. Otherwise, the SDK disconnects from the channel.</span>

#### Parameters

| Parameter       | Description   |
|------------|------------|
| `token`    | The new token. |

#### Returns

- `0`: Success.
- < `0`: Failure.

<h2 className="anchor index-group-item-rtcconnection index-api-registerobserver" id="registerobserver">register_observer</h2>

```python
def register_observer(self, conn_observer: IRTCConnectionObserver) -> int
```

<span className="index-desc-registerobserver">Registers the RTC connection observer.</span>

#### Parameters

| Parameter           | Description   |
|----------------|------------|
| `conn_observer`| [`IRTCConnectionObserver`](./irtcconnectionobserver) object. |

#### Returns

- `0`: Success.
- < `0`: Failure.

<h2 className="anchor index-group-item-rtcconnection index-api-unregisterobserver" id="unregisterobserver">unregister_observer</h2>

```python
def unregister_observer(self) -> int
```

<span className="index-desc-unregisterobserver">Destroys the RTC connection observer.</span>

#### Returns

- `0`: Success.
- < `0`: Failure.

<h2 className="anchor index-group-item-rtcconnection index-api-createdatastream" id="createdatastream">create_data_stream</h2>

```python
def create_data_stream(self, reliable: bool, ordered: bool) -> int
```

<span className="index-desc-createdatastream">Creates a data stream.</span>

Each user can create up to 5 data streams in each channel.

<Admonition type="caution" title="Note">
- Agora does not support setting `reliable` to `1` and `ordered` to `0`.
- If you need the data packet to arrive immediately at the receiver, do not set the `ordered` parameter to `1`.
</Admonition>


#### Parameters

export const TableHeadervctg30ud8n = [
  {
    label: 'Parameter'
  },
  {
    label: 'Description'
  }
];

<Table header={TableHeadervctg30ud8n}>
  <Tr>
    <Td>`reliable`</Td>
    <Td>
    Whether the data stream is reliable:
    - `1`: The receiver receives the data sent by the sender within 5 seconds.
    - `0`: The receiver does not guarantee to receive the data. If the data is lost, it does not report an error.
   </Td>
  </Tr>
  <Tr>
    <Td>`ordered`</Td>
    <Td>
    Whether the data stream is ordered:
    - `1`: The receiver receives the data packets in the order sent by the sender.
    - `0`: The receiver does not guarantee to receive the data packets in the order sent by the sender.
   </Td>
  </Tr>
</Table>

#### Returns

- `stream_id`: Returns the data stream ID, if the method call succeeds.
- `None`: Failure.

<h2 className="anchor index-group-item-rtcconnection index-api-sendstreammessage" id="sendstreammessage">send_stream_message</h2>

```python
def send_stream_message(self, stream_id: int, data: str) -> int
```

<span className="index-desc-sendstreammessage">Sends a data stream message.</span>

The method sends a data stream message to all users in the channel. The SDK implements the following restrictions for this method:
- Up to 30 packets per second, and each packet is no more than 1 KB.
- Up to 6 KB of data per second per client.
- Each client can have up to 5 data channels at the same time.

After successfully calling this method, the remote end triggers the [`on_stream_message`](./localuserobserver#onstreammessage) callback, and remote users can obtain the received stream messages in this callback.

<Admonition type="caution" title="Note">
- Ensure that you have called [`create_data_stream`](./apidatatype#createdatastream) before calling this method.
- This method is only applicable to the host in live streaming scenarios.
</Admonition>

#### Parameters

| Parameter        | Description   |
|-------------|------------|
| `stream_id` | Data stream ID. You can obtain it through [`create_data_stream`](./apidatatype#createdatastream).|
| `data`      | Data to send.|

#### Returns

- `0`: Success.
- < `0`: Failure.

<h2 className="anchor index-group-item-rtcconnection index-api-getagoraparameter" id="getagoraparameter">get_agora_parameter</h2>

```python
def get_agora_parameter(self)
```

<span className="index-desc-getagoraparameter">Gets the `AgoraParameter` object.</span>

#### Returns

- `AgoraParameter` object, if the method call succeeds.
- `None`, if the method call fails.

<h2 className="anchor index-group-item-rtcconnection index-api-getlocaluser" id="getlocaluser">get_local_user</h2>

```python
def get_local_user(self)
```

<span className="index-desc-getlocaluser">Gets the `LocalUser` object. Each connection corresponds to one local user.</span>

#### Returns

- `LocalUser` object, if the method call succeeds.
- `None`, if the method call fails.

<h2 className="anchor index-group-item-rtcconnection index-api-release" id="release">release</h2>

```python
def release(self)
```

<span className="index-desc-release">Releases the RTC connection.</span>