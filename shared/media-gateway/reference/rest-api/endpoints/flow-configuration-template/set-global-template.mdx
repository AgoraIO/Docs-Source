import Authorization from '@docs/shared/media-gateway/reference/rest-api/authorization.mdx';
import CodeBlock from '@theme/CodeBlock';
import PostmanLink from '@docs/shared/media-gateway/reference/rest-api/postman-link.mdx';
import RestAPILayout from '@site/src/components/rest-api/RestAPILayout'; 
import LeftColumn from '@site/src/components/rest-api/LeftColumn'; 
import RightColumn, { Section } from '@site/src/components/rest-api/RightColumn'; 
import ParameterList, { Parameter } from '@site/src/components/rest-api/ParameterList'; 
import PathParameter from '@site/src/components/rest-api/PathParameter'; 
import { Tabs, TabItem } from '@site/src/components/rest-api/Tabs';

<RestAPILayout>

  <LeftColumn
    title={frontMatter.title}
    method="PUT"
    endpoint="https://api.agora.io/:region/v1/projects/:appId/rtls/ingress/appconfig"
  >

This method sets a global flow configuration template, that is, the template that applies to all streaming keys under the app ID.

<Admonition type="info" title="Note">Before calling this API, [create a flow configuration template](create-reset-template).</Admonition>

### Request

**Path parameters**

<PathParameter name="appId" type="string" required={true}>
  The app ID provided by <Vg k="COMPANY"/> to each developer. After creating a project in <Vg k="CONSOLE"/>, you can get an app ID. The app ID is a unique identifier for a project.
</PathParameter>
<PathParameter name="region" type="string" required={true}>
  Create an area for pushing the streaming key. <Vg k="COMPANY"/> supports creation of stream keys by region. Currently, the following regions are supported: 
  <ul>
    <li><code>na</code>: North America</li>
    <li><code>eu</code>: Europe</li>
    <li><code>ap</code>: Asia, except mainland China</li>
    <li><code>cn</code>: Mainland China</li>
  </ul>
  <Admonition type="caution" title="Important">
    Make sure that: 
    <ul>
      <li>The <code>region</code> value is the same as for the input source stream.</li>
      <li>The domain names for setting the <code>region</code> parameter and streaming are the same.</li>
      <li>The <code>region</code> value is in lowercase.</li>
    </ul>
  </Admonition>
</PathParameter>

**Headers**

<ParameterList title="HEADER" required={true}>
  <Parameter name="X-Request-ID" type="string" required={true}>
    The UUID (Universally Unique Identifier) of the request. After passing in this field, the <Vg k="COMPANY"/> server will return this field in the response header. It is recommended to assign `X-Request-ID` a value. If no value is assigned, the <Vg k="COMPANY"/> server will automatically generate a UUID and pass it in.
  </Parameter>
  <Parameter name="Authorization" type="string" required={true}>
  <Authorization/>
  </Parameter>
</ParameterList>

**Request body**

The request body consists of a JSON Object type `settings` and includes the following fields:

<ParameterList title="BODY" required={true}>
  <Parameter name="defaultStreamTemplate" type="string" required={true}>
  The flow configuration template ID. 
  <Admonition type="info" title="Note">
  For users of the beta version: Previously this API could also be used to set the transcoding parameters. Now it is recommended that you use the [template creation API](create-reset-template) instead. If you have used this API to set `transcoding`, the current flow is the following: 
  <ul>
    <li>If you reset `defaultStreamTemplate`, the  `transcoding` previously set through this API will automatically become invalid, and the parameters in the new template will prevail.</li>
    <li>If you do not reset `defaultStreamTemplate`, the `transcoding` previously set through this API will remain as the default global configuration for this app ID.</li>
  </ul>
  </Admonition>
  </Parameter>
</ParameterList>

### Responses

**Headers**

<ParameterList title="HEADER" required={true}>
  <Parameter name="X-Request-ID" type="string" required={true}>
  The UUID (Universally Unique Identifier) of the request. The value is in its `X-Request-ID` header. If a request error occurs, print the value in the log to troubleshoot the problem. A `401 (Unauthorized)` response status code means that there is no such field in the response header.
  </Parameter>
</ParameterList>

**Response body**

If the status code is `200`, the request succeeds, and the response body includes the following parameters:

<ParameterList title="BODY" required={true}>
  <Parameter name="status" type="string" required={true}>
    The status of this request. <code>success</code> means the request succeeds.
  </Parameter>
</ParameterList>
If the status code is not `200`, the request fails. See the `message` field in the response body for the reason for this failure. For details about possible response status codes, see [Response status codes](../../response-status-codes).


<PostmanLink />
</LeftColumn>
<RightColumn>
<Section title="Authorization">
The endpoint requires [RESTful Authentication](/media-gateway/reference/restful-authentication#implement-basic-http-authentication).
</Section>
<Section title="Request example">
  <Tabs groupId="code-examples">
    <TabItem value="cURL" label="cURL" default>
      ```shell
      curl --location -g --request PUT 'https://api.agora.io/{{region}}/v1/projects/{{appId}}/rtls/ingress/appconfig' \
      --data '{
          "settings": {
              "defaultStreamTemplate": "720p"
          }
      }'
      ```
    </TabItem>
    <TabItem value="node" label="Node" default>
    ```js
    fetch(`https://api.agora.io/your-region/v1/projects/your-appId/rtls/ingress/appconfig`, {
    method: "PUT",
    headers: { 
            "Content-Type": "application/json",
            "Accept": "application/json",
            "Authorization": "Basic <Base64EncodedCredentials>"
        },
        body: JSON.stringify({ settings: { defaultStreamTemplate: "720p" } })
    })
    .then(res => res.json())
    .then(console.log)
    .catch(console.error);
    ```
    </TabItem>
    <TabItem value="python" label="Python" default>
    ```python
    url = "https://api.agora.io/your-region/v1/projects/your-appId/rtls/ingress/appconfig"
    headers = {
        "Content-Type": "application/json",
        "Accept": "application/json",
        "Authorization": "Basic <Base64EncodedCredentials>"
    }
    data = {"settings": {"defaultStreamTemplate": "720p"}}

    res = requests.put(url, headers=headers, json=data)
    ```
    </TabItem>
  </Tabs>
    
</Section>
<Section title="Response example">
```shell
{
  "status": "success"
}
```
</Section>
</RightColumn>
</RestAPILayout>
