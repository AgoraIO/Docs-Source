<PlatformWrapper platform="react-native">

1.  **Add the required import statements**

    ```typescript
    import {
      createAgoraRtcEngine,
      ChannelProfileType,
      ClientRoleType,
      IRtcEngine,
      RtcConnection,
      UserOfflineReasonType
    } from 'react-native-agora'
    ```

1.  **Retrieve a token from the server**

    Use a GET request to retrieve an authentication token for a specific channel from the token server, then decode the return parameters to obtain the token.

    ```typescript
      const fetchRTCToken = async (channelName: string) => {
        try {
          if (config.serverUrl !== "") {
            const response = await fetch(
              `${config.serverUrl}/rtc/${channelName}/publisher/uid/${config.uid}/?expiry=${config.tokenExpiryTime}`
            );

            if (!response.ok) {
              throw new Error('Failed to fetch RTC token');
            }

            const data = await response.json();
            console.log("RTC token fetched from server:", data.rtcToken);

            config.rtcToken = data.rtcToken;
            config.channelName = channelName;
            return data.rtcToken;
          } else {
            console.log("Add the token server URL to fetch a token.");
            return config.rtcToken;
          }
        } catch (error) {
          console.error(error);
          throw error;
        }
      };
    ```

1.  **Fetch a token and join a channel using that token**

    Retrieve a token from the token server and use it to join the channel.
    ```typescript
      try {
        await agoraManager.fetchRTCToken(channelName);
        await agoraManager.joinCall();
      } catch (error) {
        console.error("Error joining the call:", error);
        alert("An error occurred while joining the call.");
      }
    ```

1.  **Handle the event triggered by <Vg k="AGORA_BACKEND" /> when the token is about to expire**

    A token expires after the `ExpireTime` specified in the call to the token server or after 24 hours, if the time
  is not specified. The `onTokenPrivilegeWillExpire` event receives a callback when the current token expires so that a fresh token may be retrieved and used:

    ``` typescript
    // Event handler for token privilege expiration
    const onTokenPrivilegeWillExpire = (connection: RtcConnection, token: string) => {
      agoraManager.fetchRTCToken(channelName);
      agoraManager.agoraEngineRef.current?.renewToken(config.token);
    };
    ```
</PlatformWrapper>
