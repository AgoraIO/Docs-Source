
<PlatformWrapper platform="ios">

```swift
// This method is specifically used by the sample app. If there is a tokenURL, it will attempt to retrieve a token from there.
internal func joinChannel(_ channel: String, uid: UInt? = nil) async -> Int32 {
    let userId = uid ?? DocsAppConfig.shared.uid
    var token = DocsAppConfig.shared.rtcToken
    if !DocsAppConfig.shared.tokenUrl.isEmpty {
        do {
            token = try await self.fetchToken(
                from: DocsAppConfig.shared.tokenUrl, channel: channel,
                role: self.role, userId: userId
            )
        } catch {
            print("token server fetch failed: \(error.localizedDescription)")
        }
    }
    return self.joinChannel(channel, token: token, uid: userId, info: nil)
}

// Joins a channel, starting the connection to a session.
open func joinChannel(
    _ channel: String, token: String? = nil, uid: UInt = 0, info: String? = nil
) async -> Int32 {
    if await !AgoraManager.checkForPermissions() {
        DispatchQueue.main.async {
            self.label = """
            Camera and microphone permissions were not granted.
            Check your security settings and try again.
            """
        }
        return -3
    }

    return self.agoraEngine.joinChannel(
        byToken: token, channelId: channel,
        info: info, uid: uid
    )
}
```

</PlatformWrapper>

<PlatformWrapper platform="macos">
```swift
// This method is specifically used by the sample app. If there is a tokenURL, it will attempt to retrieve a token from there.
open func joinChannel(_ channel: String) async -> Int32 {
    if let rtcToken = DocsAppConfig.shared.rtcToken, !rtcToken.isEmpty {
        return self.joinChannel(
            channel, token: DocsAppConfig.shared.rtcToken,
            uid: DocsAppConfig.shared.uid, info: nil
        )
    }
    var token: String?
    if !DocsAppConfig.shared.tokenUrl.isEmpty {
        do {
            token = try await self.fetchToken(
                from: DocsAppConfig.shared.tokenUrl, channel: channel, role: self.role
            )
        } catch {
            print("token server fetch failed: \(error.localizedDescription)")
        }
    }
    return self.joinChannel(channel, token: token, uid: DocsAppConfig.shared.uid, info: nil)
}
// Joins a channel, starting the connection to a session.
open func joinChannel(
    _ channel: String, token: String? = nil, uid: UInt = 0, info: String? = nil
) -> Int32 {
    self.agoraEngine.joinChannel(byToken: token, channelId: channel, info: info, uid: uid)
}
```
</PlatformWrapper>

