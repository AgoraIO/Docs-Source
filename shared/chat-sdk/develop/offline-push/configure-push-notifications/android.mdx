<PlatformWrapper platform="android">

You can use extended fields to implement customized push settings, collapse the notification bar, force push, and send silent messages.

## Set custom push fields

When creating a push message, you can add custom fields to the message to meet personalized business needs.

```java
// This example takes text messages as an example. The setting methods for message types such as pictures and files are the same.
ChatMessage message = ChatMessage.createSendMessage(ChatMessage.Type.TXT);
// Set custom push extension.
JSONObject emPushExt = new JSONObject() {
   {
        put("custom", new JSONObject() {
            {
                put("key1", "value1");
                put("key2", "value2");
            }
        });
    }
};
// Set the push extension to the message.
message.setAttribute("em_push_ext", emPushExt);
```

The data structure of the custom field is as follows:

```json
{
    "em_push_ext": {
        "custom": {
            "key1": "value1",
            "key2": "value2"
        }
    }
}
```

| Parameters              | Description                |
| :--------------- | :----------------- |
|  ` em_push_ext` | Agora message push extension fixed value, cannot be modified .     |
|  ` custom `          | Message extension, use the extension method to add custom fields to the push, the value is fixed. |
|  ` key1 ` / ` key2 `     | Customize the specific content of the message push extension. |

## Set certain group members to receive push notifications

In offline push do not disturb mode, if you want only certain group members to receive offline push notifications when sending messages in a group, you can achieve this by setting the message extension field.

```java
// This example takes text messages as an example. The setting methods for message types such as pictures and files are the same.
ChatMessage message = ChatMessage.createSendMessage(ChatMessage.Type.TXT);
// Set custom push fields.
JSONObject extObject = new JSONObject();
try {
    extObject.put("em_at_list", value);
} catch (JSONException e) {
    e.printStackTrace();
}
// Set the push extension to the message.
message.setAttribute("em_apns_ext", extObject);
```

The data structure of this extension field is as follows:

```json
{
    "em_apns_ext": {
        "em_at_list": "All"
    }
}
```

| Parameters              | Description                |
| :--------------- | :----------------- |
|  ` em_apns_ext` |     Built -in push extension fields. |
|  ` em_at_list` |           Custom key added by the user. ` value` is the value of the field , which is an array type, indicating the user ID of the group member who receives the push notification. Setting it to ` All` means pushing notifications to all group members   . |

## Set the notification bar to collapse

You can collapse multiple messages in the notification bar. The sample code is as follows:

```java
// This example takes text messages as an example. The setting methods for message types such as pictures and files are the same.
ChatMessage message = ChatMessage.createSendMessage(ChatMessage.Type.TXT);
// Set custom push fields.
JSONObject extObject = new JSONObject();
try {
    extObject.put("em_push_collapse_key", "collapseKey");
} catch (JSONException e) {
    e.printStackTrace();
}
// Set the push extension to the message.
message.setAttribute("em_apns_ext", extObject);
```

The data structure of the notification bar collapse field is as follows:

```json
{
    "em_apns_ext": {
        "em_push_collapse_key": "collapseKey"
    }
}
```

| Parameters              | Description                |
| :--------------- | :----------------- |
|  ` em_apns_ext` |     Built -in push extension fields. |
|  ` em_push_collapse_key `    | Specifies a set of messages that can be collapsed (e.g. with collapse_key: "Updates Available") so that only the last message is sent when delivery is resumed, thus avoiding sending too many identical messages when the device comes back online or becomes active.    |

## Force push

After setting up forced push, the user will ignore the recipient's do not disturb setting when sending messages, and the message will be pushed to the recipient normally regardless of whether it is in the do not disturb time period.

```java
// This example takes text messages as an example. The setting methods for message types such as pictures and files are the same.
ChatMessage message = ChatMessage.createSendMessage(ChatMessage.Type.TXT);
// Set whether to force push. This field is a built-in extension field with the following values: `true`: forced push; (default) `false`: non-forced push.
message.setAttribute("em_force_notification", true);
```

## Send a silent message

Sending silent messages means that the sender sets the message not to be pushed when sending the message. That is, when the user is offline, the IM service will not push message notifications to the user's device through the FCM push service. Therefore, the user will not receive message push notifications. When the user is online again, he will receive all the messages during the offline period.

Both silent message sending and do not disturb mode do not push messages. The difference is that silent message sending is set by the sender when sending the message, while do not disturb mode is set by the receiver not to receive push notifications within a specified time period.

```java
// This example takes text messages as an example. The setting methods for message types such as pictures and files are the same.
ChatMessage message = ChatMessage.createSendMessage(ChatMessage.Type.TXT);
// Set whether to send silent messages. This field is a built-in extension field with the following values: `true`: send silent messages; (default) `false`: push the message.
message.setAttribute("em_ignore_notification", true);
```

</PlatformWrapper>